const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./browserAll.1E3r4JN3.js","./webworkerAll.COaxBBuE.js","./colorToUniform.KTpA7KSL.js","./WebGPURenderer.BanXHdHj.js","./SharedSystems.DbsJ21Wi.js","./WebGLRenderer.Dow1LHmW.js"])))=>i.map(i=>d[i]);
import{d as Xh,e as Xp,c as Da,a as St,t as $t,n as Bo}from"./disclose-version.B9uPtV9G.js";import{a1 as Wp,x as jp,m as Pu,v as Xt,C as ns,B as ws,W as Yp,as as Ru,X as qp,Y as Wh,Z as ln,w as or,au as as,_ as Mu,n as Lo,D as Kp,z as jh,av as Zp,aw as Qp,ar as Jp,ax as tm,q as Fu,y as ri,ao as em,ah as rm,I as im,O as Yh,ay as sm,az as nm,aA as am,al as ku,ap as om,an as hm,V as qh,aB as lm,aC as cm,ai as um,Q as dm,p as Fe,aD as fm,aE as pm,f as Br,a as ke,F as Zt,i as Q,aF as ue,aG as cn,j as mm,c as pt,r as ut,t as de,a4 as gm,s as kt,aH as os,K as Bu,aI as ym}from"./runtime.C8sQnhLv.js";import{i as _m,d as xm,e as Us,n as vm,f as bm,a as gi,g as wm,j as Am}from"./store.6g3JfaVG.js";import{l as Tm,o as Ei,c as Sm,i as be,d as Cm,p as hs,b as $e,_ as As,a as Em}from"./preload-helper.5ZrT8JPE.js";import{i as No}from"./legacy.BD41IvLZ.js";function Im(r,t){if(t){const e=document.body;r.autofocus=!0,Wp(()=>{document.activeElement===e&&r.focus()})}}function Lu(r,t){return t}function Pm(r,t,e,i){for(var s=[],n=t.length,a=0;a<n;a++)Qp(t[a].e,s,!0);var o=n>0&&s.length===0&&e!==null;if(o){var h=e.parentNode;Jp(h),h.append(e),i.clear(),Oe(r,t[0].prev,t[n-1].next)}tm(s,()=>{for(var l=0;l<n;l++){var c=t[l];o||(i.delete(c.k),Oe(r,c.prev,c.next)),Fu(c.e,!o)}})}function Nu(r,t,e,i,s,n=null){var a=r,o={flags:t,items:new Map,first:null};{var h=r;a=Xt?ns(ri(h)):h.appendChild(jp())}Xt&&ws();var l=null,c=!1;Pu(()=>{var u=e(),f=Yp(u)?u:u==null?[]:Ru(u),d=f.length;if(c&&d===0)return;c=d===0;let g=!1;if(Xt){var y=a.data===qp;y!==(d===0)&&(a=Wh(),ns(a),ln(!1),g=!0)}if(Xt){for(var p=null,m,_=0;_<d;_++){if(or.nodeType===8&&or.data===em){a=or,g=!0,ln(!1);break}var v=f[_],A=i(v,_);m=Ou(or,o,p,null,v,A,_,s,t),o.items.set(A,m),p=m}d>0&&ns(Wh())}if(!Xt){var x=rm;Rm(f,o,a,s,t,(x.f&as)!==0,i)}n!==null&&(d===0?l?Mu(l):l=Lo(()=>n(a)):l!==null&&Kp(l,()=>{l=null})),g&&ln(!0),e()}),Xt&&(a=or)}function Rm(r,t,e,i,s,n,a){var o=r.length,h=t.items,l=t.first,c=l,u,f=null,d=[],g=[],y,p,m,_;for(_=0;_<o;_+=1){if(y=r[_],p=a(y,_),m=h.get(p),m===void 0){var v=c?c.e.nodes_start:e;f=Ou(v,t,f,f===null?t.first:f.next,y,p,_,i,s),h.set(p,f),d=[],g=[],c=f.next;continue}if(Mm(m,y,_),m.e.f&as&&Mu(m.e),m!==c){if(u!==void 0&&u.has(m)){if(d.length<g.length){var A=g[0],x;f=A.prev;var S=d[0],b=d[d.length-1];for(x=0;x<d.length;x+=1)Kh(d[x],A,e);for(x=0;x<g.length;x+=1)u.delete(g[x]);Oe(t,S.prev,b.next),Oe(t,f,S),Oe(t,b,A),c=A,f=b,_-=1,d=[],g=[]}else u.delete(m),Kh(m,c,e),Oe(t,m.prev,m.next),Oe(t,m,f===null?t.first:f.next),Oe(t,f,m),f=m;continue}for(d=[],g=[];c!==null&&c.k!==p;)(n||!(c.e.f&as))&&(u??(u=new Set)).add(c),g.push(c),c=c.next;if(c===null)continue;m=c}d.push(m),f=m,c=m.next}if(c!==null||u!==void 0){for(var B=u===void 0?[]:Ru(u);c!==null;)(n||!(c.e.f&as))&&B.push(c),c=c.next;var G=B.length;if(G>0){var L=o===0?e:null;Pm(t,B,L,h)}}jh.first=t.first&&t.first.e,jh.last=f&&f.e}function Mm(r,t,e,i){Zp(r.v,t),r.i=e}function Ou(r,t,e,i,s,n,a,o,h){var l=(h&nm)!==0,c=(h&am)===0,u=l?c?im(s):Yh(s):s,f=h&sm?Yh(a):a,d={i:f,v:u,k:n,a:null,e:null,prev:e,next:i};try{return d.e=Lo(()=>o(r,u,f),Xt),d.e.prev=e&&e.e,d.e.next=i&&i.e,e===null?t.first=d:(e.next=d,e.e.next=d.e),i!==null&&(i.prev=d,i.e.prev=d.e),d}finally{}}function Kh(r,t,e){for(var i=r.next?r.next.e.nodes_start:e,s=t?t.e.nodes_start:e,n=r.e.nodes_start;n!==i;){var a=ku(n);s.before(n),n=a}}function Oe(r,t,e){t===null?r.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}function Fm(r,t,e,i,s){var n=r,a="",o;Pu(()=>{if(a===(a=t()??"")){Xt&&ws();return}o!==void 0&&(Fu(o),o=void 0),a!==""&&(o=Lo(()=>{if(Xt){or.data;for(var h=ws(),l=h;h!==null&&(h.nodeType!==8||h.data!=="");)l=h,h=ku(h);if(h===null)throw om(),hm;Xh(or,l),n=ns(h);return}var c=a+"";c=`<svg>${c}</svg>`;var u=Xp(c);for(u=ri(u),Xh(ri(u),u.lastChild);ri(u);)n.before(ri(u))}))})}function Zh(r,t,e,i,s){var o;Xt&&ws();var n=(o=t.$$slots)==null?void 0:o[e],a=!1;n===!0&&(n=t.children,a=!0),n===void 0||n(r,a?()=>i:i)}function Pr(r,t,e,i){var s=r.__attributes??(r.__attributes={});Xt&&(s[t]=r.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&r.nodeName==="LINK")||s[t]!==(s[t]=e)&&(t==="style"&&"__styles"in r&&(r.__styles={}),t==="loading"&&(r[cm]=e),e==null?r.removeAttribute(t):typeof e!="string"&&Uu(r).includes(t)?r[t]=e:r.setAttribute(t,e))}function Qh(r,t,e,i,s=!1,n=!1,a=!1){var o=t||{},h=r.tagName==="OPTION";for(var l in t)l in e||(e[l]=null);var c=Uu(r),u=r.__attributes??(r.__attributes={});for(const p in e){let m=e[p];if(h&&p==="value"&&m==null){r.value=r.__value="",o[p]=m;continue}var f=o[p];if(m!==f){o[p]=m;var d=p[0]+p[1];if(d!=="$$"){if(d==="on"){const _={},v="$$"+p;let A=p.slice(2);var g=bm(A);if(_m(A)&&(A=A.slice(0,-7),_.capture=!0),!g&&f){if(m!=null)continue;r.removeEventListener(A,o[v],_),o[v]=null}if(m!=null)if(g)r[`__${A}`]=m,Us([A]);else{let x=function(S){o[p].call(this,S)};o[v]=xm(A,r,x,_)}else g&&(r[`__${A}`]=void 0)}else if(p==="style"&&m!=null)r.style.cssText=m+"";else if(p==="autofocus")Im(r,!!m);else if(p==="__value"||p==="value"&&m!=null)r.value=r[p]=r.__value=m;else{var y=p;s||(y=vm(y)),m==null&&!n?(u[p]=null,r.removeAttribute(p)):c.includes(y)&&(n||typeof m!="string")?r[y]=m:typeof m!="function"&&(Xt&&(y==="src"||y==="href"||y==="srcset")||Pr(r,y,m))}p==="style"&&"__styles"in r&&(r.__styles={})}}}return o}var Jh=new Map;function Uu(r){var t=Jh.get(r.nodeName);if(t)return t;Jh.set(r.nodeName,t=[]);for(var e,i=qh(r),s=Element.prototype;s!==i;){e=lm(i);for(var n in e)e[n].set&&t.push(n);i=qh(i)}return t}function km(r,t){var e=r.__className,i=Gu(t);Xt&&r.getAttribute("class")===i?r.__className=i:(e!==i||Xt&&r.getAttribute("class")!==i)&&(i===""?r.removeAttribute("class"):r.setAttribute("class",i),r.__className=i)}function yi(r,t){var e=r.__className,i=Gu(t);Xt&&r.className===i?r.__className=i:(e!==i||Xt&&r.className!==i)&&(t==null?r.removeAttribute("class"):r.className=i,r.__className=i)}function Gu(r){return r??""}function gr(r,t,e){if(e){if(r.classList.contains(t))return;r.classList.add(t)}else{if(!r.classList.contains(t))return;r.classList.remove(t)}}function Ts(r,t,e){var i=dm(r,t);i&&i.set&&(r[t]=e,um(()=>{r[t]=null}))}const di=/^[a-z0-9]+(-[a-z0-9]+)*$/,Gs=(r,t,e,i="")=>{const s=r.split(":");if(r.slice(0,1)==="@"){if(s.length<2||s.length>3)return null;i=s.shift().slice(1)}if(s.length>3||!s.length)return null;if(s.length>1){const o=s.pop(),h=s.pop(),l={provider:s.length>0?s[0]:i,prefix:h,name:o};return t&&!ls(l)?null:l}const n=s[0],a=n.split("-");if(a.length>1){const o={provider:i,prefix:a.shift(),name:a.join("-")};return t&&!ls(o)?null:o}if(e&&i===""){const o={provider:i,prefix:"",name:n};return t&&!ls(o,e)?null:o}return null},ls=(r,t)=>r?!!((r.provider===""||r.provider.match(di))&&(t&&r.prefix===""||r.prefix.match(di))&&r.name.match(di)):!1,Du=Object.freeze({left:0,top:0,width:16,height:16}),Ss=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),Ds=Object.freeze({...Du,...Ss}),$a=Object.freeze({...Ds,body:"",hidden:!1});function Bm(r,t){const e={};!r.hFlip!=!t.hFlip&&(e.hFlip=!0),!r.vFlip!=!t.vFlip&&(e.vFlip=!0);const i=((r.rotate||0)+(t.rotate||0))%4;return i&&(e.rotate=i),e}function tl(r,t){const e=Bm(r,t);for(const i in $a)i in Ss?i in r&&!(i in e)&&(e[i]=Ss[i]):i in t?e[i]=t[i]:i in r&&(e[i]=r[i]);return e}function Lm(r,t){const e=r.icons,i=r.aliases||Object.create(null),s=Object.create(null);function n(a){if(e[a])return s[a]=[];if(!(a in s)){s[a]=null;const o=i[a]&&i[a].parent,h=o&&n(o);h&&(s[a]=[o].concat(h))}return s[a]}return Object.keys(e).concat(Object.keys(i)).forEach(n),s}function Nm(r,t,e){const i=r.icons,s=r.aliases||Object.create(null);let n={};function a(o){n=tl(i[o]||s[o],n)}return a(t),e.forEach(a),tl(r,n)}function $u(r,t){const e=[];if(typeof r!="object"||typeof r.icons!="object")return e;r.not_found instanceof Array&&r.not_found.forEach(s=>{t(s,null),e.push(s)});const i=Lm(r);for(const s in i){const n=i[s];n&&(t(s,Nm(r,s,n)),e.push(s))}return e}const Om={provider:"",aliases:{},not_found:{},...Du};function un(r,t){for(const e in t)if(e in r&&typeof r[e]!=typeof t[e])return!1;return!0}function Hu(r){if(typeof r!="object"||r===null)return null;const t=r;if(typeof t.prefix!="string"||!r.icons||typeof r.icons!="object"||!un(r,Om))return null;const e=t.icons;for(const s in e){const n=e[s];if(!s.match(di)||typeof n.body!="string"||!un(n,$a))return null}const i=t.aliases||Object.create(null);for(const s in i){const n=i[s],a=n.parent;if(!s.match(di)||typeof a!="string"||!e[a]&&!i[a]||!un(n,$a))return null}return t}const el=Object.create(null);function Um(r,t){return{provider:r,prefix:t,icons:Object.create(null),missing:new Set}}function cr(r,t){const e=el[r]||(el[r]=Object.create(null));return e[t]||(e[t]=Um(r,t))}function Oo(r,t){return Hu(t)?$u(t,(e,i)=>{i?r.icons[e]=i:r.missing.add(e)}):[]}function Gm(r,t,e){try{if(typeof e.body=="string")return r.icons[t]={...e},!0}catch{}return!1}let _i=!1;function Vu(r){return typeof r=="boolean"&&(_i=r),_i}function Dm(r){const t=typeof r=="string"?Gs(r,!0,_i):r;if(t){const e=cr(t.provider,t.prefix),i=t.name;return e.icons[i]||(e.missing.has(i)?null:void 0)}}function $m(r,t){const e=Gs(r,!0,_i);if(!e)return!1;const i=cr(e.provider,e.prefix);return Gm(i,e.name,t)}function Hm(r,t){if(typeof r!="object")return!1;if(typeof t!="string"&&(t=r.provider||""),_i&&!t&&!r.prefix){let s=!1;return Hu(r)&&(r.prefix="",$u(r,(n,a)=>{a&&$m(n,a)&&(s=!0)})),s}const e=r.prefix;if(!ls({provider:t,prefix:e,name:"a"}))return!1;const i=cr(t,e);return!!Oo(i,r)}const zu=Object.freeze({width:null,height:null}),Xu=Object.freeze({...zu,...Ss}),Vm=/(-?[0-9.]*[0-9]+[0-9.]*)/g,zm=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function rl(r,t,e){if(t===1)return r;if(e=e||100,typeof r=="number")return Math.ceil(r*t*e)/e;if(typeof r!="string")return r;const i=r.split(Vm);if(i===null||!i.length)return r;const s=[];let n=i.shift(),a=zm.test(n);for(;;){if(a){const o=parseFloat(n);isNaN(o)?s.push(n):s.push(Math.ceil(o*t*e)/e)}else s.push(n);if(n=i.shift(),n===void 0)return s.join("");a=!a}}function Xm(r,t="defs"){let e="";const i=r.indexOf("<"+t);for(;i>=0;){const s=r.indexOf(">",i),n=r.indexOf("</"+t);if(s===-1||n===-1)break;const a=r.indexOf(">",n);if(a===-1)break;e+=r.slice(s+1,n).trim(),r=r.slice(0,i).trim()+r.slice(a+1)}return{defs:e,content:r}}function Wm(r,t){return r?"<defs>"+r+"</defs>"+t:t}function jm(r,t,e){const i=Xm(r);return Wm(i.defs,t+i.content+e)}const Ym=r=>r==="unset"||r==="undefined"||r==="none";function qm(r,t){const e={...Ds,...r},i={...Xu,...t},s={left:e.left,top:e.top,width:e.width,height:e.height};let n=e.body;[e,i].forEach(y=>{const p=[],m=y.hFlip,_=y.vFlip;let v=y.rotate;m?_?v+=2:(p.push("translate("+(s.width+s.left).toString()+" "+(0-s.top).toString()+")"),p.push("scale(-1 1)"),s.top=s.left=0):_&&(p.push("translate("+(0-s.left).toString()+" "+(s.height+s.top).toString()+")"),p.push("scale(1 -1)"),s.top=s.left=0);let A;switch(v<0&&(v-=Math.floor(v/4)*4),v=v%4,v){case 1:A=s.height/2+s.top,p.unshift("rotate(90 "+A.toString()+" "+A.toString()+")");break;case 2:p.unshift("rotate(180 "+(s.width/2+s.left).toString()+" "+(s.height/2+s.top).toString()+")");break;case 3:A=s.width/2+s.left,p.unshift("rotate(-90 "+A.toString()+" "+A.toString()+")");break}v%2===1&&(s.left!==s.top&&(A=s.left,s.left=s.top,s.top=A),s.width!==s.height&&(A=s.width,s.width=s.height,s.height=A)),p.length&&(n=jm(n,'<g transform="'+p.join(" ")+'">',"</g>"))});const a=i.width,o=i.height,h=s.width,l=s.height;let c,u;a===null?(u=o===null?"1em":o==="auto"?l:o,c=rl(u,h/l)):(c=a==="auto"?h:a,u=o===null?rl(c,l/h):o==="auto"?l:o);const f={},d=(y,p)=>{Ym(p)||(f[y]=p.toString())};d("width",c),d("height",u);const g=[s.left,s.top,h,l];return f.viewBox=g.join(" "),{attributes:f,viewBox:g,body:n}}const Km=/\sid="(\S+)"/g,Zm="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let Qm=0;function Jm(r,t=Zm){const e=[];let i;for(;i=Km.exec(r);)e.push(i[1]);if(!e.length)return r;const s="suffix"+(Math.random()*16777216|Date.now()).toString(16);return e.forEach(n=>{const a=typeof t=="function"?t(n):t+(Qm++).toString(),o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");r=r.replace(new RegExp('([#;"])('+o+')([")]|\\.[a-z])',"g"),"$1"+a+s+"$3")}),r=r.replace(new RegExp(s,"g"),""),r}const Ha=Object.create(null);function tg(r,t){Ha[r]=t}function Va(r){return Ha[r]||Ha[""]}function Uo(r){let t;if(typeof r.resources=="string")t=[r.resources];else if(t=r.resources,!(t instanceof Array)||!t.length)return null;return{resources:t,path:r.path||"/",maxURL:r.maxURL||500,rotate:r.rotate||750,timeout:r.timeout||5e3,random:r.random===!0,index:r.index||0,dataAfterTimeout:r.dataAfterTimeout!==!1}}const Go=Object.create(null),Yr=["https://api.simplesvg.com","https://api.unisvg.com"],cs=[];for(;Yr.length>0;)Yr.length===1||Math.random()>.5?cs.push(Yr.shift()):cs.push(Yr.pop());Go[""]=Uo({resources:["https://api.iconify.design"].concat(cs)});function eg(r,t){const e=Uo(t);return e===null?!1:(Go[r]=e,!0)}function Do(r){return Go[r]}const rg=()=>{let r;try{if(r=fetch,typeof r=="function")return r}catch{}};let il=rg();function ig(r,t){const e=Do(r);if(!e)return 0;let i;if(!e.maxURL)i=0;else{let s=0;e.resources.forEach(a=>{s=Math.max(s,a.length)});const n=t+".json?icons=";i=e.maxURL-s-e.path.length-n.length}return i}function sg(r){return r===404}const ng=(r,t,e)=>{const i=[],s=ig(r,t),n="icons";let a={type:n,provider:r,prefix:t,icons:[]},o=0;return e.forEach((h,l)=>{o+=h.length+1,o>=s&&l>0&&(i.push(a),a={type:n,provider:r,prefix:t,icons:[]},o=h.length),a.icons.push(h)}),i.push(a),i};function ag(r){if(typeof r=="string"){const t=Do(r);if(t)return t.path}return"/"}const og=(r,t,e)=>{if(!il){e("abort",424);return}let i=ag(t.provider);switch(t.type){case"icons":{const n=t.prefix,o=t.icons.join(","),h=new URLSearchParams({icons:o});i+=n+".json?"+h.toString();break}case"custom":{const n=t.uri;i+=n.slice(0,1)==="/"?n.slice(1):n;break}default:e("abort",400);return}let s=503;il(r+i).then(n=>{const a=n.status;if(a!==200){setTimeout(()=>{e(sg(a)?"abort":"next",a)});return}return s=501,n.json()}).then(n=>{if(typeof n!="object"||n===null){setTimeout(()=>{n===404?e("abort",n):e("next",s)});return}setTimeout(()=>{e("success",n)})}).catch(()=>{e("next",s)})},hg={prepare:ng,send:og};function lg(r){const t={loaded:[],missing:[],pending:[]},e=Object.create(null);r.sort((s,n)=>s.provider!==n.provider?s.provider.localeCompare(n.provider):s.prefix!==n.prefix?s.prefix.localeCompare(n.prefix):s.name.localeCompare(n.name));let i={provider:"",prefix:"",name:""};return r.forEach(s=>{if(i.name===s.name&&i.prefix===s.prefix&&i.provider===s.provider)return;i=s;const n=s.provider,a=s.prefix,o=s.name,h=e[n]||(e[n]=Object.create(null)),l=h[a]||(h[a]=cr(n,a));let c;o in l.icons?c=t.loaded:a===""||l.missing.has(o)?c=t.missing:c=t.pending;const u={provider:n,prefix:a,name:o};c.push(u)}),t}function Wu(r,t){r.forEach(e=>{const i=e.loaderCallbacks;i&&(e.loaderCallbacks=i.filter(s=>s.id!==t))})}function cg(r){r.pendingCallbacksFlag||(r.pendingCallbacksFlag=!0,setTimeout(()=>{r.pendingCallbacksFlag=!1;const t=r.loaderCallbacks?r.loaderCallbacks.slice(0):[];if(!t.length)return;let e=!1;const i=r.provider,s=r.prefix;t.forEach(n=>{const a=n.icons,o=a.pending.length;a.pending=a.pending.filter(h=>{if(h.prefix!==s)return!0;const l=h.name;if(r.icons[l])a.loaded.push({provider:i,prefix:s,name:l});else if(r.missing.has(l))a.missing.push({provider:i,prefix:s,name:l});else return e=!0,!0;return!1}),a.pending.length!==o&&(e||Wu([r],n.id),n.callback(a.loaded.slice(0),a.missing.slice(0),a.pending.slice(0),n.abort))})}))}let ug=0;function dg(r,t,e){const i=ug++,s=Wu.bind(null,e,i);if(!t.pending.length)return s;const n={id:i,icons:t,callback:r,abort:s};return e.forEach(a=>{(a.loaderCallbacks||(a.loaderCallbacks=[])).push(n)}),s}function fg(r,t=!0,e=!1){const i=[];return r.forEach(s=>{const n=typeof s=="string"?Gs(s,t,e):s;n&&i.push(n)}),i}var pg={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function mg(r,t,e,i){const s=r.resources.length,n=r.random?Math.floor(Math.random()*s):r.index;let a;if(r.random){let S=r.resources.slice(0);for(a=[];S.length>1;){const b=Math.floor(Math.random()*S.length);a.push(S[b]),S=S.slice(0,b).concat(S.slice(b+1))}a=a.concat(S)}else a=r.resources.slice(n).concat(r.resources.slice(0,n));const o=Date.now();let h="pending",l=0,c,u=null,f=[],d=[];typeof i=="function"&&d.push(i);function g(){u&&(clearTimeout(u),u=null)}function y(){h==="pending"&&(h="aborted"),g(),f.forEach(S=>{S.status==="pending"&&(S.status="aborted")}),f=[]}function p(S,b){b&&(d=[]),typeof S=="function"&&d.push(S)}function m(){return{startTime:o,payload:t,status:h,queriesSent:l,queriesPending:f.length,subscribe:p,abort:y}}function _(){h="failed",d.forEach(S=>{S(void 0,c)})}function v(){f.forEach(S=>{S.status==="pending"&&(S.status="aborted")}),f=[]}function A(S,b,B){const G=b!=="success";switch(f=f.filter(L=>L!==S),h){case"pending":break;case"failed":if(G||!r.dataAfterTimeout)return;break;default:return}if(b==="abort"){c=B,_();return}if(G){c=B,f.length||(a.length?x():_());return}if(g(),v(),!r.random){const L=r.resources.indexOf(S.resource);L!==-1&&L!==r.index&&(r.index=L)}h="completed",d.forEach(L=>{L(B)})}function x(){if(h!=="pending")return;g();const S=a.shift();if(S===void 0){if(f.length){u=setTimeout(()=>{g(),h==="pending"&&(v(),_())},r.timeout);return}_();return}const b={status:"pending",resource:S,callback:(B,G)=>{A(b,B,G)}};f.push(b),l++,u=setTimeout(x,r.rotate),e(S,t,b.callback)}return setTimeout(x),m}function ju(r){const t={...pg,...r};let e=[];function i(){e=e.filter(o=>o().status==="pending")}function s(o,h,l){const c=mg(t,o,h,(u,f)=>{i(),l&&l(u,f)});return e.push(c),c}function n(o){return e.find(h=>o(h))||null}return{query:s,find:n,setIndex:o=>{t.index=o},getIndex:()=>t.index,cleanup:i}}function sl(){}const dn=Object.create(null);function gg(r){if(!dn[r]){const t=Do(r);if(!t)return;const e=ju(t),i={config:t,redundancy:e};dn[r]=i}return dn[r]}function yg(r,t,e){let i,s;if(typeof r=="string"){const n=Va(r);if(!n)return e(void 0,424),sl;s=n.send;const a=gg(r);a&&(i=a.redundancy)}else{const n=Uo(r);if(n){i=ju(n);const a=r.resources?r.resources[0]:"",o=Va(a);o&&(s=o.send)}}return!i||!s?(e(void 0,424),sl):i.query(t,s,e)().abort}const nl="iconify2",xi="iconify",Yu=xi+"-count",al=xi+"-version",qu=36e5,_g=168,xg=50;function za(r,t){try{return r.getItem(t)}catch{}}function $o(r,t,e){try{return r.setItem(t,e),!0}catch{}}function ol(r,t){try{r.removeItem(t)}catch{}}function Xa(r,t){return $o(r,Yu,t.toString())}function Wa(r){return parseInt(za(r,Yu))||0}const $s={local:!0,session:!0},Ku={local:new Set,session:new Set};let Ho=!1;function vg(r){Ho=r}let Li=typeof window>"u"?{}:window;function Zu(r){const t=r+"Storage";try{if(Li&&Li[t]&&typeof Li[t].length=="number")return Li[t]}catch{}$s[r]=!1}function Qu(r,t){const e=Zu(r);if(!e)return;const i=za(e,al);if(i!==nl){if(i){const o=Wa(e);for(let h=0;h<o;h++)ol(e,xi+h.toString())}$o(e,al,nl),Xa(e,0);return}const s=Math.floor(Date.now()/qu)-_g,n=o=>{const h=xi+o.toString(),l=za(e,h);if(typeof l=="string"){try{const c=JSON.parse(l);if(typeof c=="object"&&typeof c.cached=="number"&&c.cached>s&&typeof c.provider=="string"&&typeof c.data=="object"&&typeof c.data.prefix=="string"&&t(c,o))return!0}catch{}ol(e,h)}};let a=Wa(e);for(let o=a-1;o>=0;o--)n(o)||(o===a-1?(a--,Xa(e,a)):Ku[r].add(o))}function Ju(){if(!Ho){vg(!0);for(const r in $s)Qu(r,t=>{const e=t.data,i=t.provider,s=e.prefix,n=cr(i,s);if(!Oo(n,e).length)return!1;const a=e.lastModified||-1;return n.lastModifiedCached=n.lastModifiedCached?Math.min(n.lastModifiedCached,a):a,!0})}}function bg(r,t){const e=r.lastModifiedCached;if(e&&e>=t)return e===t;if(r.lastModifiedCached=t,e)for(const i in $s)Qu(i,s=>{const n=s.data;return s.provider!==r.provider||n.prefix!==r.prefix||n.lastModified===t});return!0}function wg(r,t){Ho||Ju();function e(i){let s;if(!$s[i]||!(s=Zu(i)))return;const n=Ku[i];let a;if(n.size)n.delete(a=Array.from(n).shift());else if(a=Wa(s),a>=xg||!Xa(s,a+1))return;const o={cached:Math.floor(Date.now()/qu),provider:r.provider,data:t};return $o(s,xi+a.toString(),JSON.stringify(o))}t.lastModified&&!bg(r,t.lastModified)||Object.keys(t.icons).length&&(t.not_found&&(t=Object.assign({},t),delete t.not_found),e("local")||e("session"))}function hl(){}function Ag(r){r.iconsLoaderFlag||(r.iconsLoaderFlag=!0,setTimeout(()=>{r.iconsLoaderFlag=!1,cg(r)}))}function Tg(r,t){r.iconsToLoad?r.iconsToLoad=r.iconsToLoad.concat(t).sort():r.iconsToLoad=t,r.iconsQueueFlag||(r.iconsQueueFlag=!0,setTimeout(()=>{r.iconsQueueFlag=!1;const{provider:e,prefix:i}=r,s=r.iconsToLoad;delete r.iconsToLoad;let n;if(!s||!(n=Va(e)))return;n.prepare(e,i,s).forEach(o=>{yg(e,o,h=>{if(typeof h!="object")o.icons.forEach(l=>{r.missing.add(l)});else try{const l=Oo(r,h);if(!l.length)return;const c=r.pendingIcons;c&&l.forEach(u=>{c.delete(u)}),wg(r,h)}catch(l){console.error(l)}Ag(r)})})}))}const Sg=(r,t)=>{const e=fg(r,!0,Vu()),i=lg(e);if(!i.pending.length){let h=!0;return t&&setTimeout(()=>{h&&t(i.loaded,i.missing,i.pending,hl)}),()=>{h=!1}}const s=Object.create(null),n=[];let a,o;return i.pending.forEach(h=>{const{provider:l,prefix:c}=h;if(c===o&&l===a)return;a=l,o=c,n.push(cr(l,c));const u=s[l]||(s[l]=Object.create(null));u[c]||(u[c]=[])}),i.pending.forEach(h=>{const{provider:l,prefix:c,name:u}=h,f=cr(l,c),d=f.pendingIcons||(f.pendingIcons=new Set);d.has(u)||(d.add(u),s[l][c].push(u))}),n.forEach(h=>{const{provider:l,prefix:c}=h;s[l][c].length&&Tg(h,s[l][c])}),t?dg(t,i,n):hl};function Cg(r,t){const e={...r};for(const i in t){const s=t[i],n=typeof s;i in zu?(s===null||s&&(n==="string"||n==="number"))&&(e[i]=s):n===typeof e[i]&&(e[i]=i==="rotate"?s%4:s)}return e}const Eg=/[\s,]+/;function Ig(r,t){t.split(Eg).forEach(e=>{switch(e.trim()){case"horizontal":r.hFlip=!0;break;case"vertical":r.vFlip=!0;break}})}function Pg(r,t=0){const e=r.replace(/^-?[0-9.]*/,"");function i(s){for(;s<0;)s+=4;return s%4}if(e===""){const s=parseInt(r);return isNaN(s)?0:i(s)}else if(e!==r){let s=0;switch(e){case"%":s=25;break;case"deg":s=90}if(s){let n=parseFloat(r.slice(0,r.length-e.length));return isNaN(n)?0:(n=n/s,n%1===0?i(n):0)}}return t}function Rg(r,t){let e=r.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const i in t)e+=" "+i+'="'+t[i]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+e+">"+r+"</svg>"}function Mg(r){return r.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function Fg(r){return"data:image/svg+xml,"+Mg(r)}function kg(r){return'url("'+Fg(r)+'")'}const ll={...Xu,inline:!1},Bg={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},Lg={display:"inline-block"},ja={"background-color":"currentColor"},td={"background-color":"transparent"},cl={image:"var(--svg)",repeat:"no-repeat",size:"100% 100%"},ul={"-webkit-mask":ja,mask:ja,background:td};for(const r in ul){const t=ul[r];for(const e in cl)t[r+"-"+e]=cl[e]}function Ng(r){return r+(r.match(/^[-0-9.]+$/)?"px":"")}function Og(r,t){const e=Cg(ll,t),i=t.mode||"svg",s=i==="svg"?{...Bg}:{};r.body.indexOf("xlink:")===-1&&delete s["xmlns:xlink"];let n=typeof t.style=="string"?t.style:"";for(let m in t){const _=t[m];if(_!==void 0)switch(m){case"icon":case"style":case"onLoad":case"mode":break;case"inline":case"hFlip":case"vFlip":e[m]=_===!0||_==="true"||_===1;break;case"flip":typeof _=="string"&&Ig(e,_);break;case"color":n=n+(n.length>0&&n.trim().slice(-1)!==";"?";":"")+"color: "+_+"; ";break;case"rotate":typeof _=="string"?e[m]=Pg(_):typeof _=="number"&&(e[m]=_);break;case"ariaHidden":case"aria-hidden":_!==!0&&_!=="true"&&delete s["aria-hidden"];break;default:if(m.slice(0,3)==="on:")break;ll[m]===void 0&&(s[m]=_)}}const a=qm(r,e),o=a.attributes;if(e.inline&&(n="vertical-align: -0.125em; "+n),i==="svg"){Object.assign(s,o),n!==""&&(s.style=n);let m=0,_=t.id;return typeof _=="string"&&(_=_.replace(/-/g,"_")),{svg:!0,attributes:s,body:Jm(a.body,_?()=>_+"ID"+m++:"iconifySvelte")}}const{body:h,width:l,height:c}=r,u=i==="mask"||(i==="bg"?!1:h.indexOf("currentColor")!==-1),f=Rg(h,{...o,width:l+"",height:c+""}),g={"--svg":kg(f)},y=m=>{const _=o[m];_&&(g[m]=Ng(_))};y("width"),y("height"),Object.assign(g,Lg,u?ja:td);let p="";for(const m in g)p+=m+": "+g[m]+";";return s.style=p+n,{svg:!1,attributes:s}}Vu(!0);tg("",hg);if(typeof document<"u"&&typeof window<"u"){Ju();const r=window;if(r.IconifyPreload!==void 0){const t=r.IconifyPreload,e="Invalid IconifyPreload syntax.";typeof t=="object"&&t!==null&&(t instanceof Array?t:[t]).forEach(i=>{try{(typeof i!="object"||i===null||i instanceof Array||typeof i.icons!="object"||typeof i.prefix!="string"||!Hm(i))&&console.error(e)}catch{console.error(e)}})}if(r.IconifyProviders!==void 0){const t=r.IconifyProviders;if(typeof t=="object"&&t!==null)for(let e in t){const i="IconifyProviders["+e+"] is invalid.";try{const s=t[e];if(typeof s!="object"||!s||s.resources===void 0)continue;eg(e,s)||console.error(i)}catch{console.error(i)}}}}function Ug(r,t,e,i,s){function n(){t.loading&&(t.loading.abort(),t.loading=null)}if(typeof r=="object"&&r!==null&&typeof r.body=="string")return t.name="",n(),{data:{...Ds,...r}};let a;if(typeof r!="string"||(a=Gs(r,!1,!0))===null)return n(),null;const o=Dm(a);if(!o)return e&&(!t.loading||t.loading.name!==r)&&(n(),t.name="",t.loading={name:r,abort:Sg([a],i)}),null;n(),t.name!==r&&(t.name=r,s&&!t.destroyed&&s(r));const h=["iconify"];return a.prefix!==""&&h.push("iconify--"+a.prefix),a.provider!==""&&h.push("iconify--"+a.provider),{data:o,classes:h}}function dl(r,t){return r?Og({...Ds,...r},t):null}var Gg=$t("<svg><!></svg>"),Dg=$t("<span></span>");function ed(r,t){const e=Tm(t,["children","$$slots","$$events","$$legacy"]);Fe(t,!1);const i=ue({name:"",loading:null,destroyed:!1});let s=ue(!1),n=ue(0),a=ue();const o=f=>{typeof e.onLoad=="function"&&e.onLoad(f),Cm()("load",{icon:f})};function h(){gm(n)}Ei(()=>{Zt(s,!0)}),Sm(()=>{cn(i,Q(i).destroyed=!0),Q(i).loading&&(Q(i).loading.abort(),cn(i,Q(i).loading=null))}),fm(()=>(Q(n),mm(e),Q(i),Q(s),Q(a),dl),()=>{Q(n);const f=Ug(e.icon,Q(i),Q(s),h,o);Zt(a,f?dl(f.data,e):null),Q(a)&&f.classes&&cn(a,Q(a).attributes.class=(typeof e.class=="string"?e.class+" ":"")+f.classes.join(" "))}),pm(),No();var l=Da(),c=Br(l);{var u=f=>{var d=Da(),g=Br(d);{var y=m=>{var _=Gg();let v;var A=pt(_);Fm(A,()=>Q(a).body),ut(_),de(()=>v=Qh(_,v,{...Q(a).attributes},void 0,!0)),St(m,_)},p=m=>{var _=Dg();let v;de(()=>v=Qh(_,v,{...Q(a).attributes})),St(m,_)};be(g,m=>{Q(a).svg?m(y):m(p,!1)})}St(f,d)};be(c,f=>{Q(a)&&f(u)})}St(r,l),ke()}var $g=Bo('<g id="Trans Flag"><g clip-path="url(#clip3_43_5)"><rect x="79" y="63.5745" width="52.516" height="34.5105" rx="9" transform="rotate(-17.2514 79 63.5745)" fill="white"></rect><rect id="Rectangle 4" x="79" y="63.5745" width="52.516" height="7.00213" transform="rotate(-17.2514 79 63.5745)" fill="#5BCEFA"></rect><rect id="Rectangle 5" x="81.0765" y="70.2616" width="52.516" height="7.00213" transform="rotate(-17.2514 81.0765 70.2616)" fill="#F5A9B8"></rect><rect id="Rectangle 8" x="85.0814" y="83.1582" width="52.516" height="7.00213" transform="rotate(-17.2514 85.0814 83.1582)" fill="#F5A9B8"></rect><rect id="Rectangle 7" x="87.1581" y="89.8453" width="52.516" height="7.00213" transform="rotate(-17.2514 87.1581 89.8453)" fill="#5BCEFA"></rect><rect id="Rectangle 9" x="94.6832" y="52.4197" width="8.00244" height="33.0101" transform="rotate(28.8538 94.6832 52.4197)" fill="white" fill-opacity="0.7"></rect><rect id="Rectangle 10" x="110.263" y="46.1309" width="2.85939" height="52.9811" transform="rotate(28.8538 110.263 46.1309)" fill="white" fill-opacity="0.7"></rect><ellipse id="Ellipse 8" cx="96.6795" cy="73.6738" rx="2.40111" ry="23.1805" transform="rotate(25.5757 96.6795 73.6738)" fill="url(#paint1_radial_43_5)"></ellipse><ellipse id="Ellipse 9" cx="91.3185" cy="69.1663" rx="6.61468" ry="23.1805" transform="rotate(25.5757 91.3185 69.1663)" fill="url(#paint2_radial_43_5)"></ellipse></g><rect x="80.2516" y="64.2329" width="50.516" height="32.5105" rx="8" transform="rotate(-17.2514 80.2516 64.2329)" stroke="white" stroke-width="2"></rect></g>'),Hg=Bo('<g id="Lesbian Flag"><g clip-path="url(#clip4_43_5)"><rect x="103.978" y="6" width="55.8744" height="36.7174" rx="9" transform="rotate(14.1539 103.978 6)" fill="white"></rect><rect id="Rectangle 4_2" x="103.978" y="6" width="55.8744" height="5.32137" transform="rotate(14.1539 103.978 6)" fill="#D52D00"></rect><rect id="Rectangle 5_2" x="102.677" y="11.1599" width="55.8744" height="5.32137" transform="rotate(14.1539 102.677 11.1599)" fill="#EF7627"></rect><rect id="Rectangle 8_2" x="101.376" y="16.3196" width="55.8744" height="5.32137" transform="rotate(14.1539 101.376 16.3196)" fill="#FF9A56"></rect><rect id="Rectangle 7_2" x="98.9037" y="26.1233" width="55.8744" height="5.32137" transform="rotate(14.1539 98.9037 26.1233)" fill="#D162A4"></rect><rect id="Rectangle 9_2" x="97.6024" y="31.2831" width="55.8744" height="5.32137" transform="rotate(14.1539 97.6024 31.2831)" fill="#B55690"></rect><g id="Highlights"><rect id="Rectangle 9_3" x="124.405" y="4.56555" width="8.51419" height="35.121" transform="rotate(60.2591 124.405 4.56555)" fill="white" fill-opacity="0.7"></rect><rect id="Rectangle 10_2" x="142.038" y="7.49219" width="3.04225" height="56.3692" transform="rotate(60.2591 142.038 7.49219)" fill="white" fill-opacity="0.7"></rect><ellipse id="Ellipse 8_2" cx="114.434" cy="24.9727" rx="2.55466" ry="24.6629" transform="rotate(56.981 114.434 24.9727)" fill="url(#paint3_radial_43_5)"></ellipse><ellipse id="Ellipse 9_2" cx="112.064" cy="17.9074" rx="7.03768" ry="24.6629" transform="rotate(56.981 112.064 17.9074)" fill="url(#paint4_radial_43_5)"></ellipse></g><rect id="Rectangle 10_3" x="96.3011" y="36.443" width="55.8744" height="5.32137" transform="rotate(14.1539 96.3011 36.443)" fill="#A30262"></rect></g><rect x="104.704" y="7.21417" width="53.8744" height="34.7174" rx="8" transform="rotate(14.1539 104.704 7.21417)" stroke="white" stroke-width="2"></rect></g>'),Vg=Bo('<svg width="301" height="315" viewBox="0 0 301 315" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="Floppy"><g id="Floppy_2"><g id="Base"><g filter="url(#filter0_i_43_5)"><path d="M2 305V8.5C2 5.18629 4.68629 2.5 8 2.5H28.5C29.6046 2.5 30.5 3.39543 30.5 4.5C30.5 5.60457 31.3954 6.5 32.5 6.5H234.219C235.688 6.5 237.107 5.96073 238.205 4.98446L239.295 4.01554C240.393 3.03927 241.812 2.5 243.281 2.5H264.5H276.515C278.106 2.5 279.632 3.13214 280.757 4.25736L294.243 17.7426C295.368 18.8679 296 20.394 296 21.9853V305C296 308.314 293.314 311 290 311H8C4.68629 311 2 308.314 2 305Z" fill="#FFB7F2"></path></g><path d="M1 8.5V305C1 308.866 4.13401 312 8 312H290C293.866 312 297 308.866 297 305V21.9853C297 20.1288 296.263 18.3483 294.95 17.0355L281.464 3.55025C280.152 2.2375 278.371 1.5 276.515 1.5H264.5H243.281C241.567 1.5 239.912 2.12915 238.631 3.26813L237.541 4.23705C236.625 5.05061 235.443 5.5 234.219 5.5H32.5C31.9477 5.5 31.5 5.05228 31.5 4.5C31.5 2.84315 30.1569 1.5 28.5 1.5H8C4.13401 1.5 1 4.63401 1 8.5Z" stroke="#663D66" stroke-width="2"></path></g><g id="Mask group" filter="url(#filter1_i_43_5)"><mask id="mask0_43_5" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="294" height="309"><path id="Vector 7" d="M3 305V8.5C3 5.73858 5.23858 3.5 8 3.5H28.5C29.0523 3.5 29.5 3.94771 29.5 4.5C29.5 6.15686 30.8432 7.5 32.5 7.5H234.219C235.933 7.5 237.588 6.87085 238.869 5.73187L239.959 4.76295C240.875 3.94939 242.057 3.5 243.281 3.5H264.5H276.515C277.841 3.5 279.113 4.02678 280.05 4.96446L280.756 4.25867L280.05 4.96447L293.536 18.4497C294.473 19.3874 295 20.6592 295 21.9853V305C295 307.761 292.761 310 290 310H8C5.23857 310 3 307.761 3 305Z" fill="#FFB7F2" stroke="#663D66" stroke-width="2"></path></mask><g mask="url(#mask0_43_5)"><path id="Rectangle 3" d="M31 -14C31 -16.2091 32.7909 -18 35 -18H227C229.209 -18 231 -16.2091 231 -14V97C231 102.523 226.523 107 221 107H41C35.4772 107 31 102.523 31 97V-14Z" fill="#CA8FBF"></path></g></g><g id="Paper bit"><g filter="url(#filter2_ii_43_5)"><path d="M29 137C29 133.134 32.134 130 36 130H262C265.866 130 269 133.134 269 137V311H29V137Z" fill="#E3F5FF"></path></g><path d="M36 131H262C265.314 131 268 133.686 268 137V310H30V137C30 133.686 32.6863 131 36 131Z" stroke="#474247" stroke-width="2"></path></g><path id="Vector 8" d="M176 216.5C180.5 202 202 195 226 196C226.833 196 231.2 193.3 242 182.5C252.773 171.727 249.185 177.139 262.896 184.941C262.958 184.976 263 185.042 263 185.114C263.004 226.144 265.398 303.901 263 305.5C260 307.5 82 305 66.5 305C53.0371 305 53 293 53.5 291C54 289 76 263.5 112.5 250C149 236.5 126.5 270.5 150.5 276.5C174.5 282.5 171.5 231 176 216.5Z" fill="#D9D9D9" fill-opacity="0.5"></path><g id="Frame 2" clip-path="url(#clip0_43_5)"><g id="Rectangle 2"><g filter="url(#filter3_i_43_5)"><path d="M72 5C72 2.79086 73.7909 1 76 1H227C229.209 1 231 2.79086 231 5V97C231 102.523 226.523 107 221 107H82C76.4772 107 72 102.523 72 97V5Z" fill="#D9D9D9"></path></g><path d="M76 2H227C228.657 2 230 3.34314 230 5V97C230 101.971 225.971 106 221 106H82C77.0294 106 73 101.971 73 97V5C73 3.34314 74.3431 2 76 2Z" stroke="#505050" stroke-width="2"></path></g><ellipse id="Ellipse 10" cx="98.3348" cy="28.7533" rx="25.288" ry="51" transform="rotate(38.0204 98.3348 28.7533)" fill="url(#paint0_radial_43_5)"></ellipse></g><g id="Rectangle 3_2" opacity="0.4"><g filter="url(#filter4_i_43_5)"><rect x="165" y="18" width="40" height="82" rx="4" fill="#FFB7F2"></rect></g><rect x="165.5" y="18.5" width="39" height="81" rx="3.5" stroke="#4A484A"></rect></g><g id="Frame"><path id="Vector" d="M259.042 44.1666H261.958V26.6666H264.875V23.75H261.958V20.8333H259.042V23.75H256.125V26.6666H259.042V44.1666ZM253.208 29.5833V26.6666H256.125V29.5833H253.208ZM253.208 29.5833V32.5H250.292V29.5833H253.208ZM267.792 29.5833V26.6666H264.875V29.5833H267.792ZM267.792 29.5833V32.5H270.708V29.5833H267.792Z" fill="#663D66"></path></g><g id="Frame_2" clip-path="url(#clip1_43_5)"><path id="Vector_2" d="M17.1664 109.701L13.3773 110.982L14.0181 112.877L12.1235 113.518L12.7643 115.412L10.8697 116.053L12.7921 121.737L14.6867 121.096L15.3275 122.99L17.222 122.35L17.8628 124.244L19.7574 123.603L20.3982 125.498L22.2928 124.857L22.9336 126.752L24.8281 126.111L25.4689 128.005L27.3635 127.365L26.7227 125.47L28.6173 124.829L27.9765 122.935L29.871 122.294L29.2302 120.399L31.1248 119.759L30.484 117.864L32.3786 117.223L31.7378 115.329L33.6323 114.688L31.71 109.004L29.8154 109.645L29.1746 107.75L27.28 108.391L26.6392 106.497L22.8501 107.778L23.4909 109.673L21.5963 110.314L22.2371 112.208L20.3426 112.849L19.7018 110.954L17.8072 111.595L17.1664 109.701ZM17.8072 111.595L18.448 113.49L20.3426 112.849L20.9834 114.743L22.8779 114.103L22.2371 112.208L24.1317 111.567L23.4909 109.673L27.28 108.391L27.9208 110.286L29.8154 109.645L31.7378 115.329L29.8432 115.969L30.484 117.864L28.5894 118.505L29.2302 120.399L27.3357 121.04L27.9765 122.935L26.0819 123.575L26.7227 125.47L24.8281 126.111L24.1873 124.216L22.2928 124.857L21.652 122.963L19.7574 123.603L19.1166 121.709L17.222 122.35L16.5812 120.455L14.6867 121.096L12.7643 115.412L14.6589 114.771L14.0181 112.877L17.8072 111.595Z" fill="#663D66"></path></g><g id="Frame_3" clip-path="url(#clip2_43_5)"><path id="Vector_3" d="M43.5338 112.427L41.103 112.468L41.1232 113.683L39.9078 113.703L39.928 114.919L38.7126 114.939L38.7732 118.585L39.9886 118.565L40.0088 119.78L41.2242 119.76L41.2444 120.975L42.4598 120.955L42.48 122.171L43.6954 122.15L43.7155 123.366L44.9309 123.346L44.9511 124.561L46.1665 124.541L46.1463 123.325L47.3617 123.305L47.3415 122.09L48.5569 122.07L48.5368 120.854L49.7521 120.834L49.732 119.619L50.9474 119.598L50.9272 118.383L52.1426 118.363L52.082 114.717L50.8666 114.737L50.8464 113.521L49.631 113.542L49.6108 112.326L47.18 112.367L47.2002 113.582L45.9848 113.602L46.005 114.818L44.7896 114.838L44.7694 113.622L43.554 113.643L43.5338 112.427ZM43.554 113.643L43.5742 114.858L44.7896 114.838L44.8098 116.053L46.0252 116.033L46.005 114.818L47.2204 114.797L47.2002 113.582L49.631 113.542L49.6512 114.757L50.8666 114.737L50.9272 118.383L49.7118 118.403L49.732 119.619L48.5166 119.639L48.5368 120.854L47.3214 120.874L47.3415 122.09L46.1261 122.11L46.1463 123.325L44.9309 123.346L44.9108 122.13L43.6954 122.15L43.6752 120.935L42.4598 120.955L42.4396 119.74L41.2242 119.76L41.204 118.545L39.9886 118.565L39.928 114.919L41.1434 114.898L41.1232 113.683L43.554 113.643Z" fill="#663D66"></path></g><!><!><path id="Line 17" d="M42 165H254" stroke="#4A484A" stroke-opacity="0.5" stroke-width="3" stroke-linecap="round"></path><path id="Line 18" d="M42 197H254" stroke="#4A484A" stroke-opacity="0.5" stroke-width="3" stroke-linecap="round"></path><path id="Line 19" d="M42 228H254" stroke="#4A484A" stroke-opacity="0.5" stroke-width="3" stroke-linecap="round"></path><path id="Line 20" d="M42 258H254" stroke="#4A484A" stroke-opacity="0.5" stroke-width="3" stroke-linecap="round"></path><path id="Line 21" d="M42 290H254" stroke="#4A484A" stroke-opacity="0.5" stroke-width="3" stroke-linecap="round"></path></g><text x="40" y="160" fill="#663D66" font-family="cursive"> </text><g id="Highlights_2"><mask id="mask1_43_5" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="298" height="313"><path id="Base_2" d="M1 8.5V305C1 308.866 4.13401 312 8 312H290C293.866 312 297 308.866 297 305V21.9853C297 20.1288 296.263 18.3483 294.95 17.0355L281.464 3.55025C280.152 2.2375 278.371 1.5 276.515 1.5H264.5H243.281C241.567 1.5 239.912 2.12915 238.631 3.26813L237.541 4.23705C236.625 5.05061 235.443 5.5 234.219 5.5H32.5C31.9477 5.5 31.5 5.05228 31.5 4.5C31.5 2.84315 30.1569 1.5 28.5 1.5H8C4.13401 1.5 1 4.63401 1 8.5Z" fill="#FFB7F2" stroke="#663D66" stroke-width="2"></path></mask><g mask="url(#mask1_43_5)"><g id="Highlights_3" opacity="0.4"><rect id="Rectangle 9_4" x="156.858" y="-88.6324" width="81.6832" height="336.943" transform="rotate(46.1052 156.858 -88.6324)" fill="white" fill-opacity="0.7"></rect><rect id="Rectangle 10_4" x="327.764" y="-102.775" width="29.1867" height="540.793" transform="rotate(46.1052 327.764 -102.775)" fill="white" fill-opacity="0.7"></rect><ellipse id="Ellipse 8_3" cx="111.979" cy="124.597" rx="24.5088" ry="236.61" transform="rotate(42.8271 111.979 124.597)" fill="url(#paint5_radial_43_5)"></ellipse><ellipse id="Ellipse 9_3" cx="73.3632" cy="64.43" rx="67.5179" ry="236.61" transform="rotate(42.8271 73.3632 64.43)" fill="url(#paint6_radial_43_5)"></ellipse></g></g></g></g><defs><filter id="filter0_i_43_5" x="0" y="0.5" width="298" height="312.5" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"></feColorMatrix><feOffset dx="-8" dy="-8"></feOffset><feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"></feComposite><feColorMatrix type="matrix" values="0 0 0 0 0.655 0 0 0 0 0.384813 0 0 0 0 0.655 0 0 0 1 0"></feColorMatrix><feBlend mode="normal" in2="shape" result="effect1_innerShadow_43_5"></feBlend></filter><filter id="filter1_i_43_5" x="31" y="2.5" width="200" height="108.5" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"></feColorMatrix><feOffset dy="4"></feOffset><feGaussianBlur stdDeviation="2"></feGaussianBlur><feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"></feComposite><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"></feColorMatrix><feBlend mode="normal" in2="shape" result="effect1_innerShadow_43_5"></feBlend></filter><filter id="filter2_ii_43_5" x="29" y="130" width="240" height="181" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"></feColorMatrix><feOffset dx="-6" dy="-6"></feOffset><feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"></feComposite><feColorMatrix type="matrix" values="0 0 0 0 0.5125 0 0 0 0 0.467656 0 0 0 0 0.5125 0 0 0 1 0"></feColorMatrix><feBlend mode="normal" in2="shape" result="effect1_innerShadow_43_5"></feBlend><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"></feColorMatrix><feOffset dx="4" dy="4"></feOffset><feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"></feComposite><feColorMatrix type="matrix" values="0 0 0 0 0.513726 0 0 0 0 0.466667 0 0 0 0 0.513726 0 0 0 1 0"></feColorMatrix><feBlend mode="normal" in2="effect1_innerShadow_43_5" result="effect2_innerShadow_43_5"></feBlend></filter><filter id="filter3_i_43_5" x="72" y="1" width="159" height="106" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"></feColorMatrix><feOffset dx="-4" dy="-4"></feOffset><feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"></feComposite><feColorMatrix type="matrix" values="0 0 0 0 0.403922 0 0 0 0 0.403922 0 0 0 0 0.403922 0 0 0 1 0"></feColorMatrix><feBlend mode="normal" in2="shape" result="effect1_innerShadow_43_5"></feBlend></filter><filter id="filter4_i_43_5" x="165" y="18" width="42" height="84" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"></feColorMatrix><feOffset dx="3" dy="3"></feOffset><feGaussianBlur stdDeviation="1"></feGaussianBlur><feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"></feComposite><feColorMatrix type="matrix" values="0 0 0 0 0.655 0 0 0 0 0.384813 0 0 0 0 0.655 0 0 0 1 0"></feColorMatrix><feBlend mode="normal" in2="shape" result="effect1_innerShadow_43_5"></feBlend></filter><radialGradient id="paint0_radial_43_5" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(98.3348 28.7533) rotate(90) scale(51 25.288)"><stop stop-color="white"></stop><stop offset="1" stop-color="white" stop-opacity="0"></stop></radialGradient><radialGradient id="paint1_radial_43_5" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(96.6795 73.6737) rotate(90) scale(23.1805 2.40111)"><stop offset="0.285" stop-color="white"></stop><stop offset="1" stop-color="white" stop-opacity="0"></stop></radialGradient><radialGradient id="paint2_radial_43_5" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(91.3185 69.1663) rotate(90) scale(23.1805 6.61468)"><stop offset="0.285" stop-color="white"></stop><stop offset="1" stop-color="white" stop-opacity="0"></stop></radialGradient><radialGradient id="paint3_radial_43_5" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(114.434 24.9727) rotate(90) scale(24.6629 2.55466)"><stop offset="0.285" stop-color="white"></stop><stop offset="1" stop-color="white" stop-opacity="0"></stop></radialGradient><radialGradient id="paint4_radial_43_5" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(112.064 17.9074) rotate(90) scale(24.6629 7.03768)"><stop offset="0.285" stop-color="white"></stop><stop offset="1" stop-color="white" stop-opacity="0"></stop></radialGradient><radialGradient id="paint5_radial_43_5" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(111.979 124.597) rotate(90) scale(236.61 24.5088)"><stop offset="0.285" stop-color="white"></stop><stop offset="1" stop-color="white" stop-opacity="0"></stop></radialGradient><radialGradient id="paint6_radial_43_5" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(73.3632 64.43) rotate(90) scale(236.61 67.5179)"><stop offset="0.285" stop-color="white"></stop><stop offset="1" stop-color="white" stop-opacity="0"></stop></radialGradient><clipPath id="clip0_43_5"><rect width="159" height="106" fill="white" transform="translate(72 1)"></rect></clipPath><clipPath id="clip1_43_5"><rect width="24" height="24" fill="white" transform="translate(8 110.69) rotate(-18.687)"></rect></clipPath><clipPath id="clip2_43_5"><rect width="14.5868" height="14.5868" fill="white" transform="translate(38.0443 111.303) rotate(-0.951745)"></rect></clipPath><clipPath id="clip3_43_5"><rect x="79" y="63.5745" width="52.516" height="34.5105" rx="9" transform="rotate(-17.2514 79 63.5745)" fill="white"></rect></clipPath><clipPath id="clip4_43_5"><rect x="103.978" y="6" width="55.8744" height="36.7174" rx="9" transform="rotate(14.1539 103.978 6)" fill="white"></rect></clipPath></defs></svg>');function fl(r,t){Fe(t,!0);var e=Vg(),i=pt(e),s=pt(i),n=kt(pt(s),9);{var a=u=>{var f=$g();St(u,f)};be(n,u=>{t.flags.includes("trans")&&u(a)})}var o=kt(n);{var h=u=>{var f=Hg();St(u,f)};be(o,u=>{t.flags.includes("lesbian")&&u(h)})}os(5),ut(s);var l=kt(s),c=pt(l,!0);ut(l),os(),ut(i),os(),ut(e),de(()=>{km(e,t.className),gi(c,t.text)}),St(r,e),ke()}var zg=$t('<button class="btn btn-md btn-circle btn-ghost absolute right-2 top-2">✕</button>'),Xg=$t('<dialog class="modal"><div><!> <h3 class="text-lg font-bold absolute top-3"> </h3> <div class="divider pt-5"></div> <!></div></dialog>'),Wg=$t('<button class="btn btn-md btn-circle btn-ghost absolute right-2 top-2">✕</button>'),jg=$t('<dialog class="modal"><div><!> <h3 class="text-lg font-bold absolute top-4"> </h3> <div class="divider pt-5"></div> <!></div></dialog>');function rd(r,t){Fe(t,!0);let e=hs(t,"hasCloseButton",3,!0),i=hs(t,"canClose",3,!0),s=hs(t,"className",3,""),n;function a(){n.showModal(),h&&(n.style.transform="translateY(0px)")}function o(){h&&(n.style.transform="translateY(200px)"),n.close()}let h=navigator.userAgent.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i),l,c,u=!1;function f(v){l=v.touches[0].clientY,u=!0}function d(v){if(!u)return;c=v.touches[0].clientY;const A=c-l;if(A<0){const x=.99-Math.min(-A/2e3,.03),S=1-x,b=n.offsetHeight,B=-(1-x)*b;n.style.transform=`translateY(${B}px) scale(${x}, ${1/x+S})`}else n.style.transform=`translateY(${Math.max(0,A)}px)`}function g(){u=!1,c-l>window.innerHeight/4?i()?o():n.style.transform="translateY(200px)":n.style.transform=""}Ei(()=>{h&&(n.style.transform="translateY(200px)")});var y=Da(),p=Br(y);{var m=v=>{var A=Xg(),x=pt(A),S=pt(x);{var b=O=>{var N=zg();N.__click=o,St(O,N)};be(S,O=>{e()&&O(b)})}var B=kt(S,2),G=pt(B,!0);ut(B);var L=kt(B,4);Zh(L,t,"default",{}),ut(x),ut(A),$e(A,O=>n=O,()=>n),de(()=>{yi(x,`modal-box ${s()??""}`),gi(G,t.title)}),St(v,A)},_=v=>{var A=jg();A.__touchstart=f,A.__touchmove=d,A.__touchend=g;var x=pt(A),S=pt(x);{var b=O=>{var N=Wg();N.__click=o,St(O,N)};be(S,O=>{e()&&O(b)})}var B=kt(S,2),G=pt(B,!0);ut(B);var L=kt(B,4);Zh(L,t,"default",{}),ut(x),ut(A),$e(A,O=>n=O,()=>n),de(()=>{yi(x,`modal-box absolute !bottom-0 !rounded-b-none overflow-x-hidden ${s()??""}`),gi(G,t.title)}),St(v,A)};be(p,v=>{h?v(_,!1):v(m)})}return St(r,y),ke({open:a,close:o})}Us(["click","touchstart","touchmove","touchend"]);var Yg=(r,t,e)=>{Zt(t,-1),Zt(e,-1)},qg=$t("<button><!></button>"),Kg=(r,t,e,i)=>{Zt(t,Q(e)),setTimeout(()=>{i[Q(t)].click()},500)},Zg=$t('<button class="btn mt-4 svelte-1mvmpg4">Select!</button>'),Qg=$t('<div class="relative flex w-[20%] flex-col justify-center transition-all duration-300 svelte-1mvmpg4"><button class="svelte-1mvmpg4"><!></button> <!></div>'),Jg=$t('<div class="flex items-center justify-center overflow-auto p-10 svelte-1mvmpg4"></div>'),ty=$t('<div class="h-1/3 transition-all duration-75 svelte-1mvmpg4"><div class="flex h-full flex-col items-center overflow-hidden svelte-1mvmpg4"><img src="floppy-reader/Top.svg" class="z-20 w-6/12 svelte-1mvmpg4" alt="the top of the floppy disk reader"> <img src="floppy-reader/Bottom.svg" class="w-6/12 svelte-1mvmpg4" alt="the bottom of the floppy disk reader"> <!></div></div> <!>',1);function ey(r,t){Fe(t,!1);let e=ue();const i=[{text:"Meow",flags:[],click(){alert("Meowww Meowww :3")}},{text:":3",flags:["trans"],click(){alert("Coming soon")}},{text:"Im so gay omg",flags:["trans","lesbian"],click(){alert(":3")}},{text:"Lol this feature isnt done",flags:["trans"],click(){alert("what did I just tell you? XD")}}];let s=ue(-1),n=ue(-1);function a(){Q(e).open()}function o(){Q(e).close()}return $e(rd(r,{title:"Select A Floppy",hasCloseButton:!0,canClose:!0,className:"absolute top-0 left-0 w-screen h-screen !max-w-[100vw] !max-h-[100vh] overflow-hidden",children:(h,l)=>{var c=ty(),u=Br(c),f=pt(u),d=kt(pt(f),4);{var g=m=>{var _=qg();_.__click=[Yg,s,n];var v=pt(_);fl(v,{className:"w-full h-full",get text(){return i[Q(s)].text},get flags(){return i[Q(s)].flags}}),ut(_),de(()=>yi(_,`z-10 h-fit w-4/12 transition-all duration-1000 ${(Q(s)!==-1?"translate-y-[-100%]":"translate-y-0")??""} svelte-1mvmpg4`)),St(m,_)};be(d,m=>{Q(s)!==-1&&m(g)})}ut(f),ut(u);var y=kt(u,2);{var p=m=>{var _=Jg();Nu(_,5,()=>i,Lu,(v,A,x)=>{var S=Qg();gr(S,"ml-0",x===0);var b=pt(S);b.__click=()=>Zt(n,Q(n)===x?-1:x);var B=pt(b);fl(B,{className:"w-full h-full",get text(){return Q(A).text},get flags(){return Q(A).flags}}),ut(b);var G=kt(b,2);{var L=O=>{var N=Zg();N.__click=[Kg,s,n,i],St(O,N)};be(G,O=>{Q(n)===x&&O(L)})}ut(S),de(()=>{gr(S,"-ml-[10%]",x!==0&&Q(n)!==x-1),gr(b,"selected",Q(n)===x),gr(b,"scale-110",Q(n)===x)}),St(v,S)}),ut(_),St(m,_)};be(y,m=>{Q(s)===-1&&m(p)})}de(()=>{gr(u,"!h-full",Q(s)!==-1),gr(f,"justify-center",Q(s)!==-1)}),St(h,c)},$$slots:{default:!0},$$legacy:!0}),h=>Zt(e,h),()=>Q(e)),Ts(t,"open",a),Ts(t,"close",o),ke({open:a,close:o})}Us(["click"]);var ry=$t('<button class="opacity-10 transition-all duration-1000 ease-out hover:opacity-100" tabindex="-1"><!></button>'),iy=$t('<div class=" h-screen w-screen overflow-clip"><div class="scroll-container svelte-1dj7lb"><div class="grid svelte-1dj7lb"></div></div></div> <!>',1);function sy(r,t){Fe(t,!1);let e=ue();const i=30,s=60;let n=ue(["mage:folder","mage:camera-fill","mage:cup-hot","mage:exclamation-triangle","mage:fire-a","mage:gameboy","mage:gift","mage:health-square","mage:heart","mage:message-dots-question-mark","mage:memory-card","mage:female","mage:ribbon","mage:save-floppy"]);const a={"mage:female":{click:f=>{alert("Yeah im a girl :) 🏳️‍⚧️🏳️‍⚧️🏳️‍⚧️🏳️‍⚧️")}},"mage:heart":{click:f=>{Zt(n,[...Q(n),"mage:heart-fill"])}},"mage:cup-hot":{click:f=>{window.open("https://ko-fi.com/chaotickitsune")}},"mage:save-floppy":{click:f=>{Q(e).open()}}};No();var o=iy(),h=Br(o),l=pt(h),c=pt(l);Pr(c,"style",`--rows: ${i}; --cols: ${s};`),Nu(c,5,()=>Array(i*s),Lu,(f,d,g)=>{var y=ry(),p=pt(y);ed(p,{get icon(){return Q(n)[g%Q(n).length]},height:"2rem",get class(){return["text-primary","text-secondary","text-accent"][g%8]}}),ut(y),wm("click",y,function(...m){var _,v;(v=(_=a[Q(n)[g%Q(n).length]]||{})==null?void 0:_.click)==null||v.apply(this,m)}),St(f,y)}),ut(c),ut(l),ut(h);var u=kt(h,2);$e(ey(u,{$$legacy:!0}),f=>Zt(e,f),()=>Q(e)),St(r,o),ke()}var ny=$t('<a target="_blank"><img class=" svelte-1l8me2v"></a>');function ay(r,t){var e=ny(),i=pt(e);ut(e),de(()=>{Pr(e,"href",t.url),Pr(i,"src",t.icon),Pr(i,"alt",t.alt)}),St(r,e)}var oy=$t("<a><!> </a>");function fn(r,t){var e=oy(),i=pt(e);ed(i,{get icon(){return t.icon},height:"2rem"});var s=kt(i,1,!0);ut(e),de(()=>{yi(e,`frosted-glass btn join-item transition-all duration-500 hover:btn-primary ${t.className??""}`),Pr(e,"href",t.link),gi(s,t.text)}),St(r,e)}var hy=$t('<h3>My 88x31:</h3> <p>Coming soon</p> <div class="divider"></div> <div class="flex justify-center"><!></div>',1);function ly(r,t){Fe(t,!1);let e=ue();function i(){Q(e).open()}function s(){Q(e).close()}return $e(rd(r,{title:"88x31's",hasCloseButton:!0,canClose:!0,children:(n,a)=>{var o=hy(),h=kt(Br(o),6),l=pt(h);ay(l,{icon:"https://amy.rip/88x31.png",url:"https://amy.rip/",alt:"Amy page"}),ut(h),St(n,o)},$$slots:{default:!0},$$legacy:!0}),n=>Zt(e,n),()=>Q(e)),Ts(t,"open",i),Ts(t,"close",s),ke({open:i,close:s})}var Z=(r=>(r.Application="application",r.WebGLPipes="webgl-pipes",r.WebGLPipesAdaptor="webgl-pipes-adaptor",r.WebGLSystem="webgl-system",r.WebGPUPipes="webgpu-pipes",r.WebGPUPipesAdaptor="webgpu-pipes-adaptor",r.WebGPUSystem="webgpu-system",r.CanvasSystem="canvas-system",r.CanvasPipesAdaptor="canvas-pipes-adaptor",r.CanvasPipes="canvas-pipes",r.Asset="asset",r.LoadParser="load-parser",r.ResolveParser="resolve-parser",r.CacheParser="cache-parser",r.DetectionParser="detection-parser",r.MaskEffect="mask-effect",r.BlendMode="blend-mode",r.TextureSource="texture-source",r.Environment="environment",r.ShapeBuilder="shape-builder",r.Batcher="batcher",r))(Z||{});const Ya=r=>{if(typeof r=="function"||typeof r=="object"&&r.extension){if(!r.extension)throw new Error("Extension class must have an extension object");r={...typeof r.extension!="object"?{type:r.extension}:r.extension,ref:r}}if(typeof r=="object")r={...r};else throw new Error("Invalid extension type");return typeof r.type=="string"&&(r.type=[r.type]),r},Ni=(r,t)=>Ya(r).priority??t,Kt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...r){return r.map(Ya).forEach(t=>{t.type.forEach(e=>{var i,s;return(s=(i=this._removeHandlers)[e])==null?void 0:s.call(i,t)})}),this},add(...r){return r.map(Ya).forEach(t=>{t.type.forEach(e=>{var n,a;const i=this._addHandlers,s=this._queue;i[e]?(a=i[e])==null||a.call(i,t):(s[e]=s[e]||[],(n=s[e])==null||n.push(t))})}),this},handle(r,t,e){var a;const i=this._addHandlers,s=this._removeHandlers;if(i[r]||s[r])throw new Error(`Extension type ${r} already has a handler`);i[r]=t,s[r]=e;const n=this._queue;return n[r]&&((a=n[r])==null||a.forEach(o=>t(o)),delete n[r]),this},handleByMap(r,t){return this.handle(r,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(r,t,e=-1){return this.handle(r,i=>{t.findIndex(n=>n.name===i.name)>=0||(t.push({name:i.name,value:i.ref}),t.sort((n,a)=>Ni(a.value,e)-Ni(n.value,e)))},i=>{const s=t.findIndex(n=>n.name===i.name);s!==-1&&t.splice(s,1)})},handleByList(r,t,e=-1){return this.handle(r,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((s,n)=>Ni(n,e)-Ni(s,e)))},i=>{const s=t.indexOf(i.ref);s!==-1&&t.splice(s,1)})}},cy={extension:{type:Z.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await As(()=>import("./browserAll.1E3r4JN3.js"),__vite__mapDeps([0,1,2]),import.meta.url)}},uy={extension:{type:Z.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await As(()=>import("./webworkerAll.COaxBBuE.js"),__vite__mapDeps([1,2]),import.meta.url)}};let le=class id{constructor(t,e,i){this._x=e||0,this._y=i||0,this._observer=t}clone(t){return new id(t??this._observer,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}};var Cs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Hs(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function dy(r){if(r.__esModule)return r;var t=r.default;if(typeof t=="function"){var e=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var s=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:function(){return r[i]}})}),e}var pn={exports:{}},pl;function fy(){return pl||(pl=1,function(r){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function s(h,l,c){this.fn=h,this.context=l,this.once=c||!1}function n(h,l,c,u,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var d=new s(c,u||h,f),g=e?e+l:l;return h._events[g]?h._events[g].fn?h._events[g]=[h._events[g],d]:h._events[g].push(d):(h._events[g]=d,h._eventsCount++),h}function a(h,l){--h._eventsCount===0?h._events=new i:delete h._events[l]}function o(){this._events=new i,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],c,u;if(this._eventsCount===0)return l;for(u in c=this._events)t.call(c,u)&&l.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},o.prototype.listeners=function(l){var c=e?e+l:l,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var f=0,d=u.length,g=new Array(d);f<d;f++)g[f]=u[f].fn;return g},o.prototype.listenerCount=function(l){var c=e?e+l:l,u=this._events[c];return u?u.fn?1:u.length:0},o.prototype.emit=function(l,c,u,f,d,g){var y=e?e+l:l;if(!this._events[y])return!1;var p=this._events[y],m=arguments.length,_,v;if(p.fn){switch(p.once&&this.removeListener(l,p.fn,void 0,!0),m){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,c),!0;case 3:return p.fn.call(p.context,c,u),!0;case 4:return p.fn.call(p.context,c,u,f),!0;case 5:return p.fn.call(p.context,c,u,f,d),!0;case 6:return p.fn.call(p.context,c,u,f,d,g),!0}for(v=1,_=new Array(m-1);v<m;v++)_[v-1]=arguments[v];p.fn.apply(p.context,_)}else{var A=p.length,x;for(v=0;v<A;v++)switch(p[v].once&&this.removeListener(l,p[v].fn,void 0,!0),m){case 1:p[v].fn.call(p[v].context);break;case 2:p[v].fn.call(p[v].context,c);break;case 3:p[v].fn.call(p[v].context,c,u);break;case 4:p[v].fn.call(p[v].context,c,u,f);break;default:if(!_)for(x=1,_=new Array(m-1);x<m;x++)_[x-1]=arguments[x];p[v].fn.apply(p[v].context,_)}}return!0},o.prototype.on=function(l,c,u){return n(this,l,c,u,!1)},o.prototype.once=function(l,c,u){return n(this,l,c,u,!0)},o.prototype.removeListener=function(l,c,u,f){var d=e?e+l:l;if(!this._events[d])return this;if(!c)return a(this,d),this;var g=this._events[d];if(g.fn)g.fn===c&&(!f||g.once)&&(!u||g.context===u)&&a(this,d);else{for(var y=0,p=[],m=g.length;y<m;y++)(g[y].fn!==c||f&&!g[y].once||u&&g[y].context!==u)&&p.push(g[y]);p.length?this._events[d]=p.length===1?p[0]:p:a(this,d)}return this},o.prototype.removeAllListeners=function(l){var c;return l?(c=e?e+l:l,this._events[c]&&a(this,c)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=e,o.EventEmitter=o,r.exports=o}(pn)),pn.exports}var py=fy();const me=Hs(py),my=Math.PI*2,gy=180/Math.PI,yy=Math.PI/180;let jt=class sd{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new sd(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return mn.x=0,mn.y=0,mn}};const mn=new jt;let mt=class nd{constructor(t=1,e=0,i=0,s=1,n=0,a=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=s,this.tx=n,this.ty=a}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,s,n,a){return this.a=t,this.b=e,this.c=i,this.d=s,this.tx=n,this.ty=a,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new jt;const i=t.x,s=t.y;return e.x=this.a*i+this.c*s+this.tx,e.y=this.b*i+this.d*s+this.ty,e}applyInverse(t,e){e=e||new jt;const i=this.a,s=this.b,n=this.c,a=this.d,o=this.tx,h=this.ty,l=1/(i*a+n*-s),c=t.x,u=t.y;return e.x=a*l*c+-n*l*u+(h*n-o*a)*l,e.y=i*l*u+-s*l*c+(-h*i+o*s)*l,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),s=this.a,n=this.c,a=this.tx;return this.a=s*e-this.b*i,this.b=s*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=a*e-this.ty*i,this.ty=a*i+this.ty*e,this}append(t){const e=this.a,i=this.b,s=this.c,n=this.d;return this.a=t.a*e+t.b*s,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*s,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*s+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this}appendFrom(t,e){const i=t.a,s=t.b,n=t.c,a=t.d,o=t.tx,h=t.ty,l=e.a,c=e.b,u=e.c,f=e.d;return this.a=i*l+s*u,this.b=i*c+s*f,this.c=n*l+a*u,this.d=n*c+a*f,this.tx=o*l+h*u+e.tx,this.ty=o*c+h*f+e.ty,this}setTransform(t,e,i,s,n,a,o,h,l){return this.a=Math.cos(o+l)*n,this.b=Math.sin(o+l)*n,this.c=-Math.sin(o-h)*a,this.d=Math.cos(o-h)*a,this.tx=t-(i*this.a+s*this.c),this.ty=e-(i*this.b+s*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const i=this.a,s=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=s*t.a+this.d*t.c,this.d=s*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,i=this.b,s=this.c,n=this.d,a=t.pivot,o=-Math.atan2(-s,n),h=Math.atan2(i,e),l=Math.abs(o+h);return l<1e-5||Math.abs(my-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=h),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(s*s+n*n),t.position.x=this.tx+(a.x*e+a.y*s),t.position.y=this.ty+(a.x*i+a.y*n),t}invert(){const t=this.a,e=this.b,i=this.c,s=this.d,n=this.tx,a=t*s-e*i;return this.a=s/a,this.b=-e/a,this.c=-i/a,this.d=t/a,this.tx=(i*this.ty-s*n)/a,this.ty=-(t*this.ty-e*n)/a,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new nd;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return xy.identity()}static get shared(){return _y.identity()}};const _y=new mt,xy=new mt,qe=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ke=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ze=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Qe=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],qa=[],ad=[],Oi=Math.sign;function vy(){for(let r=0;r<16;r++){const t=[];qa.push(t);for(let e=0;e<16;e++){const i=Oi(qe[r]*qe[e]+Ze[r]*Ke[e]),s=Oi(Ke[r]*qe[e]+Qe[r]*Ke[e]),n=Oi(qe[r]*Ze[e]+Ze[r]*Qe[e]),a=Oi(Ke[r]*Ze[e]+Qe[r]*Qe[e]);for(let o=0;o<16;o++)if(qe[o]===i&&Ke[o]===s&&Ze[o]===n&&Qe[o]===a){t.push(o);break}}}for(let r=0;r<16;r++){const t=new mt;t.set(qe[r],Ke[r],Ze[r],Qe[r],0,0),ad.push(t)}}vy();const It={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:r=>qe[r],uY:r=>Ke[r],vX:r=>Ze[r],vY:r=>Qe[r],inv:r=>r&8?r&15:-r&7,add:(r,t)=>qa[r][t],sub:(r,t)=>qa[r][It.inv(t)],rotate180:r=>r^4,isVertical:r=>(r&3)===2,byDirection:(r,t)=>Math.abs(r)*2<=Math.abs(t)?t>=0?It.S:It.N:Math.abs(t)*2<=Math.abs(r)?r>0?It.E:It.W:t>0?r>0?It.SE:It.SW:r>0?It.NE:It.NW,matrixAppendRotationInv:(r,t,e=0,i=0)=>{const s=ad[It.inv(t)];s.tx=e,s.ty=i,r.append(s)}},Ui=[new jt,new jt,new jt,new jt];let Yt=class us{constructor(t=0,e=0,i=0,s=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(s)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new us(0,0,0,0)}clone(){return new us(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}strokeContains(t,e,i){const{width:s,height:n}=this;if(s<=0||n<=0)return!1;const a=this.x,o=this.y,h=a-i/2,l=a+s+i/2,c=o-i/2,u=o+n+i/2,f=a+i/2,d=a+s-i/2,g=o+i/2,y=o+n-i/2;return t>=h&&t<=l&&e>=c&&e<=u&&!(t>f&&t<d&&e>g&&e<y)}intersects(t,e){if(!e){const B=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=B)return!1;const L=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>L}const i=this.left,s=this.right,n=this.top,a=this.bottom;if(s<=i||a<=n)return!1;const o=Ui[0].set(t.left,t.top),h=Ui[1].set(t.left,t.bottom),l=Ui[2].set(t.right,t.top),c=Ui[3].set(t.right,t.bottom);if(l.x<=o.x||h.y<=o.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(o,o),e.apply(h,h),e.apply(l,l),e.apply(c,c),Math.max(o.x,h.x,l.x,c.x)<=i||Math.min(o.x,h.x,l.x,c.x)>=s||Math.max(o.y,h.y,l.y,c.y)<=n||Math.min(o.y,h.y,l.y,c.y)>=a))return!1;const f=u*(h.y-o.y),d=u*(o.x-h.x),g=f*i+d*n,y=f*s+d*n,p=f*i+d*a,m=f*s+d*a;if(Math.max(g,y,p,m)<=f*o.x+d*o.y||Math.min(g,y,p,m)>=f*c.x+d*c.y)return!1;const _=u*(o.y-l.y),v=u*(l.x-o.x),A=_*i+v*n,x=_*s+v*n,S=_*i+v*a,b=_*s+v*a;return!(Math.max(A,x,S,b)<=_*o.x+v*o.y||Math.min(A,x,S,b)>=_*c.x+v*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),s=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=s,this.height=Math.max(n-s,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,s=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=s-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),s=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=s,this.height=n-s,this}getBounds(t){return t||(t=new us),t.copyFrom(this),t}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};const gn={default:-1};function Gt(r="default"){return gn[r]===void 0&&(gn[r]=-1),++gn[r]}const ml={},Rt="8.0.0",by="8.3.4";function wt(r,t,e=3){if(ml[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${r}`):(i=i.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${r}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${r}`),console.warn(i))),ml[t]=!0}const od=()=>{};function Es(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1}function gl(r){return!(r&r-1)&&!!r}function Ka(r){const t={};for(const e in r)r[e]!==void 0&&(t[e]=r[e]);return t}const yl=Object.create(null);function wy(r){const t=yl[r];return t===void 0&&(yl[r]=Gt("resource")),t}const hd=class ld extends me{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...ld.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){wt(Rt,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=wy(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};hd.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let Ay=hd;const cd=class ud extends me{constructor(t={}){super(),this.options=t,this.uid=Gt("textureSource"),this._resourceType="textureSource",this._resourceId=Gt("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...ud.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new Ay(Ka(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){var e,i;this.style!==t&&((e=this._style)==null||e.off("change",this._onStyleChange,this),this._style=t,(i=this._style)==null||i.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=Gt("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,i){i||(i=this._resolution),t||(t=this.width),e||(e=this.height);const s=Math.round(t*i),n=Math.round(e*i);return this.width=s/i,this.height=n/i,this._resolution=i,this.pixelWidth===s&&this.pixelHeight===n?!1:(this._refreshPOT(),this.pixelWidth=s,this.pixelHeight=n,this.emit("resize",this),this._resourceId=Gt("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=gl(this.pixelWidth)&&gl(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};cd.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let Te=cd;class Vo extends Te{constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let i=t.format;i||(e instanceof Float32Array?i="rgba32float":e instanceof Int32Array||e instanceof Uint32Array?i="rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?i="rgba16uint":(e instanceof Int8Array,i="bgra8unorm")),super({...t,resource:e,format:i}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}Vo.extension=Z.TextureSource;const _l=new mt;let Ty=class{constructor(t,e){this.mapCoord=new mt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof e>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){var e;this.texture!==t&&((e=this._texture)==null||e.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const i=this.mapCoord;for(let s=0;s<t.length;s+=2){const n=t[s],a=t[s+1];e[s]=n*i.a+a*i.c+i.tx,e[s+1]=n*i.b+a*i.d+i.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const i=t.orig,s=t.trim;s&&(_l.set(i.width/s.width,0,0,i.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(_l));const n=t.source,a=this.uClampFrame,o=this.clampMargin/n._resolution,h=this.clampOffset/n._resolution;return a[0]=(t.frame.x+o+h)/n.width,a[1]=(t.frame.y+o+h)/n.height,a[2]=(t.frame.x+t.frame.width-o+h)/n.width,a[3]=(t.frame.y+t.frame.height-o+h)/n.height,this.uClampOffset[0]=this.clampOffset/n.pixelWidth,this.uClampOffset[1]=this.clampOffset/n.pixelHeight,this.isSimple=t.frame.width===n.width&&t.frame.height===n.height&&t.rotate===0,!0}},ht=class extends me{constructor({source:t,label:e,frame:i,orig:s,trim:n,defaultAnchor:a,defaultBorders:o,rotate:h,dynamic:l}={}){if(super(),this.uid=Gt("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Yt,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=e,this.source=(t==null?void 0:t.source)??new Te,this.noFrame=!i,i)this.frame.copyFrom(i);else{const{width:c,height:u}=this._source;this.frame.width=c,this.frame.height=u}this.orig=s||this.frame,this.trim=n,this.rotate=h??0,this.defaultAnchor=a,this.defaultBorders=o,this.destroyed=!1,this.dynamic=l||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new Ty(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:i,height:s}=this._source,n=e.x/i,a=e.y/s,o=e.width/i,h=e.height/s;let l=this.rotate;if(l){const c=o/2,u=h/2,f=n+c,d=a+u;l=It.add(l,It.NW),t.x0=f+c*It.uX(l),t.y0=d+u*It.uY(l),l=It.add(l,2),t.x1=f+c*It.uX(l),t.y1=d+u*It.uY(l),l=It.add(l,2),t.x2=f+c*It.uX(l),t.y2=d+u*It.uY(l),l=It.add(l,2),t.x3=f+c*It.uX(l),t.y3=d+u*It.uY(l)}else t.x0=n,t.y0=a,t.x1=n+o,t.y1=a,t.x2=n+o,t.y2=a+h,t.x3=n,t.y3=a+h}destroy(t=!1){this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return wt(Rt,"Texture.baseTexture is now Texture.source"),this._source}};ht.EMPTY=new ht({label:"EMPTY",source:new Te({label:"EMPTY"})});ht.EMPTY.destroy=od;ht.WHITE=new ht({source:new Vo({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});ht.WHITE.destroy=od;function Sy(r,t,e,i){const{width:s,height:n}=e.orig,a=e.trim;if(a){const o=a.width,h=a.height;r.minX=a.x-t._x*s-i,r.maxX=r.minX+o,r.minY=a.y-t._y*n-i,r.maxY=r.minY+h}else r.minX=-t._x*s-i,r.maxX=r.minX+s,r.minY=-t._y*n-i,r.maxY=r.minY+n}const xl=new mt;let He=class dd{constructor(t=1/0,e=1/0,i=-1/0,s=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=xl,this.minX=t,this.minY=e,this.maxX=i,this.maxY=s}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new Yt);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=xl,this}set(t,e,i,s){this.minX=t,this.minY=e,this.maxX=i,this.maxY=s}addFrame(t,e,i,s,n){n||(n=this.matrix);const a=n.a,o=n.b,h=n.c,l=n.d,c=n.tx,u=n.ty;let f=this.minX,d=this.minY,g=this.maxX,y=this.maxY,p=a*t+h*e+c,m=o*t+l*e+u;p<f&&(f=p),m<d&&(d=m),p>g&&(g=p),m>y&&(y=m),p=a*i+h*e+c,m=o*i+l*e+u,p<f&&(f=p),m<d&&(d=m),p>g&&(g=p),m>y&&(y=m),p=a*t+h*s+c,m=o*t+l*s+u,p<f&&(f=p),m<d&&(d=m),p>g&&(g=p),m>y&&(y=m),p=a*i+h*s+c,m=o*i+l*s+u,p<f&&(f=p),m<d&&(d=m),p>g&&(g=p),m>y&&(y=m),this.minX=f,this.minY=d,this.maxX=g,this.maxY=y}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,i=this.minY,s=this.maxX,n=this.maxY,{a,b:o,c:h,d:l,tx:c,ty:u}=t;let f=a*e+h*i+c,d=o*e+l*i+u;this.minX=f,this.minY=d,this.maxX=f,this.maxY=d,f=a*s+h*i+c,d=o*s+l*i+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY,f=a*e+h*n+c,d=o*e+l*n+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY,f=a*s+h*n+c,d=o*s+l*n+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,e,i,s){return this.minX<t&&(this.minX=t),this.maxX>e&&(this.maxX=e),this.minY<i&&(this.minY=i),this.maxY>s&&(this.maxY=s),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new dd(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,i,s){let n=this.minX,a=this.minY,o=this.maxX,h=this.maxY;s||(s=this.matrix);const l=s.a,c=s.b,u=s.c,f=s.d,d=s.tx,g=s.ty;for(let y=e;y<i;y+=2){const p=t[y],m=t[y+1],_=l*p+u*m+d,v=c*p+f*m+g;n=_<n?_:n,a=v<a?v:a,o=_>o?_:o,h=v>h?v:h}this.minX=n,this.minY=a,this.maxX=o,this.maxY=h}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}};var Cy={grad:.9,turn:360,rad:360/(2*Math.PI)},Se=function(r){return typeof r=="string"?r.length>0:typeof r=="number"},Vt=function(r,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*r)/e+0},ie=function(r,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),r>e?e:r>t?r:t},fd=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},vl=function(r){return{r:ie(r.r,0,255),g:ie(r.g,0,255),b:ie(r.b,0,255),a:ie(r.a)}},yn=function(r){return{r:Vt(r.r),g:Vt(r.g),b:Vt(r.b),a:Vt(r.a,3)}},Ey=/^#([0-9a-f]{3,8})$/i,Gi=function(r){var t=r.toString(16);return t.length<2?"0"+t:t},pd=function(r){var t=r.r,e=r.g,i=r.b,s=r.a,n=Math.max(t,e,i),a=n-Math.min(t,e,i),o=a?n===t?(e-i)/a:n===e?2+(i-t)/a:4+(t-e)/a:0;return{h:60*(o<0?o+6:o),s:n?a/n*100:0,v:n/255*100,a:s}},md=function(r){var t=r.h,e=r.s,i=r.v,s=r.a;t=t/360*6,e/=100,i/=100;var n=Math.floor(t),a=i*(1-e),o=i*(1-(t-n)*e),h=i*(1-(1-t+n)*e),l=n%6;return{r:255*[i,o,a,a,h,i][l],g:255*[h,i,i,o,a,a][l],b:255*[a,a,h,i,i,o][l],a:s}},bl=function(r){return{h:fd(r.h),s:ie(r.s,0,100),l:ie(r.l,0,100),a:ie(r.a)}},wl=function(r){return{h:Vt(r.h),s:Vt(r.s),l:Vt(r.l),a:Vt(r.a,3)}},Al=function(r){return md((e=(t=r).s,{h:t.h,s:(e*=((i=t.l)<50?i:100-i)/100)>0?2*e/(i+e)*100:0,v:i+e,a:t.a}));var t,e,i},fi=function(r){return{h:(t=pd(r)).h,s:(s=(200-(e=t.s))*(i=t.v)/100)>0&&s<200?e*i/100/(s<=100?s:200-s)*100:0,l:s/2,a:t.a};var t,e,i,s},Iy=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Py=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ry=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,My=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Za={string:[[function(r){var t=Ey.exec(r);return t?(r=t[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:r.length===4?Vt(parseInt(r[3]+r[3],16)/255,2):1}:r.length===6||r.length===8?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:r.length===8?Vt(parseInt(r.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(r){var t=Ry.exec(r)||My.exec(r);return t?t[2]!==t[4]||t[4]!==t[6]?null:vl({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(r){var t=Iy.exec(r)||Py.exec(r);if(!t)return null;var e,i,s=bl({h:(e=t[1],i=t[2],i===void 0&&(i="deg"),Number(e)*(Cy[i]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Al(s)},"hsl"]],object:[[function(r){var t=r.r,e=r.g,i=r.b,s=r.a,n=s===void 0?1:s;return Se(t)&&Se(e)&&Se(i)?vl({r:Number(t),g:Number(e),b:Number(i),a:Number(n)}):null},"rgb"],[function(r){var t=r.h,e=r.s,i=r.l,s=r.a,n=s===void 0?1:s;if(!Se(t)||!Se(e)||!Se(i))return null;var a=bl({h:Number(t),s:Number(e),l:Number(i),a:Number(n)});return Al(a)},"hsl"],[function(r){var t=r.h,e=r.s,i=r.v,s=r.a,n=s===void 0?1:s;if(!Se(t)||!Se(e)||!Se(i))return null;var a=function(o){return{h:fd(o.h),s:ie(o.s,0,100),v:ie(o.v,0,100),a:ie(o.a)}}({h:Number(t),s:Number(e),v:Number(i),a:Number(n)});return md(a)},"hsv"]]},Tl=function(r,t){for(var e=0;e<t.length;e++){var i=t[e][0](r);if(i)return[i,t[e][1]]}return[null,void 0]},Fy=function(r){return typeof r=="string"?Tl(r.trim(),Za.string):typeof r=="object"&&r!==null?Tl(r,Za.object):[null,void 0]},_n=function(r,t){var e=fi(r);return{h:e.h,s:ie(e.s+100*t,0,100),l:e.l,a:e.a}},xn=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},Sl=function(r,t){var e=fi(r);return{h:e.h,s:e.s,l:ie(e.l+100*t,0,100),a:e.a}},Qa=function(){function r(t){this.parsed=Fy(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return this.parsed!==null},r.prototype.brightness=function(){return Vt(xn(this.rgba),2)},r.prototype.isDark=function(){return xn(this.rgba)<.5},r.prototype.isLight=function(){return xn(this.rgba)>=.5},r.prototype.toHex=function(){return t=yn(this.rgba),e=t.r,i=t.g,s=t.b,a=(n=t.a)<1?Gi(Vt(255*n)):"","#"+Gi(e)+Gi(i)+Gi(s)+a;var t,e,i,s,n,a},r.prototype.toRgb=function(){return yn(this.rgba)},r.prototype.toRgbString=function(){return t=yn(this.rgba),e=t.r,i=t.g,s=t.b,(n=t.a)<1?"rgba("+e+", "+i+", "+s+", "+n+")":"rgb("+e+", "+i+", "+s+")";var t,e,i,s,n},r.prototype.toHsl=function(){return wl(fi(this.rgba))},r.prototype.toHslString=function(){return t=wl(fi(this.rgba)),e=t.h,i=t.s,s=t.l,(n=t.a)<1?"hsla("+e+", "+i+"%, "+s+"%, "+n+")":"hsl("+e+", "+i+"%, "+s+"%)";var t,e,i,s,n},r.prototype.toHsv=function(){return t=pd(this.rgba),{h:Vt(t.h),s:Vt(t.s),v:Vt(t.v),a:Vt(t.a,3)};var t},r.prototype.invert=function(){return he({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},r.prototype.saturate=function(t){return t===void 0&&(t=.1),he(_n(this.rgba,t))},r.prototype.desaturate=function(t){return t===void 0&&(t=.1),he(_n(this.rgba,-t))},r.prototype.grayscale=function(){return he(_n(this.rgba,-1))},r.prototype.lighten=function(t){return t===void 0&&(t=.1),he(Sl(this.rgba,t))},r.prototype.darken=function(t){return t===void 0&&(t=.1),he(Sl(this.rgba,-t))},r.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},r.prototype.alpha=function(t){return typeof t=="number"?he({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):Vt(this.rgba.a,3);var e},r.prototype.hue=function(t){var e=fi(this.rgba);return typeof t=="number"?he({h:t,s:e.s,l:e.l,a:e.a}):Vt(e.h)},r.prototype.isEqual=function(t){return this.toHex()===he(t).toHex()},r}(),he=function(r){return r instanceof Qa?r:new Qa(r)},Cl=[],gd=function(r){r.forEach(function(t){Cl.indexOf(t)<0&&(t(Qa,Za),Cl.push(t))})};function yd(r,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var s in e)i[e[s]]=s;var n={};r.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var o,h,l=i[this.toHex()];if(l)return l;if(a!=null&&a.closest){var c=this.toRgb(),u=1/0,f="black";if(!n.length)for(var d in e)n[d]=new r(e[d]).toRgb();for(var g in e){var y=(o=c,h=n[g],Math.pow(o.r-h.r,2)+Math.pow(o.g-h.g,2)+Math.pow(o.b-h.b,2));y<u&&(u=y,f=g)}return f}},t.string.push([function(a){var o=a.toLowerCase(),h=o==="transparent"?"#0000":e[o];return h?new r(h).toRgb():null},"name"])}gd([yd]);const Lr=class ii{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof ii)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,e){const i=typeof t;if(i!==typeof e)return!1;if(i==="number"||i==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((n,a)=>n===e[a]);if(t!==null&&e!==null){const n=Object.keys(t),a=Object.keys(e);return n.length!==a.length?!1:n.every(o=>t[o]===e[o])}return t===e}toRgba(){const[t,e,i,s]=this._components;return{r:t,g:e,b:i,a:s}}toRgb(){const[t,e,i]=this._components;return{r:t,g:e,b:i}}toRgbaString(){const[t,e,i]=this.toUint8RgbArray();return`rgba(${t},${e},${i},${this.alpha})`}toUint8RgbArray(t){const[e,i,s]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb),t[0]=Math.round(e*255),t[1]=Math.round(i*255),t[2]=Math.round(s*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t||(t=this._arrayRgba);const[e,i,s,n]=this._components;return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb);const[e,i,s]=this._components;return t[0]=e,t[1]=i,t[2]=s,t}toNumber(){return this._int}toBgrNumber(){const[t,e,i]=this.toUint8RgbArray();return(i<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,i,s,n]=ii._temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=i,this._components[2]*=s,this._components[3]*=n,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let i=this._int>>16&255,s=this._int>>8&255,n=this._int&255;return e&&(i=i*t+.5|0,s=s*t+.5|0,n=n*t+.5|0),(t*255<<24)+(i<<16)+(s<<8)+n}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let e,i,s,n;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const a=t;e=(a>>16&255)/255,i=(a>>8&255)/255,s=(a&255)/255,n=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,i,s,n=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,i,s,n=255]=t,e/=255,i/=255,s/=255,n/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const o=ii.HEX_PATTERN.exec(t);o&&(t=`#${o[2]}`)}const a=he(t);a.isValid()&&({r:e,g:i,b:s,a:n}=a.rgba,e/=255,i/=255,s/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=i,this._components[2]=s,this._components[3]=n,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,e,i]=this._components;this._int=(t*255<<16)+(e*255<<8)+(i*255|0)}_clamp(t,e=0,i=1){return typeof t=="number"?Math.min(Math.max(t,e),i):(t.forEach((s,n)=>{t[n]=Math.min(Math.max(s,e),i)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof ii||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};Lr.shared=new Lr;Lr._temp=new Lr;Lr.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Nt=Lr;const ky={cullArea:null,cullable:!1,cullableChildren:!0};class zo{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){var i;let e;return this._index>0?e=this._pool[--this._index]:e=new this._classType,(i=e.init)==null||i.call(e,t),e}return(t){var e;(e=t.reset)==null||e.call(t),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class By{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new zo(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const i=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[i]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}}const Pe=new By,Ly={get isCachedAsTexture(){var r;return!!((r=this.renderGroup)!=null&&r.isCachedAsTexture)},cacheAsTexture(r){typeof r=="boolean"&&r===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(r===!0?{}:r))},updateCacheTexture(){var r;(r=this.renderGroup)==null||r.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(r){wt("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(r)}};function Ny(r,t,e){const i=r.length;let s;if(t>=i||e===0)return;e=t+e>i?i-t:e;const n=i-e;for(s=t;s<n;++s)r[s]=r[s+e];r.length=n}const Oy={allowChildren:!0,removeChildren(r=0,t){const e=t??this.children.length,i=e-r,s=[];if(i>0&&i<=e){for(let a=e-1;a>=r;a--){const o=this.children[a];o&&(s.push(o),o.parent=null)}Ny(this.children,r,e);const n=this.renderGroup||this.parentRenderGroup;n&&n.removeChildren(s);for(let a=0;a<s.length;++a)this.emit("childRemoved",s[a],this,a),s[a].emit("removed",this);return s}else if(i===0&&this.children.length===0)return s;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(r){const t=this.getChildAt(r);return this.removeChild(t)},getChildAt(r){if(r<0||r>=this.children.length)throw new Error(`getChildAt: Index (${r}) does not exist.`);return this.children[r]},setChildIndex(r,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(r),this.addChildAt(r,t)},getChildIndex(r){const t=this.children.indexOf(r);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(r,t){this.allowChildren||wt(Rt,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:e}=this;if(t<0||t>e.length)throw new Error(`${r}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(r.parent){const s=r.parent.children.indexOf(r);if(r.parent===this&&s===t)return r;s!==-1&&r.parent.children.splice(s,1)}t===e.length?e.push(r):e.splice(t,0,r),r.parent=this,r.didChange=!0,r._updateFlags=15;const i=this.renderGroup||this.parentRenderGroup;return i&&i.addChild(r),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",r,this,t),r.emit("added",this),r},swapChildren(r,t){if(r===t)return;const e=this.getChildIndex(r),i=this.getChildIndex(t);this.children[e]=t,this.children[i]=r;const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var r;(r=this.parent)==null||r.removeChild(this)},reparentChild(...r){return r.length===1?this.reparentChildAt(r[0],this.children.length):(r.forEach(t=>this.reparentChildAt(t,this.children.length)),r[0])},reparentChildAt(r,t){if(r.parent===this)return this.setChildIndex(r,t),r;const e=r.worldTransform.clone();r.removeFromParent(),this.addChildAt(r,t);const i=this.worldTransform.clone();return i.invert(),e.prepend(i),r.setFromMatrix(e),r}};class El{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}class Uy{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const i=this._tests[e];if(i.test(t))return Pe.get(i.maskClass,t)}return t}returnMaskEffect(t){Pe.return(t)}}const Ja=new Uy;Kt.handleByList(Z.MaskEffect,Ja._effectClasses);const Gy={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const r=this.renderGroup||this.parentRenderGroup;r&&(r.structureDidChange=!0)},addEffect(r){this.effects.indexOf(r)===-1&&(this.effects.push(r),this.effects.sort((e,i)=>e.priority-i.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(r){const t=this.effects.indexOf(r);t!==-1&&(this.effects.splice(t,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(r){const t=this._maskEffect;(t==null?void 0:t.mask)!==r&&(t&&(this.removeEffect(t),Ja.returnMaskEffect(t),this._maskEffect=null),r!=null&&(this._maskEffect=Ja.getMaskEffect(r),this.addEffect(this._maskEffect)))},setMask(r){this._maskOptions={...this._maskOptions,...r},r.mask&&(this.mask=r.mask),this._markStructureAsChanged()},get mask(){var r;return(r=this._maskEffect)==null?void 0:r.mask},set filters(r){var n;!Array.isArray(r)&&r&&(r=[r]);const t=this._filterEffect||(this._filterEffect=new El);r=r;const e=(r==null?void 0:r.length)>0,i=((n=t.filters)==null?void 0:n.length)>0,s=e!==i;r=Array.isArray(r)?r.slice(0):r,t.filters=Object.freeze(r),s&&(e?this.addEffect(t):(this.removeEffect(t),t.filters=r??null))},get filters(){var r;return(r=this._filterEffect)==null?void 0:r.filters},set filterArea(r){this._filterEffect||(this._filterEffect=new El),this._filterEffect.filterArea=r},get filterArea(){var r;return(r=this._filterEffect)==null?void 0:r.filterArea}},Dy={label:null,get name(){return wt(Rt,"Container.name property has been removed, use Container.label instead"),this.label},set name(r){wt(Rt,"Container.name property has been removed, use Container.label instead"),this.label=r},getChildByName(r,t=!1){return this.getChildByLabel(r,t)},getChildByLabel(r,t=!1){const e=this.children;for(let i=0;i<e.length;i++){const s=e[i];if(s.label===r||r instanceof RegExp&&r.test(s.label))return s}if(t)for(let i=0;i<e.length;i++){const n=e[i].getChildByLabel(r,!0);if(n)return n}return null},getChildrenByLabel(r,t=!1,e=[]){const i=this.children;for(let s=0;s<i.length;s++){const n=i[s];(n.label===r||r instanceof RegExp&&r.test(n.label))&&e.push(n)}if(t)for(let s=0;s<i.length;s++)i[s].getChildrenByLabel(r,!0,e);return e}},qt=new zo(mt),Nr=new zo(He);function _d(r,t,e){e.clear();let i,s;return r.parent?t?i=r.parent.worldTransform:(s=qt.get().identity(),i=Xo(r,s)):i=mt.IDENTITY,xd(r,e,i,t),s&&qt.return(s),e.isValid||e.set(0,0,0,0),e}function xd(r,t,e,i){var o,h;if(!r.visible||!r.measurable)return;let s;i?s=r.worldTransform:(r.updateLocalTransform(),s=qt.get(),s.appendFrom(r.localTransform,e));const n=t,a=!!r.effects.length;if(a&&(t=Nr.get().clear()),r.boundsArea)t.addRect(r.boundsArea,s);else{r.bounds&&(t.matrix=s,t.addBounds(r.bounds));for(let l=0;l<r.children.length;l++)xd(r.children[l],t,s,i)}if(a){for(let l=0;l<r.effects.length;l++)(h=(o=r.effects[l]).addBounds)==null||h.call(o,t);n.addBounds(t,mt.IDENTITY),Nr.return(t)}i||qt.return(s)}function Xo(r,t){const e=r.parent;return e&&(Xo(e,t),e.updateLocalTransform(),t.append(e.localTransform)),t}function vd(r,t){if(r===16777215||!t)return t;if(t===16777215||!r)return r;const e=r>>16&255,i=r>>8&255,s=r&255,n=t>>16&255,a=t>>8&255,o=t&255,h=e*n/255|0,l=i*a/255|0,c=s*o/255|0;return(h<<16)+(l<<8)+c}const Il=16777215;function Pl(r,t){return r===Il?t:t===Il?r:vd(r,t)}function ds(r){return((r&255)<<16)+(r&65280)+(r>>16&255)}const $y={getGlobalAlpha(r){if(r)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let t=this.alpha,e=this.parent;for(;e;)t*=e.alpha,e=e.parent;return t},getGlobalTransform(r,t){if(t)return r.copyFrom(this.worldTransform);this.updateLocalTransform();const e=Xo(this,qt.get().identity());return r.appendFrom(this.localTransform,e),qt.return(e),r},getGlobalTint(r){if(r)return this.renderGroup?ds(this.renderGroup.worldColor):this.parentRenderGroup?ds(Pl(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let t=this.localColor,e=this.parent;for(;e;)t=Pl(t,e.localColor),e=e.parent;return ds(t)}};let vn=0;const Rl=500;function Ot(...r){vn!==Rl&&(vn++,vn===Rl?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...r))}function bd(r,t,e){return t.clear(),e||(e=mt.IDENTITY),wd(r,t,e,r,!0),t.isValid||t.set(0,0,0,0),t}function wd(r,t,e,i,s){var h,l;let n;if(s)n=qt.get(),n=e.copyTo(n);else{if(!r.visible||!r.measurable)return;r.updateLocalTransform();const c=r.localTransform;n=qt.get(),n.appendFrom(c,e)}const a=t,o=!!r.effects.length;if(o&&(t=Nr.get().clear()),r.boundsArea)t.addRect(r.boundsArea,n);else{r.renderPipeId&&(t.matrix=n,t.addBounds(r.bounds));const c=r.children;for(let u=0;u<c.length;u++)wd(c[u],t,n,i,!1)}if(o){for(let c=0;c<r.effects.length;c++)(l=(h=r.effects[c]).addLocalBounds)==null||l.call(h,t,i);a.addBounds(t,mt.IDENTITY),Nr.return(t)}qt.return(n)}function Ad(r,t){const e=r.children;for(let i=0;i<e.length;i++){const s=e[i],n=s.uid,a=(s._didViewChangeTick&65535)<<16|s._didContainerChangeTick&65535,o=t.index;(t.data[o]!==n||t.data[o+1]!==a)&&(t.data[t.index]=n,t.data[t.index+1]=a,t.didChange=!0),t.index=o+2,s.children.length&&Ad(s,t)}return t.didChange}const Hy=new mt,Vy={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(r,t){const e=Math.sign(this.scale.x)||1;t!==0?this.scale.x=r/t*e:this.scale.x=e},_setHeight(r,t){const e=Math.sign(this.scale.y)||1;t!==0?this.scale.y=r/t*e:this.scale.y=e},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new He});const r=this._localBoundsCacheData;return r.index=1,r.didChange=!1,r.data[0]!==this._didViewChangeTick&&(r.didChange=!0,r.data[0]=this._didViewChangeTick),Ad(this,r),r.didChange&&bd(this,r.localBounds,Hy),r.localBounds},getBounds(r,t){return _d(this,r,t||new He)}},zy={_onRender:null,set onRender(r){const t=this.renderGroup||this.parentRenderGroup;if(!r){this._onRender&&(t==null||t.removeOnRender(this)),this._onRender=null;return}this._onRender||t==null||t.addOnRender(this),this._onRender=r},get onRender(){return this._onRender}},Xy={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(r){this._zIndex!==r&&(this._zIndex=r,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(Wy))}};function Wy(r,t){return r._zIndex-t._zIndex}const jy={getGlobalPosition(r=new jt,t=!1){return this.parent?this.parent.toGlobal(this._position,r,t):(r.x=this._position.x,r.y=this._position.y),r},toGlobal(r,t,e=!1){const i=this.getGlobalTransform(qt.get(),e);return t=i.apply(r,t),qt.return(i),t},toLocal(r,t,e,i){t&&(r=t.toGlobal(r,e,i));const s=this.getGlobalTransform(qt.get(),i);return e=s.applyInverse(r,e),qt.return(s),e}};let Yy=0;class Td{constructor(){this.uid=Gt("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.tick=0}reset(){this.instructionSize=0,this.tick=Yy++}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let qy=0;class Ky{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1}createTexture(t,e,i){const s=new Te({...this.textureOptions,width:t,height:e,resolution:1,antialias:i,autoGarbageCollect:!0});return new ht({source:s,label:`texturePool_${qy++}`})}getOptimalTexture(t,e,i=1,s){let n=Math.ceil(t*i-1e-6),a=Math.ceil(e*i-1e-6);n=Es(n),a=Es(a);const o=(n<<17)+(a<<1)+(s?1:0);this._texturePool[o]||(this._texturePool[o]=[]);let h=this._texturePool[o].pop();return h||(h=this.createTexture(n,a,s)),h.source._resolution=i,h.source.width=n/i,h.source.height=a/i,h.source.pixelWidth=n,h.source.pixelHeight=a,h.frame.x=0,h.frame.y=0,h.frame.width=t,h.frame.height=e,h.updateUvs(),this._poolKeyHash[h.uid]=o,h}getSameSizeTexture(t,e=!1){const i=t.source;return this.getOptimalTexture(t.width,t.height,i._resolution,e)}returnTexture(t){const e=this._poolKeyHash[t.uid];this._texturePool[e].push(t)}clear(t){if(t=t!==!1,t)for(const e in this._texturePool){const i=this._texturePool[e];if(i)for(let s=0;s<i.length;s++)i[s].destroy(!0)}this._texturePool={}}}const Zy=new Ky;class Qy{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new mt,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new Td,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const e=t.children;for(let i=0;i<e.length;i++)this.addChild(e[i])}enableCacheAsTexture(t={}){this.textureOptions=t,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(Zy.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const e=this.childrenToUpdate[t];e.list.fill(null),e.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const e=this.renderGroupChildren.indexOf(t);e>-1&&this.renderGroupChildren.splice(e,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup){this.addRenderGroupChild(t.renderGroup);return}t._onRender&&this.addOnRender(t);const e=t.children;for(let i=0;i<e.length;i++)this.addChild(e[i])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup){this._removeRenderGroupChild(t.renderGroup);return}const e=t.children;for(let i=0;i<e.length;i++)this.removeChild(e[i])}removeChildren(t){for(let e=0;e<t.length;e++)this.removeChild(t[e])}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeRenderGroupDepth];e||(e=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(){for(let t=0;t<this._onRenderContainers.length;t++)this._onRenderContainers[t]._onRender()}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const e=this.root.children;for(let i=0;i<e.length;i++)this._getChildren(e[i],t);return t}_getChildren(t,e=[]){if(e.push(t),t.renderGroup)return e;const i=t.children;for(let s=0;s<i.length;s++)this._getChildren(i[s],e);return e}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return this._matrixDirty&1?(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new mt),this._inverseWorldTransform.copyFrom(this.worldTransform).invert()):this._inverseWorldTransform}get textureOffsetInverseTransform(){return this._matrixDirty&2?(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new mt),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y)):this._textureOffsetInverseTransform}get inverseParentTextureTransform(){if(!(this._matrixDirty&4))return this._inverseParentTextureTransform;this._matrixDirty&=-5;const t=this._parentCacheAsTextureRenderGroup;return t?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new mt),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(t.inverseWorldTransform).translate(-t._textureBounds.x,-t._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function Jy(r,t,e={}){for(const i in t)!e[i]&&t[i]!==void 0&&(r[i]=t[i])}const bn=new le(null),wn=new le(null),An=new le(null,1,1),Ml=1,t_=2,Tn=4;let Qt=class Sd extends me{constructor(t={}){var e,i;super(),this.uid=Gt("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new mt,this.relativeGroupTransform=new mt,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new le(this,0,0),this._scale=An,this._pivot=wn,this._skew=bn,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],Jy(this,t,{children:!0,parent:!0,effects:!0}),(e=t.children)==null||e.forEach(s=>this.addChild(s)),(i=t.parent)==null||i.addChild(this)}static mixin(t){Object.defineProperties(Sd.prototype,Object.getOwnPropertyDescriptors(t))}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=t&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...t){if(this.allowChildren||wt(Rt,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let s=0;s<t.length;s++)this.addChild(t[s]);return t[0]}const e=t[0],i=this.renderGroup||this.parentRenderGroup;return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),i&&(i.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),this.sortableChildren&&(this.sortDirty=!0),e.parent=this,e.didChange=!0,e._updateFlags=15,i&&i.addChild(e),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this),this._didViewChangeTick++,e._zIndex!==0&&e.depthOfChildModified(),e)}removeChild(...t){if(t.length>1){for(let s=0;s<t.length;s++)this.removeChild(t[s]);return t[0]}const e=t[0],i=this.children.indexOf(e);return i>-1&&(this._didViewChangeTick++,this.children.splice(i,1),this.renderGroup?this.renderGroup.removeChild(e):this.parentRenderGroup&&this.parentRenderGroup.removeChild(e),e.parent=null,this.emit("childRemoved",e,this,i),e.emit("removed",this)),e}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),this.renderGroup=Pe.get(Qy,this),this.groupTransform=mt.IDENTITY,t==null||t.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),Pe.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t==null||t.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new mt),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*gy}set angle(t){this.rotation=t*yy}get pivot(){return this._pivot===wn&&(this._pivot=new le(this,0,0)),this._pivot}set pivot(t){this._pivot===wn&&(this._pivot=new le(this,0,0)),typeof t=="number"?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===bn&&(this._skew=new le(this,0,0)),this._skew}set skew(t){this._skew===bn&&(this._skew=new le(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===An&&(this._scale=new le(this,1,1)),this._scale}set scale(t){this._scale===An&&(this._scale=new le(this,0,0)),typeof t=="number"?this._scale.set(t):this._scale.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const e=this.getLocalBounds().width;this._setWidth(t,e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const e=this.getLocalBounds().height;this._setHeight(t,e)}getSize(t){t||(t={});const e=this.getLocalBounds();return t.width=Math.abs(this.scale.x*e.width),t.height=Math.abs(this.scale.y*e.height),t}setSize(t,e){const i=this.getLocalBounds();typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,i.width),e!==void 0&&this._setHeight(e,i.height)}_updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}updateTransform(t){return this.position.set(typeof t.x=="number"?t.x:this.position.x,typeof t.y=="number"?t.y:this.position.y),this.scale.set(typeof t.scaleX=="number"?t.scaleX||1:this.scale.x,typeof t.scaleY=="number"?t.scaleY||1:this.scale.y),this.rotation=typeof t.rotation=="number"?t.rotation:this.rotation,this.skew.set(typeof t.skewX=="number"?t.skewX:this.skew.x,typeof t.skewY=="number"?t.skewY:this.skew.y),this.pivot.set(typeof t.pivotX=="number"?t.pivotX:this.pivot.x,typeof t.pivotY=="number"?t.pivotY:this.pivot.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const e=this.localTransform,i=this._scale,s=this._pivot,n=this._position,a=i._x,o=i._y,h=s._x,l=s._y;e.a=this._cx*a,e.b=this._sx*a,e.c=this._cy*o,e.d=this._sy*o,e.tx=n._x-(h*e.a+l*e.c),e.ty=n._y-(h*e.b+l*e.d)}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=Ml,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const i=Nt.shared.setValue(t??16777215).toBgrNumber();i!==this.localColor&&(this.localColor=i,this._updateFlags|=Ml,this._onUpdate())}get tint(){return ds(this.localColor)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=t_,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(t){const e=t?2:0;(this.localDisplayStatus&2)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Tn,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(t){const e=t?0:4;(this.localDisplayStatus&4)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Tn,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(t){const e=t?1:0;(this.localDisplayStatus&1)!==e&&(this._updateFlags|=Tn,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(t=!1){var s;if(this.destroyed)return;this.destroyed=!0;let e;if(this.children.length&&(e=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof t=="boolean"?t:t==null?void 0:t.children)&&e)for(let n=0;n<e.length;++n)e[n].destroy(t);(s=this.renderGroup)==null||s.destroy(),this.renderGroup=null}};Qt.mixin(Oy);Qt.mixin(jy);Qt.mixin(zy);Qt.mixin(Vy);Qt.mixin(Gy);Qt.mixin(Dy);Qt.mixin(Xy);Qt.mixin(ky);Qt.mixin(Ly);Qt.mixin($y);class Cd extends Qt{constructor(){super(...arguments),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=0,this._lastInstructionTick=-1,this._bounds=new He(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const e=this.bounds,{x:i,y:s}=t;return i>=e.minX&&i<=e.maxX&&s>=e.minY&&s<=e.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){super.destroy(t),this._bounds=null}}let Fl=class to extends Cd{constructor(t=ht.EMPTY){t instanceof ht&&(t={texture:t});const{texture:e=ht.EMPTY,anchor:i,roundPixels:s,width:n,height:a,...o}=t;super({label:"Sprite",...o}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new le({_onUpdate:()=>{this.onViewUpdate()}}),i?this.anchor=i:e.defaultAnchor&&(this.anchor=e.defaultAnchor),this.texture=e,this.allowChildren=!1,this.roundPixels=s??!1,n!==void 0&&(this.width=n),a!==void 0&&(this.height=a)}static from(t,e=!1){return t instanceof ht?new to(t):new to(ht.from(t,e))}set texture(t){t||(t=ht.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return Sy(this._visualBounds,this._anchor,this._texture,0),this._visualBounds}get sourceBounds(){return wt("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const t=this._anchor,e=this._texture,i=this._bounds,{width:s,height:n}=e.orig;i.minX=-t._x*s,i.maxX=i.minX+s,i.minY=-t._y*n,i.maxY=i.minY+n}destroy(t=!1){if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(i)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this._texture.orig.width),e!==void 0&&this._setHeight(e,this._texture.orig.height)}};const e_=new He;function Ed(r,t,e){const i=e_;r.measurable=!0,_d(r,e,i),t.addBoundsMask(i),r.measurable=!1}function Id(r,t,e){const i=Nr.get();r.measurable=!0;const s=qt.get().identity(),n=Pd(r,e,s);bd(r,i,n),r.measurable=!1,t.addBoundsMask(i),qt.return(s),Nr.return(i)}function Pd(r,t,e){return r?(r!==t&&(Pd(r.parent,t,e),r.updateLocalTransform(),e.append(r.localTransform)),e):(Ot("Mask bounds, renderable is not inside the root container"),e)}class Rd{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof Fl),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(t,e){this.inverse||Ed(this.mask,t,e)}addLocalBounds(t,e){Id(this.mask,t,e)}containsPoint(t,e){const i=this.mask;return e(i,t)}destroy(){this.reset()}static test(t){return t instanceof Fl}}Rd.extension=Z.MaskEffect;class Md{constructor(t){this.priority=0,this.pipe="colorMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}Md.extension=Z.MaskEffect;class Fd{constructor(t){this.priority=0,this.pipe="stencilMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(t,e){Ed(this.mask,t,e)}addLocalBounds(t,e){Id(this.mask,t,e)}containsPoint(t,e){const i=this.mask;return e(i,t)}destroy(){this.reset()}static test(t){return t instanceof Qt}}Fd.extension=Z.MaskEffect;const r_={createCanvas:(r,t)=>{const e=document.createElement("canvas");return e.width=r,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(r,t)=>fetch(r,t),parseXML:r=>new DOMParser().parseFromString(r,"text/xml")};let kl=r_;const Ft={get(){return kl},set(r){kl=r}};class kd extends Te{constructor(t){t.resource||(t.resource=Ft.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,i=this._resolution){const s=super.resize(t,e,i);return s&&this.resizeCanvas(),s}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}kd.extension=Z.TextureSource;class Dr extends Te{constructor(t){if(t.resource&&globalThis.HTMLImageElement&&t.resource instanceof HTMLImageElement){const e=Ft.get().createCanvas(t.resource.width,t.resource.height);e.getContext("2d").drawImage(t.resource,0,0,t.resource.width,t.resource.height),t.resource=e,Ot("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}Dr.extension=Z.TextureSource;var eo=(r=>(r[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY",r))(eo||{});let Sn=class{constructor(t,e=null,i=0,s=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=i,this._once=s}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}};const Bd=class te{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Sn(null,null,1/0),this.deltaMS=1/te.targetFPMS,this.elapsedMS=1/te.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,i=eo.NORMAL){return this._addListener(new Sn(t,e,i))}addOnce(t,e,i=eo.NORMAL){return this._addListener(new Sn(t,e,i,!0))}_addListener(t){let e=this._head.next,i=this._head;if(!e)t.connect(i);else{for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}return this._startIfPossible(),this}remove(t,e){let i=this._head.next;for(;i;)i.match(t,e)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*te.targetFPMS;const i=this._head;let s=i.next;for(;s;)s=s.emit(this);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,te.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!te._shared){const t=te._shared=new te;t.autoStart=!0,t._protected=!0}return te._shared}static get system(){if(!te._system){const t=te._system=new te;t.autoStart=!0,t._protected=!0}return te._system}};Bd.targetFPMS=.06;let Di=Bd,Cn;async function Ld(){return Cn??(Cn=(async()=>{var a;const t=document.createElement("canvas").getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(o=>{const h=document.createElement("video");h.onloadeddata=()=>o(h),h.onerror=()=>o(null),h.autoplay=!1,h.crossOrigin="anonymous",h.preload="auto",h.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",h.load()});if(!e)return"premultiply-alpha-on-upload";const i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i);const s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const n=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,n),t.deleteFramebuffer(s),t.deleteTexture(i),(a=t.getExtension("WEBGL_lose_context"))==null||a.loseContext(),n[0]<=n[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Cn}const Vs=class Nd extends Te{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...Nd.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=Di.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await Ld(),this._load=new Promise((i,s)=>{this.isValid?i(this):(this._resolve=i,this._reject=s,e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Di.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Di.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Di.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};Vs.extension=Z.TextureSource;Vs.defaultOptions={...Te.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};Vs.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let fs=Vs;const ce=(r,t,e=!1)=>(Array.isArray(r)||(r=[r]),t?r.map(i=>typeof i=="string"||e?t(i):i):r);class i_{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||Ot(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const i=ce(t);let s;for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];if(l.test(e)){s=l.getCacheableAssets(i,e);break}}const n=new Map(Object.entries(s||{}));s||i.forEach(h=>{n.set(h,e)});const a=[...n.keys()],o={cacheKeys:a,keys:i};i.forEach(h=>{this._cacheMap.set(h,o)}),a.forEach(h=>{const l=s?s[h]:e;this._cache.has(h)&&this._cache.get(h)!==l&&Ot("[Cache] already has key:",h),this._cache.set(h,n.get(h))})}remove(t){if(!this._cacheMap.has(t)){Ot(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(s=>{this._cache.delete(s)}),e.keys.forEach(s=>{this._cacheMap.delete(s)})}get parsers(){return this._parsers}}const Mt=new i_,ro=[];Kt.handleByList(Z.TextureSource,ro);function Od(r={}){const t=r&&r.resource,e=t?r.resource:r,i=t?r:{resource:r};for(let s=0;s<ro.length;s++){const n=ro[s];if(n.test(e))return new n(i)}throw new Error(`Could not find a source type for resource: ${i.resource}`)}function s_(r={},t=!1){const e=r&&r.resource,i=e?r.resource:r,s=e?r:{resource:r};if(!t&&Mt.has(i))return Mt.get(i);const n=new ht({source:Od(s)});return n.on("destroy",()=>{Mt.has(i)&&Mt.remove(i)}),t||Mt.set(i,n),n}function n_(r,t=!1){return typeof r=="string"?Mt.get(r):r instanceof Te?new ht({source:r}):s_(r,t)}ht.from=n_;Te.from=Od;Kt.add(Rd,Md,Fd,fs,Dr,kd,Vo);var Ve=(r=>(r[r.Low=0]="Low",r[r.Normal=1]="Normal",r[r.High=2]="High",r))(Ve||{});function ae(r){if(typeof r!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(r)}`)}function qr(r){return r.split("?")[0].split("#")[0]}function a_(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function o_(r,t,e){return r.replace(new RegExp(a_(t),"g"),e)}function h_(r,t){let e="",i=0,s=-1,n=0,a=-1;for(let o=0;o<=r.length;++o){if(o<r.length)a=r.charCodeAt(o);else{if(a===47)break;a=47}if(a===47){if(!(s===o-1||n===1))if(s!==o-1&&n===2){if(e.length<2||i!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",i=0):(e=e.slice(0,h),i=e.length-1-e.lastIndexOf("/")),s=o,n=0;continue}}else if(e.length===2||e.length===1){e="",i=0,s=o,n=0;continue}}}else e.length>0?e+=`/${r.slice(s+1,o)}`:e=r.slice(s+1,o),i=o-s-1;s=o,n=0}else a===46&&n!==-1?++n:n=-1}return e}const re={toPosix(r){return o_(r,"\\","/")},isUrl(r){return/^https?:/.test(this.toPosix(r))},isDataUrl(r){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(r)},isBlobUrl(r){return r.startsWith("blob:")},hasProtocol(r){return/^[^/:]+:/.test(this.toPosix(r))},getProtocol(r){ae(r),r=this.toPosix(r);const t=/^file:\/\/\//.exec(r);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(r);return e?e[0]:""},toAbsolute(r,t,e){if(ae(r),this.isDataUrl(r)||this.isBlobUrl(r))return r;const i=qr(this.toPosix(t??Ft.get().getBaseUrl())),s=qr(this.toPosix(e??this.rootname(i)));return r=this.toPosix(r),r.startsWith("/")?re.join(s,r.slice(1)):this.isAbsolute(r)?r:this.join(i,r)},normalize(r){if(ae(r),r.length===0)return".";if(this.isDataUrl(r)||this.isBlobUrl(r))return r;r=this.toPosix(r);let t="";const e=r.startsWith("/");this.hasProtocol(r)&&(t=this.rootname(r),r=r.slice(t.length));const i=r.endsWith("/");return r=h_(r),r.length>0&&i&&(r+="/"),e?`/${r}`:t+r},isAbsolute(r){return ae(r),r=this.toPosix(r),this.hasProtocol(r)?!0:r.startsWith("/")},join(...r){if(r.length===0)return".";let t;for(let e=0;e<r.length;++e){const i=r[e];if(ae(i),i.length>0)if(t===void 0)t=i;else{const s=r[e-1]??"";this.joinExtensions.includes(this.extname(s).toLowerCase())?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(r){if(ae(r),r.length===0)return".";r=this.toPosix(r);let t=r.charCodeAt(0);const e=t===47;let i=-1,s=!0;const n=this.getProtocol(r),a=r;r=r.slice(n.length);for(let o=r.length-1;o>=1;--o)if(t=r.charCodeAt(o),t===47){if(!s){i=o;break}}else s=!1;return i===-1?e?"/":this.isUrl(a)?n+r:n:e&&i===1?"//":n+r.slice(0,i)},rootname(r){ae(r),r=this.toPosix(r);let t="";if(r.startsWith("/")?t="/":t=this.getProtocol(r),this.isUrl(r)){const e=r.indexOf("/",t.length);e!==-1?t=r.slice(0,e):t=r,t.endsWith("/")||(t+="/")}return t},basename(r,t){ae(r),t&&ae(t),r=qr(this.toPosix(r));let e=0,i=-1,s=!0,n;if(t!==void 0&&t.length>0&&t.length<=r.length){if(t.length===r.length&&t===r)return"";let a=t.length-1,o=-1;for(n=r.length-1;n>=0;--n){const h=r.charCodeAt(n);if(h===47){if(!s){e=n+1;break}}else o===-1&&(s=!1,o=n+1),a>=0&&(h===t.charCodeAt(a)?--a===-1&&(i=n):(a=-1,i=o))}return e===i?i=o:i===-1&&(i=r.length),r.slice(e,i)}for(n=r.length-1;n>=0;--n)if(r.charCodeAt(n)===47){if(!s){e=n+1;break}}else i===-1&&(s=!1,i=n+1);return i===-1?"":r.slice(e,i)},extname(r){ae(r),r=qr(this.toPosix(r));let t=-1,e=0,i=-1,s=!0,n=0;for(let a=r.length-1;a>=0;--a){const o=r.charCodeAt(a);if(o===47){if(!s){e=a+1;break}continue}i===-1&&(s=!1,i=a+1),o===46?t===-1?t=a:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||i===-1||n===0||n===1&&t===i-1&&t===e+1?"":r.slice(t,i)},parse(r){ae(r);const t={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return t;r=qr(this.toPosix(r));let e=r.charCodeAt(0);const i=this.isAbsolute(r);let s;t.root=this.rootname(r),i||this.hasProtocol(r)?s=1:s=0;let n=-1,a=0,o=-1,h=!0,l=r.length-1,c=0;for(;l>=s;--l){if(e=r.charCodeAt(l),e===47){if(!h){a=l+1;break}continue}o===-1&&(h=!1,o=l+1),e===46?n===-1?n=l:c!==1&&(c=1):n!==-1&&(c=-1)}return n===-1||o===-1||c===0||c===1&&n===o-1&&n===a+1?o!==-1&&(a===0&&i?t.base=t.name=r.slice(1,o):t.base=t.name=r.slice(a,o)):(a===0&&i?(t.name=r.slice(1,n),t.base=r.slice(1,o)):(t.name=r.slice(a,n),t.base=r.slice(a,o)),t.ext=r.slice(n,o)),t.dir=this.dirname(r),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function Ud(r,t,e,i,s){const n=t[e];for(let a=0;a<n.length;a++){const o=n[a];e<t.length-1?Ud(r.replace(i[e],o),t,e+1,i,s):s.push(r.replace(i[e],o))}}function l_(r){const t=/\{(.*?)\}/g,e=r.match(t),i=[];if(e){const s=[];e.forEach(n=>{const a=n.substring(1,n.length-1).split(",");s.push(a)}),Ud(r,s,0,e,i)}else i.push(r);return i}const Is=r=>!Array.isArray(r);class $r{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`).join("&")}}getAlias(t){const{alias:e,src:i}=t;return ce(e||i,n=>typeof n=="string"?n:Array.isArray(n)?n.map(a=>(a==null?void 0:a.src)??a):n!=null&&n.src?n.src:n,!0)}addManifest(t){this._manifest&&Ot("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const i=[];let s=e;Array.isArray(e)||(s=Object.entries(e).map(([n,a])=>typeof a=="string"||Array.isArray(a)?{alias:n,src:a}:{alias:n,...a})),s.forEach(n=>{const a=n.src,o=n.alias;let h;if(typeof o=="string"){const l=this._createBundleAssetId(t,o);i.push(l),h=[o,l]}else{const l=o.map(c=>this._createBundleAssetId(t,c));i.push(...l),h=[...o,...l]}this.add({...n,alias:h,src:a})}),this._bundles[t]=i}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);let i;i=n=>{this.hasKey(n)&&Ot(`[Resolver] already has key: ${n} overwriting`)},ce(e).forEach(n=>{const{src:a}=n;let{data:o,format:h,loadParser:l}=n;const c=ce(a).map(d=>typeof d=="string"?l_(d):Array.isArray(d)?d:[d]),u=this.getAlias(n);Array.isArray(u)?u.forEach(i):i(u);const f=[];c.forEach(d=>{d.forEach(g=>{let y={};if(typeof g!="object"){y.src=g;for(let p=0;p<this._parsers.length;p++){const m=this._parsers[p];if(m.test(g)){y=m.parse(g);break}}}else o=g.data??o,h=g.format??h,l=g.loadParser??l,y={...y,...g};if(!u)throw new Error(`[Resolver] alias is undefined for this asset: ${y.src}`);y=this._buildResolvedAsset(y,{aliases:u,data:o,format:h,loadParser:l}),f.push(y)})}),u.forEach(d=>{this._assetMap[d]=f})})}resolveBundle(t){const e=Is(t);t=ce(t);const i={};return t.forEach(s=>{const n=this._bundles[s];if(n){const a=this.resolve(n),o={};for(const h in a){const l=a[h];o[this._extractAssetIdFromBundle(s,h)]=l}i[s]=o}}),e?i[t[0]]:i}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const i={};for(const s in e)i[s]=e[s].src;return i}return e.src}resolve(t){const e=Is(t);t=ce(t);const i={};return t.forEach(s=>{if(!this._resolverHash[s])if(this._assetMap[s]){let n=this._assetMap[s];const a=this._getPreferredOrder(n);a==null||a.priority.forEach(o=>{a.params[o].forEach(h=>{const l=n.filter(c=>c[o]?c[o]===h:!1);l.length&&(n=l)})}),this._resolverHash[s]=n[0]}else this._resolverHash[s]=this._buildResolvedAsset({alias:[s],src:s},{});i[s]=this._resolverHash[s]}),e?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const i=t[0],s=this._preferredOrder.find(n=>n.params.format.includes(i.format));if(s)return s}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:i,data:s,loadParser:n,format:a}=e;return(this._basePath||this._rootPath)&&(t.src=re.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=i??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...s||{},...t.data},t.loadParser=n??t.loadParser,t.format=a??t.format??c_(t.src),t}}$r.RETINA_PREFIX=/@([0-9\.]+)x/;function c_(r){return r.split(".").pop().split("?").shift().split("#").shift()}const io=(r,t)=>{const e=t.split("?")[1];return e&&(r+=`?${e}`),r},Gd=class si{constructor(t,e){this.linkedSheets=[],this._texture=t instanceof ht?t:null,this.textureSource=t.source,this.textures={},this.animations={},this.data=e;const i=parseFloat(e.meta.scale);i?(this.resolution=i,t.source.resolution=this.resolution):this.resolution=t.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=si.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const i=si.BATCH_SIZE;for(;e-t<i&&e<this._frameKeys.length;){const s=this._frameKeys[e],n=this._frames[s],a=n.frame;if(a){let o=null,h=null;const l=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,c=new Yt(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);n.rotated?o=new Yt(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):o=new Yt(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(h=new Yt(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[s]=new ht({source:this.textureSource,frame:o,orig:c,trim:h,rotate:n.rotated?2:0,defaultAnchor:n.anchor,defaultBorders:n.borders,label:s.toString()})}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let i=0;i<t[e].length;i++){const s=t[e][i];this.animations[e].push(this.textures[s])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*si.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*si.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};Gd.BATCH_SIZE=1e3;let Bl=Gd;const u_=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function Dd(r,t,e){const i={};if(r.forEach(s=>{i[s]=t}),Object.keys(t.textures).forEach(s=>{i[s]=t.textures[s]}),!e){const s=re.dirname(r[0]);t.linkedSheets.forEach((n,a)=>{const o=Dd([`${s}/${t.data.meta.related_multi_packs[a]}`],n,!0);Object.assign(i,o)})}return i}const d_={extension:Z.Asset,cache:{test:r=>r instanceof Bl,getCacheableAssets:(r,t)=>Dd(r,t,!1)},resolver:{extension:{type:Z.ResolveParser,name:"resolveSpritesheet"},test:r=>{const e=r.split("?")[0].split("."),i=e.pop(),s=e.pop();return i==="json"&&u_.includes(s)},parse:r=>{var e;const t=r.split(".");return{resolution:parseFloat(((e=$r.RETINA_PREFIX.exec(r))==null?void 0:e[1])??"1"),format:t[t.length-2],src:r}}},loader:{name:"spritesheetLoader",extension:{type:Z.LoadParser,priority:Ve.Normal,name:"spritesheetLoader"},async testParse(r,t){return re.extname(t.src).toLowerCase()===".json"&&!!r.frames},async parse(r,t,e){var l,c;const{texture:i,imageFilename:s}=(t==null?void 0:t.data)??{};let n=re.dirname(t.src);n&&n.lastIndexOf("/")!==n.length-1&&(n+="/");let a;if(i instanceof ht)a=i;else{const u=io(n+(s??r.meta.image),t.src);a=(await e.load([u]))[u]}const o=new Bl(a.source,r);await o.parse();const h=(l=r==null?void 0:r.meta)==null?void 0:l.related_multi_packs;if(Array.isArray(h)){const u=[];for(const d of h){if(typeof d!="string")continue;let g=n+d;(c=t.data)!=null&&c.ignoreMultiPack||(g=io(g,t.src),u.push(e.load({src:g,data:{ignoreMultiPack:!0}})))}const f=await Promise.all(u);o.linkedSheets=f,f.forEach(d=>{d.linkedSheets=[o].concat(o.linkedSheets.filter(g=>g!==d))})}return o},async unload(r,t,e){await e.unload(r.textureSource._sourceOrigin),r.destroy(!1)}}};Kt.add(d_);var En=/iPhone/i,Ll=/iPod/i,Nl=/iPad/i,Ol=/\biOS-universal(?:.+)Mac\b/i,In=/\bAndroid(?:.+)Mobile\b/i,Ul=/Android/i,yr=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,$i=/Silk/i,Ce=/Windows Phone/i,Gl=/\bWindows(?:.+)ARM\b/i,Dl=/BlackBerry/i,$l=/BB10/i,Hl=/Opera Mini/i,Vl=/\b(CriOS|Chrome)(?:.+)Mobile/i,zl=/Mobile(?:.+)Firefox\b/i,Xl=function(r){return typeof r<"u"&&r.platform==="MacIntel"&&typeof r.maxTouchPoints=="number"&&r.maxTouchPoints>1&&typeof MSStream>"u"};function f_(r){return function(t){return t.test(r)}}function Wl(r){var t={userAgent:"",platform:"",maxTouchPoints:0};!r&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof r=="string"?t.userAgent=r:r&&r.userAgent&&(t={userAgent:r.userAgent,platform:r.platform,maxTouchPoints:r.maxTouchPoints||0});var e=t.userAgent,i=e.split("[FBAN");typeof i[1]<"u"&&(e=i[0]),i=e.split("Twitter"),typeof i[1]<"u"&&(e=i[0]);var s=f_(e),n={apple:{phone:s(En)&&!s(Ce),ipod:s(Ll),tablet:!s(En)&&(s(Nl)||Xl(t))&&!s(Ce),universal:s(Ol),device:(s(En)||s(Ll)||s(Nl)||s(Ol)||Xl(t))&&!s(Ce)},amazon:{phone:s(yr),tablet:!s(yr)&&s($i),device:s(yr)||s($i)},android:{phone:!s(Ce)&&s(yr)||!s(Ce)&&s(In),tablet:!s(Ce)&&!s(yr)&&!s(In)&&(s($i)||s(Ul)),device:!s(Ce)&&(s(yr)||s($i)||s(In)||s(Ul))||s(/\bokhttp\b/i)},windows:{phone:s(Ce),tablet:s(Gl),device:s(Ce)||s(Gl)},other:{blackberry:s(Dl),blackberry10:s($l),opera:s(Hl),firefox:s(zl),chrome:s(Vl),device:s(Dl)||s($l)||s(Hl)||s(zl)||s(Vl)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const Pn=Object.create(null),jl=Object.create(null);function Wo(r,t){let e=jl[r];return e===void 0&&(Pn[t]===void 0&&(Pn[t]=1),jl[r]=e=Pn[t]++),e}let _r;function $d(){return(!_r||_r!=null&&_r.isContextLost())&&(_r=Ft.get().createCanvas().getContext("webgl",{})),_r}let Hi;function p_(){if(!Hi){Hi="mediump";const r=$d();r&&r.getShaderPrecisionFormat&&(Hi=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT).precision?"highp":"mediump")}return Hi}function m_(r,t,e){return t?r:e?(r=r.replace("out vec4 finalColor;",""),`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${r}
        `):`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${r}
        `}function g_(r,t,e){const i=e?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if(r.substring(0,9)!=="precision"){let s=e?t.requestedFragmentPrecision:t.requestedVertexPrecision;return s==="highp"&&i!=="highp"&&(s="mediump"),`precision ${s} float;
${r}`}else if(i!=="highp"&&r.substring(0,15)==="precision highp")return r.replace("precision highp","precision mediump");return r}function y_(r,t){return t?`#version 300 es
${r}`:r}const __={},x_={};function v_(r,{name:t="pixi-program"},e=!0){t=t.replace(/\s+/g,"-"),t+=e?"-fragment":"-vertex";const i=e?__:x_;return i[t]?(i[t]++,t+=`-${i[t]}`):i[t]=1,r.indexOf("#define SHADER_NAME")!==-1?r:`${`#define SHADER_NAME ${t}`}
${r}`}function b_(r,t){return t?r.replace("#version 300 es",""):r}const Rn={stripVersion:b_,ensurePrecision:g_,addProgramDefines:m_,setProgramName:v_,insertVersion:y_},Mn=Object.create(null),Hd=class so{constructor(t){t={...so.defaultOptions,...t};const e=t.fragment.indexOf("#version 300 es")!==-1,i={stripVersion:e,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:p_()},setProgramName:{name:t.name},addProgramDefines:e,insertVersion:e};let s=t.fragment,n=t.vertex;Object.keys(Rn).forEach(a=>{const o=i[a];s=Rn[a](s,o,!0),n=Rn[a](n,o,!1)}),this.fragment=s,this.vertex=n,this.transformFeedbackVaryings=t.transformFeedbackVaryings,this._key=Wo(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(t){const e=`${t.vertex}:${t.fragment}`;return Mn[e]||(Mn[e]=new so(t)),Mn[e]}};Hd.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let Vd=Hd;const Yl={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function w_(r){return Yl[r]??Yl.float32}const A_={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function T_({source:r,entryPoint:t}){const e={},i=r.indexOf(`fn ${t}`);if(i!==-1){const s=r.indexOf("->",i);if(s!==-1){const n=r.substring(i,s),a=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let o;for(;(o=a.exec(n))!==null;){const h=A_[o[3]]??"float32";e[o[2]]={location:parseInt(o[1],10),format:h,stride:w_(h).stride,offset:0,instance:!1,start:0}}}}return e}function Fn(r){var u,f;const t=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,e=/@group\((\d+)\)/,i=/@binding\((\d+)\)/,s=/var(<[^>]+>)? (\w+)/,n=/:\s*(\w+)/,a=/struct\s+(\w+)\s*{([^}]+)}/g,o=/(\w+)\s*:\s*([\w\<\>]+)/g,h=/struct\s+(\w+)/,l=(u=r.match(t))==null?void 0:u.map(d=>({group:parseInt(d.match(e)[1],10),binding:parseInt(d.match(i)[1],10),name:d.match(s)[2],isUniform:d.match(s)[1]==="<uniform>",type:d.match(n)[1]}));if(!l)return{groups:[],structs:[]};const c=((f=r.match(a))==null?void 0:f.map(d=>{const g=d.match(h)[1],y=d.match(o).reduce((p,m)=>{const[_,v]=m.split(":");return p[_.trim()]=v.trim(),p},{});return y?{name:g,members:y}:null}).filter(({name:d})=>l.some(g=>g.type===d)))??[];return{groups:l,structs:c}}var ni=(r=>(r[r.VERTEX=1]="VERTEX",r[r.FRAGMENT=2]="FRAGMENT",r[r.COMPUTE=4]="COMPUTE",r))(ni||{});function S_({groups:r}){const t=[];for(let e=0;e<r.length;e++){const i=r[e];t[i.group]||(t[i.group]=[]),i.isUniform?t[i.group].push({binding:i.binding,visibility:ni.VERTEX|ni.FRAGMENT,buffer:{type:"uniform"}}):i.type==="sampler"?t[i.group].push({binding:i.binding,visibility:ni.FRAGMENT,sampler:{type:"filtering"}}):i.type==="texture_2d"&&t[i.group].push({binding:i.binding,visibility:ni.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return t}function C_({groups:r}){const t=[];for(let e=0;e<r.length;e++){const i=r[e];t[i.group]||(t[i.group]={}),t[i.group][i.name]=i.binding}return t}function E_(r,t){const e=new Set,i=new Set,s=[...r.structs,...t.structs].filter(a=>e.has(a.name)?!1:(e.add(a.name),!0)),n=[...r.groups,...t.groups].filter(a=>{const o=`${a.name}-${a.binding}`;return i.has(o)?!1:(i.add(o),!0)});return{structs:s,groups:n}}const kn=Object.create(null);class zs{constructor(t){var o,h;this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:e,vertex:i,layout:s,gpuLayout:n,name:a}=t;if(this.name=a,this.fragment=e,this.vertex=i,e.source===i.source){const l=Fn(e.source);this.structsAndGroups=l}else{const l=Fn(i.source),c=Fn(e.source);this.structsAndGroups=E_(l,c)}this.layout=s??C_(this.structsAndGroups),this.gpuLayout=n??S_(this.structsAndGroups),this.autoAssignGlobalUniforms=((o=this.layout[0])==null?void 0:o.globalUniforms)!==void 0,this.autoAssignLocalUniforms=((h=this.layout[1])==null?void 0:h.localUniforms)!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:e}=this,i=t.source+e.source+t.entryPoint+e.entryPoint;this._layoutKey=Wo(i,"program")}get attributeData(){return this._attributeData??(this._attributeData=T_(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(t){const e=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return kn[e]||(kn[e]=new zs(t)),kn[e]}}const zd=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],I_=zd.reduce((r,t)=>(r[t]=!0,r),{});function P_(r,t){switch(r){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Xd=class Wd{constructor(t,e){this._touched=0,this.uid=Gt("uniform"),this._resourceType="uniformGroup",this._resourceId=Gt("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,e={...Wd.defaultOptions,...e},this.uniformStructures=t;const i={};for(const s in t){const n=t[s];if(n.name=s,n.size=n.size??1,!I_[n.type])throw new Error(`Uniform type ${n.type} is not supported. Supported uniform types are: ${zd.join(", ")}`);n.value??(n.value=P_(n.type,n.size)),i[s]=n.value}this.uniforms=i,this._dirtyId=1,this.ubo=e.ubo,this.isStatic=e.isStatic,this._signature=Wo(Object.keys(i).map(s=>`${s}-${t[s].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};Xd.defaultOptions={ubo:!1,isStatic:!1};let jd=Xd;class ps{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const i in t){const s=t[i];this.setResource(s,e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let e=0;for(const i in this.resources)t[e++]=this.resources[i]._resourceId;this._key=t.join("|")}setResource(t,e){var s,n;const i=this.resources[e];t!==i&&(i&&((s=t.off)==null||s.call(t,"change",this.onResourceChange,this)),(n=t.on)==null||n.call(t,"change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t){const e=this.resources;for(const i in e)e[i]._touched=t}destroy(){var e;const t=this.resources;for(const i in t){const s=t[i];(e=s.off)==null||e.call(s,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const e=this.resources;for(const i in e)e[i]===t&&(e[i]=null)}else this._updateKey()}}var no=(r=>(r[r.WEBGL=1]="WEBGL",r[r.WEBGPU=2]="WEBGPU",r[r.BOTH=3]="BOTH",r))(no||{});let R_=class Yd extends me{constructor(t){super(),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:e,glProgram:i,groups:s,resources:n,compatibleRenderers:a,groupMap:o}=t;this.gpuProgram=e,this.glProgram=i,a===void 0&&(a=0,e&&(a|=no.WEBGPU),i&&(a|=no.WEBGL)),this.compatibleRenderers=a;const h={};if(!n&&!s&&(n={}),n&&s)throw new Error("[Shader] Cannot have both resources and groups");if(!e&&s&&!o)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!e&&s&&o)for(const l in o)for(const c in o[l]){const u=o[l][c];h[u]={group:l,binding:c,name:u}}else if(e&&s&&!o){const l=e.structsAndGroups.groups;o={},l.forEach(c=>{o[c.group]=o[c.group]||{},o[c.group][c.binding]=c.name,h[c.name]=c})}else if(n){s={},o={},e&&e.structsAndGroups.groups.forEach(u=>{o[u.group]=o[u.group]||{},o[u.group][u.binding]=u.name,h[u.name]=u});let l=0;for(const c in n)h[c]||(s[99]||(s[99]=new ps,this._ownedBindGroups.push(s[99])),h[c]={group:99,binding:l,name:c},o[99]=o[99]||{},o[99][l]=c,l++);for(const c in n){const u=c;let f=n[c];!f.source&&!f._resourceType&&(f=new jd(f));const d=h[u];d&&(s[d.group]||(s[d.group]=new ps,this._ownedBindGroups.push(s[d.group])),s[d.group].setResource(f,d.binding))}}this.groups=s,this._uniformBindMap=o,this.resources=this._buildResourceAccessor(s,h)}addResource(t,e,i){var s,n;(s=this._uniformBindMap)[e]||(s[e]={}),(n=this._uniformBindMap[e])[i]||(n[i]=t),this.groups[e]||(this.groups[e]=new ps,this._ownedBindGroups.push(this.groups[e]))}_buildResourceAccessor(t,e){const i={};for(const s in e){const n=e[s];Object.defineProperty(i,n.name,{get(){return t[n.group].getResource(n.binding)},set(a){t[n.group].setResource(a,n.binding)}})}return i}destroy(t=!1){var e,i;this.emit("destroy",this),t&&((e=this.gpuProgram)==null||e.destroy(),(i=this.glProgram)==null||i.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(s=>{s.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(t){const{gpu:e,gl:i,...s}=t;let n,a;return e&&(n=zs.from(e)),i&&(a=Vd.from(i)),new Yd({gpuProgram:n,glProgram:a,...s})}};const M_={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},Bn=0,Ln=1,Nn=2,On=3,Un=4,Gn=5,ao=class qd{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Bn)}set blend(t){!!(this.data&1<<Bn)!==t&&(this.data^=1<<Bn)}get offsets(){return!!(this.data&1<<Ln)}set offsets(t){!!(this.data&1<<Ln)!==t&&(this.data^=1<<Ln)}set cullMode(t){if(t==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=t==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<Nn)}set culling(t){!!(this.data&1<<Nn)!==t&&(this.data^=1<<Nn)}get depthTest(){return!!(this.data&1<<On)}set depthTest(t){!!(this.data&1<<On)!==t&&(this.data^=1<<On)}get depthMask(){return!!(this.data&1<<Gn)}set depthMask(t){!!(this.data&1<<Gn)!==t&&(this.data^=1<<Gn)}get clockwiseFrontFace(){return!!(this.data&1<<Un)}set clockwiseFrontFace(t){!!(this.data&1<<Un)!==t&&(this.data^=1<<Un)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!=="none",this._blendMode=t,this._blendModeId=M_[t]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new qd;return t.depthTest=!1,t.blend=!0,t}};ao.default2d=ao.for2d();let F_=ao;const oo=[];Kt.handleByNamedList(Z.Environment,oo);async function k_(r){if(!r)for(let t=0;t<oo.length;t++){const e=oo[t];if(e.value.test()){await e.value.load();return}}}let Kr;function B_(){if(typeof Kr=="boolean")return Kr;try{Kr=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Kr=!1}return Kr}var Vi={exports:{}},ql;function L_(){if(ql)return Vi.exports;ql=1,Vi.exports=r,Vi.exports.default=r;function r(w,C,T){T=T||2;var P=C&&C.length,E=P?C[0]*T:w.length,I=t(w,0,E,T,!0),R=[];if(!I||I.next===I.prev)return R;var F,U,D,H,X,W,q;if(P&&(I=h(w,C,I,T)),w.length>80*T){F=D=w[0],U=H=w[1];for(var z=T;z<E;z+=T)X=w[z],W=w[z+1],X<F&&(F=X),W<U&&(U=W),X>D&&(D=X),W>H&&(H=W);q=Math.max(D-F,H-U),q=q!==0?32767/q:0}return i(I,R,T,F,U,q,0),R}function t(w,C,T,P,E){var I,R;if(E===rt(w,C,T,P)>0)for(I=C;I<T;I+=P)R=N(I,w[I],w[I+1],R);else for(I=T-P;I>=C;I-=P)R=N(I,w[I],w[I+1],R);return R&&A(R,R.next)&&(j(R),R=R.next),R}function e(w,C){if(!w)return w;C||(C=w);var T=w,P;do if(P=!1,!T.steiner&&(A(T,T.next)||v(T.prev,T,T.next)===0)){if(j(T),T=C=T.prev,T===T.next)break;P=!0}else T=T.next;while(P||T!==C);return C}function i(w,C,T,P,E,I,R){if(w){!R&&I&&d(w,P,E,I);for(var F=w,U,D;w.prev!==w.next;){if(U=w.prev,D=w.next,I?n(w,P,E,I):s(w)){C.push(U.i/T|0),C.push(w.i/T|0),C.push(D.i/T|0),j(w),w=D.next,F=D.next;continue}if(w=D,w===F){R?R===1?(w=a(e(w),C,T),i(w,C,T,P,E,I,2)):R===2&&o(w,C,T,P,E,I):i(e(w),C,T,P,E,I,1);break}}}}function s(w){var C=w.prev,T=w,P=w.next;if(v(C,T,P)>=0)return!1;for(var E=C.x,I=T.x,R=P.x,F=C.y,U=T.y,D=P.y,H=E<I?E<R?E:R:I<R?I:R,X=F<U?F<D?F:D:U<D?U:D,W=E>I?E>R?E:R:I>R?I:R,q=F>U?F>D?F:D:U>D?U:D,z=P.next;z!==C;){if(z.x>=H&&z.x<=W&&z.y>=X&&z.y<=q&&m(E,F,I,U,R,D,z.x,z.y)&&v(z.prev,z,z.next)>=0)return!1;z=z.next}return!0}function n(w,C,T,P){var E=w.prev,I=w,R=w.next;if(v(E,I,R)>=0)return!1;for(var F=E.x,U=I.x,D=R.x,H=E.y,X=I.y,W=R.y,q=F<U?F<D?F:D:U<D?U:D,z=H<X?H<W?H:W:X<W?X:W,it=F>U?F>D?F:D:U>D?U:D,st=H>X?H>W?H:W:X>W?X:W,gt=y(q,z,C,T,P),ft=y(it,st,C,T,P),K=w.prevZ,tt=w.nextZ;K&&K.z>=gt&&tt&&tt.z<=ft;){if(K.x>=q&&K.x<=it&&K.y>=z&&K.y<=st&&K!==E&&K!==R&&m(F,H,U,X,D,W,K.x,K.y)&&v(K.prev,K,K.next)>=0||(K=K.prevZ,tt.x>=q&&tt.x<=it&&tt.y>=z&&tt.y<=st&&tt!==E&&tt!==R&&m(F,H,U,X,D,W,tt.x,tt.y)&&v(tt.prev,tt,tt.next)>=0))return!1;tt=tt.nextZ}for(;K&&K.z>=gt;){if(K.x>=q&&K.x<=it&&K.y>=z&&K.y<=st&&K!==E&&K!==R&&m(F,H,U,X,D,W,K.x,K.y)&&v(K.prev,K,K.next)>=0)return!1;K=K.prevZ}for(;tt&&tt.z<=ft;){if(tt.x>=q&&tt.x<=it&&tt.y>=z&&tt.y<=st&&tt!==E&&tt!==R&&m(F,H,U,X,D,W,tt.x,tt.y)&&v(tt.prev,tt,tt.next)>=0)return!1;tt=tt.nextZ}return!0}function a(w,C,T){var P=w;do{var E=P.prev,I=P.next.next;!A(E,I)&&x(E,P,P.next,I)&&G(E,I)&&G(I,E)&&(C.push(E.i/T|0),C.push(P.i/T|0),C.push(I.i/T|0),j(P),j(P.next),P=w=I),P=P.next}while(P!==w);return e(P)}function o(w,C,T,P,E,I){var R=w;do{for(var F=R.next.next;F!==R.prev;){if(R.i!==F.i&&_(R,F)){var U=O(R,F);R=e(R,R.next),U=e(U,U.next),i(R,C,T,P,E,I,0),i(U,C,T,P,E,I,0);return}F=F.next}R=R.next}while(R!==w)}function h(w,C,T,P){var E=[],I,R,F,U,D;for(I=0,R=C.length;I<R;I++)F=C[I]*P,U=I<R-1?C[I+1]*P:w.length,D=t(w,F,U,P,!1),D===D.next&&(D.steiner=!0),E.push(p(D));for(E.sort(l),I=0;I<E.length;I++)T=c(E[I],T);return T}function l(w,C){return w.x-C.x}function c(w,C){var T=u(w,C);if(!T)return C;var P=O(T,w);return e(P,P.next),e(T,T.next)}function u(w,C){var T=C,P=w.x,E=w.y,I=-1/0,R;do{if(E<=T.y&&E>=T.next.y&&T.next.y!==T.y){var F=T.x+(E-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(F<=P&&F>I&&(I=F,R=T.x<T.next.x?T:T.next,F===P))return R}T=T.next}while(T!==C);if(!R)return null;var U=R,D=R.x,H=R.y,X=1/0,W;T=R;do P>=T.x&&T.x>=D&&P!==T.x&&m(E<H?P:I,E,D,H,E<H?I:P,E,T.x,T.y)&&(W=Math.abs(E-T.y)/(P-T.x),G(T,w)&&(W<X||W===X&&(T.x>R.x||T.x===R.x&&f(R,T)))&&(R=T,X=W)),T=T.next;while(T!==U);return R}function f(w,C){return v(w.prev,w,C.prev)<0&&v(C.next,w,w.next)<0}function d(w,C,T,P){var E=w;do E.z===0&&(E.z=y(E.x,E.y,C,T,P)),E.prevZ=E.prev,E.nextZ=E.next,E=E.next;while(E!==w);E.prevZ.nextZ=null,E.prevZ=null,g(E)}function g(w){var C,T,P,E,I,R,F,U,D=1;do{for(T=w,w=null,I=null,R=0;T;){for(R++,P=T,F=0,C=0;C<D&&(F++,P=P.nextZ,!!P);C++);for(U=D;F>0||U>0&&P;)F!==0&&(U===0||!P||T.z<=P.z)?(E=T,T=T.nextZ,F--):(E=P,P=P.nextZ,U--),I?I.nextZ=E:w=E,E.prevZ=I,I=E;T=P}I.nextZ=null,D*=2}while(R>1);return w}function y(w,C,T,P,E){return w=(w-T)*E|0,C=(C-P)*E|0,w=(w|w<<8)&16711935,w=(w|w<<4)&252645135,w=(w|w<<2)&858993459,w=(w|w<<1)&1431655765,C=(C|C<<8)&16711935,C=(C|C<<4)&252645135,C=(C|C<<2)&858993459,C=(C|C<<1)&1431655765,w|C<<1}function p(w){var C=w,T=w;do(C.x<T.x||C.x===T.x&&C.y<T.y)&&(T=C),C=C.next;while(C!==w);return T}function m(w,C,T,P,E,I,R,F){return(E-R)*(C-F)>=(w-R)*(I-F)&&(w-R)*(P-F)>=(T-R)*(C-F)&&(T-R)*(I-F)>=(E-R)*(P-F)}function _(w,C){return w.next.i!==C.i&&w.prev.i!==C.i&&!B(w,C)&&(G(w,C)&&G(C,w)&&L(w,C)&&(v(w.prev,w,C.prev)||v(w,C.prev,C))||A(w,C)&&v(w.prev,w,w.next)>0&&v(C.prev,C,C.next)>0)}function v(w,C,T){return(C.y-w.y)*(T.x-C.x)-(C.x-w.x)*(T.y-C.y)}function A(w,C){return w.x===C.x&&w.y===C.y}function x(w,C,T,P){var E=b(v(w,C,T)),I=b(v(w,C,P)),R=b(v(T,P,w)),F=b(v(T,P,C));return!!(E!==I&&R!==F||E===0&&S(w,T,C)||I===0&&S(w,P,C)||R===0&&S(T,w,P)||F===0&&S(T,C,P))}function S(w,C,T){return C.x<=Math.max(w.x,T.x)&&C.x>=Math.min(w.x,T.x)&&C.y<=Math.max(w.y,T.y)&&C.y>=Math.min(w.y,T.y)}function b(w){return w>0?1:w<0?-1:0}function B(w,C){var T=w;do{if(T.i!==w.i&&T.next.i!==w.i&&T.i!==C.i&&T.next.i!==C.i&&x(T,T.next,w,C))return!0;T=T.next}while(T!==w);return!1}function G(w,C){return v(w.prev,w,w.next)<0?v(w,C,w.next)>=0&&v(w,w.prev,C)>=0:v(w,C,w.prev)<0||v(w,w.next,C)<0}function L(w,C){var T=w,P=!1,E=(w.x+C.x)/2,I=(w.y+C.y)/2;do T.y>I!=T.next.y>I&&T.next.y!==T.y&&E<(T.next.x-T.x)*(I-T.y)/(T.next.y-T.y)+T.x&&(P=!P),T=T.next;while(T!==w);return P}function O(w,C){var T=new J(w.i,w.x,w.y),P=new J(C.i,C.x,C.y),E=w.next,I=C.prev;return w.next=C,C.prev=w,T.next=E,E.prev=T,P.next=T,T.prev=P,I.next=P,P.prev=I,P}function N(w,C,T,P){var E=new J(w,C,T);return P?(E.next=P.next,E.prev=P,P.next.prev=E,P.next=E):(E.prev=E,E.next=E),E}function j(w){w.next.prev=w.prev,w.prev.next=w.next,w.prevZ&&(w.prevZ.nextZ=w.nextZ),w.nextZ&&(w.nextZ.prevZ=w.prevZ)}function J(w,C,T){this.i=w,this.x=C,this.y=T,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}r.deviation=function(w,C,T,P){var E=C&&C.length,I=E?C[0]*T:w.length,R=Math.abs(rt(w,0,I,T));if(E)for(var F=0,U=C.length;F<U;F++){var D=C[F]*T,H=F<U-1?C[F+1]*T:w.length;R-=Math.abs(rt(w,D,H,T))}var X=0;for(F=0;F<P.length;F+=3){var W=P[F]*T,q=P[F+1]*T,z=P[F+2]*T;X+=Math.abs((w[W]-w[z])*(w[q+1]-w[W+1])-(w[W]-w[q])*(w[z+1]-w[W+1]))}return R===0&&X===0?0:Math.abs((X-R)/R)};function rt(w,C,T,P){for(var E=0,I=C,R=T-P;I<T;I+=P)E+=(w[R]-w[I])*(w[I+1]+w[R+1]),R=I;return E}return r.flatten=function(w){for(var C=w[0][0].length,T={vertices:[],holes:[],dimensions:C},P=0,E=0;E<w.length;E++){for(var I=0;I<w[E].length;I++)for(var R=0;R<C;R++)T.vertices.push(w[E][I][R]);E>0&&(P+=w[E-1].length,T.holes.push(P))}return T},Vi.exports}var N_=L_();const O_=Hs(N_);var Kd=(r=>(r[r.NONE=0]="NONE",r[r.COLOR=16384]="COLOR",r[r.STENCIL=1024]="STENCIL",r[r.DEPTH=256]="DEPTH",r[r.COLOR_DEPTH=16640]="COLOR_DEPTH",r[r.COLOR_STENCIL=17408]="COLOR_STENCIL",r[r.DEPTH_STENCIL=1280]="DEPTH_STENCIL",r[r.ALL=17664]="ALL",r))(Kd||{});class U_{constructor(t){this.items=[],this._name=t}emit(t,e,i,s,n,a,o,h){const{name:l,items:c}=this;for(let u=0,f=c.length;u<f;u++)c[u][l](t,e,i,s,n,a,o,h);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&this.items.splice(e,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const G_=["init","destroy","contextChange","resolutionChange","reset","renderEnd","renderStart","render","update","postrender","prerender"],Zd=class Qd extends me{constructor(t){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const e=[...G_,...this.config.runners??[]];this._addRunners(...e),this._unsafeEvalCheck()}async init(t={}){const e=t.skipExtensionImports===!0?!0:t.manageImports===!1;await k_(e),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const i in this._systemsHash)t={...this._systemsHash[i].constructor.defaultOptions,...t};t={...Qd.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let i=0;i<this.runners.init.items.length;i++)await this.runners.init.items[i].init(t);this._initOptions=t}render(t,e){let i=t;if(i instanceof Qt&&(i={container:i},e&&(wt(Rt,"passing a second argument is deprecated, please use render options instead"),i.target=e.renderTexture)),i.target||(i.target=this.view.renderTarget),i.target===this.view.renderTarget&&(this._lastObjectRendered=i.container,i.clearColor=this.background.colorRgba),i.clearColor){const s=Array.isArray(i.clearColor)&&i.clearColor.length===4;i.clearColor=s?i.clearColor:Nt.shared.setValue(i.clearColor).toArray()}i.transform||(i.container.updateLocalTransform(),i.transform=i.container.localTransform),i.container.enableRenderGroup(),this.runners.prerender.emit(i),this.runners.renderStart.emit(i),this.runners.render.emit(i),this.runners.renderEnd.emit(i),this.runners.postrender.emit(i)}resize(t,e,i){const s=this.view.resolution;this.view.resize(t,e,i),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),i!==void 0&&i!==s&&this.runners.resolutionChange.emit(i)}clear(t={}){const e=this;t.target||(t.target=e.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=Kd.ALL);const{clear:i,clearColor:s,target:n}=t;Nt.shared.setValue(s??this.background.colorRgba),e.renderTarget.clear(n,i,Nt.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(e=>{this.runners[e]=new U_(e)})}_addSystems(t){let e;for(e in t){const i=t[e];this._addSystem(i.value,i.name)}}_addSystem(t,e){const i=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=i,this._systemsHash[e]=i;for(const s in this.runners)this.runners[s].add(i);return this}_addPipes(t,e){const i=e.reduce((s,n)=>(s[n.name]=n.value,s),{});t.forEach(s=>{const n=s.value,a=s.name,o=i[a];this.renderPipes[a]=new n(this,o?new o:null)})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!B_())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}};Zd.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let Jd=Zd,zi;function D_(r){return zi!==void 0||(zi=(()=>{var e;const t={stencil:!0,failIfMajorPerformanceCaveat:r??Jd.defaultOptions.failIfMajorPerformanceCaveat};try{if(!Ft.get().getWebGLRenderingContext())return!1;let s=Ft.get().createCanvas().getContext("webgl",t);const n=!!((e=s==null?void 0:s.getContextAttributes())!=null&&e.stencil);if(s){const a=s.getExtension("WEBGL_lose_context");a&&a.loseContext()}return s=null,n}catch{return!1}})()),zi}let Xi;async function $_(r={}){return Xi!==void 0||(Xi=await(async()=>{const t=Ft.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(r)).requestDevice(),!0}catch{return!1}})()),Xi}const Kl=["webgl","webgpu","canvas"];async function H_(r){let t=[];r.preference?(t.push(r.preference),Kl.forEach(n=>{n!==r.preference&&t.push(n)})):t=Kl.slice();let e,i={};for(let n=0;n<t.length;n++){const a=t[n];if(a==="webgpu"&&await $_()){const{WebGPURenderer:o}=await As(async()=>{const{WebGPURenderer:h}=await import("./WebGPURenderer.BanXHdHj.js");return{WebGPURenderer:h}},__vite__mapDeps([3,2,4]),import.meta.url);e=o,i={...r,...r.webgpu};break}else if(a==="webgl"&&D_(r.failIfMajorPerformanceCaveat??Jd.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:o}=await As(async()=>{const{WebGLRenderer:h}=await import("./WebGLRenderer.Dow1LHmW.js");return{WebGLRenderer:h}},__vite__mapDeps([5,2,4]),import.meta.url);e=o,i={...r,...r.webgl};break}else if(a==="canvas")throw i={...r},new Error("CanvasRenderer is not yet implemented")}if(delete i.webgpu,delete i.webgl,!e)throw new Error("No available renderer for the current environment");const s=new e;return await s.init(i),s}const tf="8.6.3";class ef{static init(){var t;(t=globalThis.__PIXI_APP_INIT__)==null||t.call(globalThis,this,tf)}static destroy(){}}ef.extension=Z.Application;class V_{constructor(t){this._renderer=t}init(){var t;(t=globalThis.__PIXI_RENDERER_INIT__)==null||t.call(globalThis,this._renderer,tf)}destroy(){this._renderer=null}}V_.extension={type:[Z.WebGLSystem,Z.WebGPUSystem],name:"initHook",priority:-10};const rf=class ho{constructor(...t){this.stage=new Qt,t[0]!==void 0&&wt(Rt,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.renderer=await H_(t),ho._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return wt(Rt,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,e=!1){const i=ho._plugins.slice(0);i.reverse(),i.forEach(s=>{s.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};rf._plugins=[];let sf=rf;Kt.handleByList(Z.Application,sf._plugins);Kt.add(ef);class nf extends me{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return wt(Rt,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return wt(Rt,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return wt(Rt,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return wt(Rt,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return wt(Rt,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){var e;this.emit("destroy",this),this.removeAllListeners();for(const i in this.chars)(e=this.chars[i].texture)==null||e.destroy();this.chars=null,t&&(this.pages.forEach(i=>i.texture.destroy(!0)),this.pages=null)}}const af=class lo{constructor(t,e,i,s){this.uid=Gt("fillGradient"),this.type="linear",this.gradientStops=[],this._styleKey=null,this.x0=t,this.y0=e,this.x1=i,this.y1=s}addColorStop(t,e){return this.gradientStops.push({offset:t,color:Nt.shared.setValue(e).toHexa()}),this._styleKey=null,this}buildLinearGradient(){if(this.texture)return;const t=lo.defaultTextureSize,{gradientStops:e}=this,i=Ft.get().createCanvas();i.width=t,i.height=t;const s=i.getContext("2d"),n=s.createLinearGradient(0,0,lo.defaultTextureSize,1);for(let y=0;y<e.length;y++){const p=e[y];n.addColorStop(p.offset,p.color)}s.fillStyle=n,s.fillRect(0,0,t,t),this.texture=new ht({source:new Dr({resource:i,addressModeU:"clamp-to-edge",addressModeV:"repeat"})});const{x0:a,y0:o,x1:h,y1:l}=this,c=new mt,u=h-a,f=l-o,d=Math.sqrt(u*u+f*f),g=Math.atan2(f,u);c.translate(-a,-o),c.scale(1/t,1/t),c.rotate(-g),c.scale(256/d,1),this.transform=c,this._styleKey=null}get styleKey(){if(this._styleKey)return this._styleKey;const t=this.gradientStops.map(s=>`${s.offset}-${s.color}`).join("-"),e=this.texture.uid,i=this.transform.toArray().join("-");return`fill-gradient-${this.uid}-${t}-${e}-${i}-${this.x0}-${this.y0}-${this.x1}-${this.y1}`}};af.defaultTextureSize=256;let vi=af;const Zl={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class Xs{constructor(t,e){this.uid=Gt("fillPattern"),this.transform=new mt,this._styleKey=null,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=Zl[e].addressModeU,t.source.style.addressModeV=Zl[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var Dn,Ql;function z_(){if(Ql)return Dn;Ql=1,Dn=e;var r={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function e(n){var a=[];return n.replace(t,function(o,h,l){var c=h.toLowerCase();for(l=s(l),c=="m"&&l.length>2&&(a.push([h].concat(l.splice(0,2))),c="l",h=h=="m"?"l":"L");;){if(l.length==r[c])return l.unshift(h),a.push(l);if(l.length<r[c])throw new Error("malformed path data");a.push([h].concat(l.splice(0,r[c])))}}),a}var i=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function s(n){var a=n.match(i);return a?a.map(Number):[]}return Dn}var X_=z_();const W_=Hs(X_);function j_(r,t){const e=W_(r),i=[];let s=null,n=0,a=0;for(let o=0;o<e.length;o++){const h=e[o],l=h[0],c=h;switch(l){case"M":n=c[1],a=c[2],t.moveTo(n,a);break;case"m":n+=c[1],a+=c[2],t.moveTo(n,a);break;case"H":n=c[1],t.lineTo(n,a);break;case"h":n+=c[1],t.lineTo(n,a);break;case"V":a=c[1],t.lineTo(n,a);break;case"v":a+=c[1],t.lineTo(n,a);break;case"L":n=c[1],a=c[2],t.lineTo(n,a);break;case"l":n+=c[1],a+=c[2],t.lineTo(n,a);break;case"C":n=c[5],a=c[6],t.bezierCurveTo(c[1],c[2],c[3],c[4],n,a);break;case"c":t.bezierCurveTo(n+c[1],a+c[2],n+c[3],a+c[4],n+c[5],a+c[6]),n+=c[5],a+=c[6];break;case"S":n=c[3],a=c[4],t.bezierCurveToShort(c[1],c[2],n,a);break;case"s":t.bezierCurveToShort(n+c[1],a+c[2],n+c[3],a+c[4]),n+=c[3],a+=c[4];break;case"Q":n=c[3],a=c[4],t.quadraticCurveTo(c[1],c[2],n,a);break;case"q":t.quadraticCurveTo(n+c[1],a+c[2],n+c[3],a+c[4]),n+=c[3],a+=c[4];break;case"T":n=c[1],a=c[2],t.quadraticCurveToShort(n,a);break;case"t":n+=c[1],a+=c[2],t.quadraticCurveToShort(n,a);break;case"A":n=c[6],a=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],n,a);break;case"a":n+=c[6],a+=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],n,a);break;case"Z":case"z":t.closePath(),i.length>0&&(s=i.pop(),s?(n=s.startX,a=s.startY):(n=0,a=0)),s=null;break;default:Ot(`Unknown SVG path command: ${l}`)}l!=="Z"&&l!=="z"&&s===null&&(s={startX:n,startY:a},i.push(s))}return t}class jo{constructor(t=0,e=0,i=0){this.type="circle",this.x=t,this.y=e,this.radius=i}clone(){return new jo(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const i=this.radius*this.radius;let s=this.x-t,n=this.y-e;return s*=s,n*=n,s+n<=i}strokeContains(t,e,i){if(this.radius===0)return!1;const s=this.x-t,n=this.y-e,a=this.radius,o=i/2,h=Math.sqrt(s*s+n*n);return h<a+o&&h>a-o}getBounds(t){return t||(t=new Yt),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Yo{constructor(t=0,e=0,i=0,s=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=i,this.halfHeight=s}clone(){return new Yo(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let i=(t-this.x)/this.halfWidth,s=(e-this.y)/this.halfHeight;return i*=i,s*=s,i+s<=1}strokeContains(t,e,i){const{halfWidth:s,halfHeight:n}=this;if(s<=0||n<=0)return!1;const a=i/2,o=s-a,h=n-a,l=s+a,c=n+a,u=t-this.x,f=e-this.y,d=u*u/(o*o)+f*f/(h*h),g=u*u/(l*l)+f*f/(c*c);return d>1&&g<=1}getBounds(t){return t||(t=new Yt),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function Y_(r,t,e,i,s,n){const a=r-e,o=t-i,h=s-e,l=n-i,c=a*h+o*l,u=h*h+l*l;let f=-1;u!==0&&(f=c/u);let d,g;f<0?(d=e,g=i):f>1?(d=s,g=n):(d=e+f*h,g=i+f*l);const y=r-d,p=t-g;return y*y+p*p}class pi{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const i=[];for(let s=0,n=e.length;s<n;s++)i.push(e[s].x,e[s].y);e=i}this.points=e,this.closePath=!0}clone(){const t=this.points.slice(),e=new pi(t);return e.closePath=this.closePath,e}contains(t,e){let i=!1;const s=this.points.length/2;for(let n=0,a=s-1;n<s;a=n++){const o=this.points[n*2],h=this.points[n*2+1],l=this.points[a*2],c=this.points[a*2+1];h>e!=c>e&&t<(l-o)*((e-h)/(c-h))+o&&(i=!i)}return i}strokeContains(t,e,i){const s=i/2,n=s*s,{points:a}=this,o=a.length-(this.closePath?0:2);for(let h=0;h<o;h+=2){const l=a[h],c=a[h+1],u=a[(h+2)%a.length],f=a[(h+3)%a.length];if(Y_(t,e,l,c,u,f)<=n)return!0}return!1}getBounds(t){t||(t=new Yt);const e=this.points;let i=1/0,s=-1/0,n=1/0,a=-1/0;for(let o=0,h=e.length;o<h;o+=2){const l=e[o],c=e[o+1];i=l<i?l:i,s=l>s?l:s,n=c<n?c:n,a=c>a?c:a}return t.x=i,t.width=s-i,t.y=n,t.height=a-n,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const Wi=(r,t,e,i,s,n)=>{const a=r-e,o=t-i,h=Math.sqrt(a*a+o*o);return h>=s-n&&h<=s+n};class qo{constructor(t=0,e=0,i=0,s=0,n=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=i,this.height=s,this.radius=n}getBounds(t){return t||(t=new Yt),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new qo(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let s=t-(this.x+i),n=e-(this.y+i);const a=i*i;if(s*s+n*n<=a||(s=t-(this.x+this.width-i),s*s+n*n<=a)||(n=e-(this.y+this.height-i),s*s+n*n<=a)||(s=t-(this.x+i),s*s+n*n<=a))return!0}return!1}strokeContains(t,e,i){const{x:s,y:n,width:a,height:o,radius:h}=this,l=i/2,c=s+h,u=n+h,f=a-h*2,d=o-h*2,g=s+a,y=n+o;return(t>=s-l&&t<=s+l||t>=g-l&&t<=g+l)&&e>=u&&e<=u+d||(e>=n-l&&e<=n+l||e>=y-l&&e<=y+l)&&t>=c&&t<=c+f?!0:t<c&&e<u&&Wi(t,e,c,u,h,l)||t>g-h&&e<u&&Wi(t,e,g-h,u,h,l)||t>g-h&&e>y-h&&Wi(t,e,g-h,y-h,h,l)||t<c&&e>y-h&&Wi(t,e,c,y-h,h,l)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const q_=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function K_(r){let t="";for(let e=0;e<r;++e)e>0&&(t+=`
else `),e<r-1&&(t+=`if(test == ${e}.0){}`);return t}function Z_(r,t){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);try{for(;;){const i=q_.replace(/%forloop%/gi,K_(r));if(t.shaderSource(e,i),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))r=r/2|0;else break}}finally{t.deleteShader(e)}return r}let xr=null;function of(){var t;if(xr)return xr;const r=$d();return xr=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),xr=Z_(xr,r),(t=r.getExtension("WEBGL_lose_context"))==null||t.loseContext(),xr}const hf={};function Q_(r,t){let e=2166136261;for(let i=0;i<t;i++)e^=r[i].uid,e=Math.imul(e,16777619),e>>>=0;return hf[e]||J_(r,t,e)}let $n=0;function J_(r,t,e){const i={};let s=0;$n||($n=of());for(let a=0;a<$n;a++){const o=a<t?r[a]:ht.EMPTY.source;i[s++]=o.source,i[s++]=o.style}const n=new ps(i);return hf[e]=n,n}let Jl=class{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}};function tc(r,t){const e=r.byteLength/8|0,i=new Float64Array(r,0,e);new Float64Array(t,0,e).set(i);const n=r.byteLength-e*8;if(n>0){const a=new Uint8Array(r,e*8,n);new Uint8Array(t,e*8,n).set(a)}}const t0={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var e0=(r=>(r[r.DISABLED=0]="DISABLED",r[r.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",r[r.MASK_ACTIVE=2]="MASK_ACTIVE",r[r.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",r[r.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",r[r.NONE=5]="NONE",r))(e0||{});function ec(r,t){return t.alphaMode==="no-premultiply-alpha"&&t0[r]||r}let r0=class{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}};class i0{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new r0,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const lf=[];let co=0;function rc(){return co>0?lf[--co]:new i0}function ic(r){lf[co++]=r}let Zr=0;const cf=class ms{constructor(t={}){this.uid=Gt("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],ms.defaultOptions.maxTextures=ms.defaultOptions.maxTextures??of(),t={...ms.defaultOptions,...t};const{maxTextures:e,attributesInitialSize:i,indicesInitialSize:s}=t;this.attributeBuffer=new Jl(i*4),this.indexBuffer=new Uint16Array(s),this.maxTextures=e}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)ic(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,e){const i=t._batch.textures.ids[e._source.uid];return!i&&i!==0?!1:(t._textureId=i,t.texture=e,!0)}updateElement(t){this.dirty=!0;const e=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId)}break(t){const e=this._elements;if(!e[this.elementStart])return;let i=rc(),s=i.textures;s.clear();const n=e[this.elementStart];let a=ec(n.blendMode,n.texture._source),o=n.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const h=this.attributeBuffer.float32View,l=this.attributeBuffer.uint32View,c=this.indexBuffer;let u=this._batchIndexSize,f=this._batchIndexStart,d="startBatch";const g=this.maxTextures;for(let y=this.elementStart;y<this.elementSize;++y){const p=e[y];e[y]=null;const _=p.texture._source,v=ec(p.blendMode,_),A=a!==v||o!==p.topology;if(_._batchTick===Zr&&!A){p._textureId=_._textureBindLocation,u+=p.indexSize,p.packAsQuad?(this.packQuadAttributes(p,h,l,p._attributeStart,p._textureId),this.packQuadIndex(c,p._indexStart,p._attributeStart/this.vertexSize)):(this.packAttributes(p,h,l,p._attributeStart,p._textureId),this.packIndex(p,c,p._indexStart,p._attributeStart/this.vertexSize)),p._batch=i;continue}_._batchTick=Zr,(s.count>=g||A)&&(this._finishBatch(i,f,u-f,s,a,o,t,d),d="renderBatch",f=u,a=v,o=p.topology,i=rc(),s=i.textures,s.clear(),++Zr),p._textureId=_._textureBindLocation=s.count,s.ids[_.uid]=s.count,s.textures[s.count++]=_,p._batch=i,u+=p.indexSize,p.packAsQuad?(this.packQuadAttributes(p,h,l,p._attributeStart,p._textureId),this.packQuadIndex(c,p._indexStart,p._attributeStart/this.vertexSize)):(this.packAttributes(p,h,l,p._attributeStart,p._textureId),this.packIndex(p,c,p._indexStart,p._attributeStart/this.vertexSize))}s.count>0&&(this._finishBatch(i,f,u-f,s,a,o,t,d),f=u,++Zr),this.elementStart=this.elementSize,this._batchIndexStart=f,this._batchIndexSize=u}_finishBatch(t,e,i,s,n,a,o,h){t.gpuBindGroup=null,t.bindGroup=null,t.action=h,t.batcher=this,t.textures=s,t.blendMode=n,t.topology=a,t.start=e,t.size=i,++Zr,this.batches[this.batchIndex++]=t,o.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,this.attributeBuffer.size*2),i=new Jl(e);tc(this.attributeBuffer.rawBinaryData,i.rawBinaryData),this.attributeBuffer=i}_resizeIndexBuffer(t){const e=this.indexBuffer;let i=Math.max(t,e.length*1.5);i+=i%2;const s=i>65535?new Uint32Array(i):new Uint16Array(i);if(s.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let n=0;n<e.length;n++)s[n]=e[n];else tc(e.buffer,s.buffer);this.indexBuffer=s}packQuadIndex(t,e,i){t[e]=i+0,t[e+1]=i+1,t[e+2]=i+2,t[e+3]=i+0,t[e+4]=i+2,t[e+5]=i+3}packIndex(t,e,i,s){const n=t.indices,a=t.indexSize,o=t.indexOffset,h=t.attributeOffset;for(let l=0;l<a;l++)e[i++]=s+n[l+o]-h}destroy(){for(let t=0;t<this.batches.length;t++)ic(this.batches[t]);this.batches=null;for(let t=0;t<this._elements.length;t++)this._elements[t]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};cf.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let s0=cf;var Lt=(r=>(r[r.MAP_READ=1]="MAP_READ",r[r.MAP_WRITE=2]="MAP_WRITE",r[r.COPY_SRC=4]="COPY_SRC",r[r.COPY_DST=8]="COPY_DST",r[r.INDEX=16]="INDEX",r[r.VERTEX=32]="VERTEX",r[r.UNIFORM=64]="UNIFORM",r[r.STORAGE=128]="STORAGE",r[r.INDIRECT=256]="INDIRECT",r[r.QUERY_RESOLVE=512]="QUERY_RESOLVE",r[r.STATIC=1024]="STATIC",r))(Lt||{});let De=class extends me{constructor(t){let{data:e,size:i}=t;const{usage:s,label:n,shrinkToFit:a}=t;super(),this.uid=Gt("buffer"),this._resourceType="buffer",this._resourceId=Gt("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,e instanceof Array&&(e=new Float32Array(e)),this._data=e,i??(i=e==null?void 0:e.byteLength);const o=!!e;this.descriptor={size:i,usage:s,mappedAtCreation:o,label:n},this.shrinkToFit=a??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&Lt.STATIC)}set static(t){t?this.descriptor.usage|=Lt.STATIC:this.descriptor.usage&=~Lt.STATIC}setDataWithSize(t,e,i){if(this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t){i&&this.emit("update",this);return}const s=this._data;if(this._data=t,this._dataInt32=null,!s||s.length!==t.length){!this.shrinkToFit&&s&&t.byteLength<s.byteLength?i&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=Gt("resource"),this.emit("change",this));return}i&&this.emit("update",this)}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}};function uf(r,t){if(!(r instanceof De)){let e=t?Lt.INDEX:Lt.VERTEX;r instanceof Array&&(t?(r=new Uint32Array(r),e=Lt.INDEX|Lt.COPY_DST):(r=new Float32Array(r),e=Lt.VERTEX|Lt.COPY_DST)),r=new De({data:r,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:e})}return r}function n0(r,t,e){const i=r.getAttribute(t);if(!i)return e.minX=0,e.minY=0,e.maxX=0,e.maxY=0,e;const s=i.buffer.data;let n=1/0,a=1/0,o=-1/0,h=-1/0;const l=s.BYTES_PER_ELEMENT,c=(i.offset||0)/l,u=(i.stride||2*4)/l;for(let f=c;f<s.length;f+=u){const d=s[f],g=s[f+1];d>o&&(o=d),g>h&&(h=g),d<n&&(n=d),g<a&&(a=g)}return e.minX=n,e.minY=a,e.maxX=o,e.maxY=h,e}function a0(r){return(r instanceof De||Array.isArray(r)||r.BYTES_PER_ELEMENT)&&(r={buffer:r}),r.buffer=uf(r.buffer,!1),r}let Ko=class extends me{constructor(t={}){super(),this.uid=Gt("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new He,this._boundsDirty=!0;const{attributes:e,indexBuffer:i,topology:s}=t;if(this.buffers=[],this.attributes={},e)for(const n in e)this.addAttribute(n,e[n]);this.instanceCount=t.instanceCount??1,i&&this.addIndex(i),this.topology=s||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return e.buffer.data.length/(e.stride/4||e.size)}return 0}addAttribute(t,e){const i=a0(e);this.buffers.indexOf(i.buffer)===-1&&(this.buffers.push(i.buffer),i.buffer.on("update",this.onBufferUpdate,this),i.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=i}addIndex(t){this.indexBuffer=uf(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,n0(this,"aPosition",this._bounds)):this._bounds}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(e=>e.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}};const o0=new Float32Array(1),h0=new Uint32Array(1);let l0=class extends Ko{constructor(){const e=new De({data:o0,label:"attribute-batch-buffer",usage:Lt.VERTEX|Lt.COPY_DST,shrinkToFit:!1}),i=new De({data:h0,label:"index-batch-buffer",usage:Lt.INDEX|Lt.COPY_DST,shrinkToFit:!1}),s=6*4;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:s,offset:0},aUV:{buffer:e,format:"float32x2",stride:s,offset:2*4},aColor:{buffer:e,format:"unorm8x4",stride:s,offset:4*4},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:s,offset:5*4}},indexBuffer:i})}};function sc(r,t,e){if(r)for(const i in r){const s=i.toLocaleLowerCase(),n=t[s];if(n){let a=r[i];i==="header"&&(a=a.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),e&&n.push(`//----${e}----//`),n.push(a)}else Ot(`${i} placement hook does not exist in shader`)}}const c0=/\{\{(.*?)\}\}/g;function nc(r){var i;const t={};return(((i=r.match(c0))==null?void 0:i.map(s=>s.replace(/[{()}]/g,"")))??[]).forEach(s=>{t[s]=[]}),t}function ac(r,t){let e;const i=/@in\s+([^;]+);/g;for(;(e=i.exec(r))!==null;)t.push(e[1])}function oc(r,t,e=!1){const i=[];ac(t,i),r.forEach(o=>{o.header&&ac(o.header,i)});const s=i;e&&s.sort();const n=s.map((o,h)=>`       @location(${h}) ${o},`).join(`
`);let a=t.replace(/@in\s+[^;]+;\s*/g,"");return a=a.replace("{{in}}",`
${n}
`),a}function hc(r,t){let e;const i=/@out\s+([^;]+);/g;for(;(e=i.exec(r))!==null;)t.push(e[1])}function u0(r){const e=/\b(\w+)\s*:/g.exec(r);return e?e[1]:""}function d0(r){const t=/@.*?\s+/g;return r.replace(t,"")}function f0(r,t){const e=[];hc(t,e),r.forEach(h=>{h.header&&hc(h.header,e)});let i=0;const s=e.sort().map(h=>h.indexOf("builtin")>-1?h:`@location(${i++}) ${h}`).join(`,
`),n=e.sort().map(h=>`       var ${d0(h)};`).join(`
`),a=`return VSOutput(
                ${e.sort().map(h=>` ${u0(h)}`).join(`,
`)});`;let o=t.replace(/@out\s+[^;]+;\s*/g,"");return o=o.replace("{{struct}}",`
${s}
`),o=o.replace("{{start}}",`
${n}
`),o=o.replace("{{return}}",`
${a}
`),o}function lc(r,t){let e=r;for(const i in t){const s=t[i];s.join(`
`).length?e=e.replace(`{{${i}}}`,`//-----${i} START-----//
${s.join(`
`)}
//----${i} FINISH----//`):e=e.replace(`{{${i}}}`,"")}return e}const Ue=Object.create(null),Hn=new Map;let p0=0;function m0({template:r,bits:t}){const e=df(r,t);if(Ue[e])return Ue[e];const{vertex:i,fragment:s}=y0(r,t);return Ue[e]=ff(i,s,t),Ue[e]}function g0({template:r,bits:t}){const e=df(r,t);return Ue[e]||(Ue[e]=ff(r.vertex,r.fragment,t)),Ue[e]}function y0(r,t){const e=t.map(a=>a.vertex).filter(a=>!!a),i=t.map(a=>a.fragment).filter(a=>!!a);let s=oc(e,r.vertex,!0);s=f0(e,s);const n=oc(i,r.fragment,!0);return{vertex:s,fragment:n}}function df(r,t){return t.map(e=>(Hn.has(e)||Hn.set(e,p0++),Hn.get(e))).sort((e,i)=>e-i).join("-")+r.vertex+r.fragment}function ff(r,t,e){const i=nc(r),s=nc(t);return e.forEach(n=>{sc(n.vertex,i,n.name),sc(n.fragment,s,n.name)}),{vertex:lc(r,i),fragment:lc(t,s)}}const _0=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}
        
        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);
       
        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,x0=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;
   
    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {
        
        {{start}}

        var outColor:vec4<f32>;
      
        {{main}}
        
        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,v0=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;
        
        {{start}}
        
        vColor = vec4(1.);
        
        {{main}}
        
        vUV = uv;
        
        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,b0=`
   
    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {
        
        {{start}}

        vec4 outColor;
      
        {{main}}
        
        finalColor = outColor * vColor;
        
        {{end}}
    }
`,w0={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},A0={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function T0({bits:r,name:t}){const e=m0({template:{fragment:x0,vertex:_0},bits:[w0,...r]});return zs.from({name:t,vertex:{source:e.vertex,entryPoint:"main"},fragment:{source:e.fragment,entryPoint:"main"}})}function S0({bits:r,name:t}){return new Vd({name:t,...g0({template:{vertex:v0,fragment:b0},bits:[A0,...r]})})}const C0={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},E0={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},Vn={};function I0(r){const t=[];if(r===1)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let e=0;for(let i=0;i<r;i++)t.push(`@group(1) @binding(${e++}) var textureSource${i+1}: texture_2d<f32>;`),t.push(`@group(1) @binding(${e++}) var textureSampler${i+1}: sampler;`)}return t.join(`
`)}function P0(r){const t=[];if(r===1)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(let e=0;e<r;e++)e===r-1?t.push("  default:{"):t.push(`  case ${e}:{`),t.push(`      outColor = textureSampleGrad(textureSource${e+1}, textureSampler${e+1}, vUV, uvDx, uvDy);`),t.push("      break;}");t.push("}")}return t.join(`
`)}function R0(r){return Vn[r]||(Vn[r]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${I0(r)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${P0(r)}
            `}}),Vn[r]}const zn={};function M0(r){const t=[];for(let e=0;e<r;e++)e>0&&t.push("else"),e<r-1&&t.push(`if(vTextureId < ${e}.5)`),t.push("{"),t.push(`	outColor = texture(uTextures[${e}], vUV);`),t.push("}");return t.join(`
`)}function F0(r){return zn[r]||(zn[r]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${r}];

            `,main:`

                ${M0(r)}
            `}}),zn[r]}const k0={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> 
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},B0={name:"round-pixels-bit",vertex:{header:`   
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {       
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},cc={};function L0(r){let t=cc[r];if(t)return t;const e=new Int32Array(r);for(let i=0;i<r;i++)e[i]=i;return t=cc[r]=new jd({uTextures:{value:e,type:"i32",size:r}},{isStatic:!0}),t}class N0 extends R_{constructor(t){const e=S0({name:"batch",bits:[E0,F0(t),B0]}),i=T0({name:"batch",bits:[C0,R0(t),k0]});super({glProgram:e,gpuProgram:i,resources:{batchSamplers:L0(t)}})}}let uc=null;const pf=class mf extends s0{constructor(){super(...arguments),this.geometry=new l0,this.shader=uc||(uc=new N0(this.maxTextures)),this.name=mf.extension.name,this.vertexSize=6}packAttributes(t,e,i,s,n){const a=n<<16|t.roundPixels&65535,o=t.transform,h=o.a,l=o.b,c=o.c,u=o.d,f=o.tx,d=o.ty,{positions:g,uvs:y}=t,p=t.color,m=t.attributeOffset,_=m+t.attributeSize;for(let v=m;v<_;v++){const A=v*2,x=g[A],S=g[A+1];e[s++]=h*x+c*S+f,e[s++]=u*S+l*x+d,e[s++]=y[A],e[s++]=y[A+1],i[s++]=p,i[s++]=a}}packQuadAttributes(t,e,i,s,n){const a=t.texture,o=t.transform,h=o.a,l=o.b,c=o.c,u=o.d,f=o.tx,d=o.ty,g=t.bounds,y=g.maxX,p=g.minX,m=g.maxY,_=g.minY,v=a.uvs,A=t.color,x=n<<16|t.roundPixels&65535;e[s+0]=h*p+c*_+f,e[s+1]=u*_+l*p+d,e[s+2]=v.x0,e[s+3]=v.y0,i[s+4]=A,i[s+5]=x,e[s+6]=h*y+c*_+f,e[s+7]=u*_+l*y+d,e[s+8]=v.x1,e[s+9]=v.y1,i[s+10]=A,i[s+11]=x,e[s+12]=h*y+c*m+f,e[s+13]=u*m+l*y+d,e[s+14]=v.x2,e[s+15]=v.y2,i[s+16]=A,i[s+17]=x,e[s+18]=h*p+c*m+f,e[s+19]=u*m+l*p+d,e[s+20]=v.x3,e[s+21]=v.y3,i[s+22]=A,i[s+23]=x}};pf.extension={type:[Z.Batcher],name:"default"};let O0=pf;function U0(r,t,e,i,s,n,a,o=null){let h=0;e*=t,s*=n;const l=o.a,c=o.b,u=o.c,f=o.d,d=o.tx,g=o.ty;for(;h<a;){const y=r[e],p=r[e+1];i[s]=l*y+u*p+d,i[s+1]=c*y+f*p+g,s+=n,e+=t,h++}}function G0(r,t,e,i){let s=0;for(t*=e;s<i;)r[t]=0,r[t+1]=0,t+=e,s++}function gf(r,t,e,i,s){const n=t.a,a=t.b,o=t.c,h=t.d,l=t.tx,c=t.ty;e||(e=0),i||(i=2),s||(s=r.length/i-e);let u=e*i;for(let f=0;f<s;f++){const d=r[u],g=r[u+1];r[u]=n*d+o*g+l,r[u+1]=a*d+h*g+c,u+=i}}const D0=new mt;class yf{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|t&65280|(t&255)<<16,i=this.renderable;return i?vd(e,i.groupColor)+(this.alpha*i.groupAlpha*255<<24):e+(this.alpha*255<<24)}get transform(){var t;return((t=this.renderable)==null?void 0:t.groupTransform)||D0}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const bi={extension:{type:Z.ShapeBuilder,name:"circle"},build(r,t){let e,i,s,n,a,o;if(r.type==="circle"){const A=r;e=A.x,i=A.y,a=o=A.radius,s=n=0}else if(r.type==="ellipse"){const A=r;e=A.x,i=A.y,a=A.halfWidth,o=A.halfHeight,s=n=0}else{const A=r,x=A.width/2,S=A.height/2;e=A.x+x,i=A.y+S,a=o=Math.max(0,Math.min(A.radius,Math.min(x,S))),s=x-a,n=S-o}if(!(a>=0&&o>=0&&s>=0&&n>=0))return t;const h=Math.ceil(2.3*Math.sqrt(a+o)),l=h*8+(s?4:0)+(n?4:0);if(l===0)return t;if(h===0)return t[0]=t[6]=e+s,t[1]=t[3]=i+n,t[2]=t[4]=e-s,t[5]=t[7]=i-n,t;let c=0,u=h*4+(s?2:0)+2,f=u,d=l,g=s+a,y=n,p=e+g,m=e-g,_=i+y;if(t[c++]=p,t[c++]=_,t[--u]=_,t[--u]=m,n){const A=i-y;t[f++]=m,t[f++]=A,t[--d]=A,t[--d]=p}for(let A=1;A<h;A++){const x=Math.PI/2*(A/h),S=s+Math.cos(x)*a,b=n+Math.sin(x)*o,B=e+S,G=e-S,L=i+b,O=i-b;t[c++]=B,t[c++]=L,t[--u]=L,t[--u]=G,t[f++]=G,t[f++]=O,t[--d]=O,t[--d]=B}g=s,y=n+o,p=e+g,m=e-g,_=i+y;const v=i-y;return t[c++]=p,t[c++]=_,t[--d]=v,t[--d]=p,s&&(t[c++]=m,t[c++]=_,t[--d]=v,t[--d]=m),t},triangulate(r,t,e,i,s,n){if(r.length===0)return;let a=0,o=0;for(let c=0;c<r.length;c+=2)a+=r[c],o+=r[c+1];a/=r.length/2,o/=r.length/2;let h=i;t[h*e]=a,t[h*e+1]=o;const l=h++;for(let c=0;c<r.length;c+=2)t[h*e]=r[c],t[h*e+1]=r[c+1],c>0&&(s[n++]=h,s[n++]=l,s[n++]=h-1),h++;s[n++]=l+1,s[n++]=l,s[n++]=h-1}},$0={...bi,extension:{...bi.extension,name:"ellipse"}},H0={...bi,extension:{...bi.extension,name:"roundedRectangle"}},_f=1e-4,dc=1e-4;function V0(r){const t=r.length;if(t<6)return 1;let e=0;for(let i=0,s=r[t-2],n=r[t-1];i<t;i+=2){const a=r[i],o=r[i+1];e+=(a-s)*(o+n),s=a,n=o}return e<0?-1:1}function fc(r,t,e,i,s,n,a,o){const h=r-e*s,l=t-i*s,c=r+e*n,u=t+i*n;let f,d;a?(f=i,d=-e):(f=-i,d=e);const g=h+f,y=l+d,p=c+f,m=u+d;return o.push(g,y),o.push(p,m),2}function Xe(r,t,e,i,s,n,a,o){const h=e-r,l=i-t;let c=Math.atan2(h,l),u=Math.atan2(s-r,n-t);o&&c<u?c+=Math.PI*2:!o&&c>u&&(u+=Math.PI*2);let f=c;const d=u-c,g=Math.abs(d),y=Math.sqrt(h*h+l*l),p=(15*g*Math.sqrt(y)/Math.PI>>0)+1,m=d/p;if(f+=m,o){a.push(r,t),a.push(e,i);for(let _=1,v=f;_<p;_++,v+=m)a.push(r,t),a.push(r+Math.sin(v)*y,t+Math.cos(v)*y);a.push(r,t),a.push(s,n)}else{a.push(e,i),a.push(r,t);for(let _=1,v=f;_<p;_++,v+=m)a.push(r+Math.sin(v)*y,t+Math.cos(v)*y),a.push(r,t);a.push(s,n),a.push(r,t)}return p*2}function z0(r,t,e,i,s,n){const a=_f;if(r.length===0)return;const o=t;let h=o.alignment;if(t.alignment!==.5){let P=V0(r);h=(h-.5)*P+.5}const l=new jt(r[0],r[1]),c=new jt(r[r.length-2],r[r.length-1]),u=i,f=Math.abs(l.x-c.x)<a&&Math.abs(l.y-c.y)<a;if(u){r=r.slice(),f&&(r.pop(),r.pop(),c.set(r[r.length-2],r[r.length-1]));const P=(l.x+c.x)*.5,E=(c.y+l.y)*.5;r.unshift(P,E),r.push(P,E)}const d=s,g=r.length/2;let y=r.length;const p=d.length/2,m=o.width/2,_=m*m,v=o.miterLimit*o.miterLimit;let A=r[0],x=r[1],S=r[2],b=r[3],B=0,G=0,L=-(x-b),O=A-S,N=0,j=0,J=Math.sqrt(L*L+O*O);L/=J,O/=J,L*=m,O*=m;const rt=h,w=(1-rt)*2,C=rt*2;u||(o.cap==="round"?y+=Xe(A-L*(w-C)*.5,x-O*(w-C)*.5,A-L*w,x-O*w,A+L*C,x+O*C,d,!0)+2:o.cap==="square"&&(y+=fc(A,x,L,O,w,C,!0,d))),d.push(A-L*w,x-O*w),d.push(A+L*C,x+O*C);for(let P=1;P<g-1;++P){A=r[(P-1)*2],x=r[(P-1)*2+1],S=r[P*2],b=r[P*2+1],B=r[(P+1)*2],G=r[(P+1)*2+1],L=-(x-b),O=A-S,J=Math.sqrt(L*L+O*O),L/=J,O/=J,L*=m,O*=m,N=-(b-G),j=S-B,J=Math.sqrt(N*N+j*j),N/=J,j/=J,N*=m,j*=m;const E=S-A,I=x-b,R=S-B,F=G-b,U=E*R+I*F,D=I*R-F*E,H=D<0;if(Math.abs(D)<.001*Math.abs(U)){d.push(S-L*w,b-O*w),d.push(S+L*C,b+O*C),U>=0&&(o.join==="round"?y+=Xe(S,b,S-L*w,b-O*w,S-N*w,b-j*w,d,!1)+4:y+=2,d.push(S-N*C,b-j*C),d.push(S+N*w,b+j*w));continue}const X=(-L+A)*(-O+b)-(-L+S)*(-O+x),W=(-N+B)*(-j+b)-(-N+S)*(-j+G),q=(E*W-R*X)/D,z=(F*X-I*W)/D,it=(q-S)*(q-S)+(z-b)*(z-b),st=S+(q-S)*w,gt=b+(z-b)*w,ft=S-(q-S)*C,K=b-(z-b)*C,tt=Math.min(E*E+I*I,R*R+F*F),zt=H?w:C,Xr=tt+zt*zt*_;it<=Xr?o.join==="bevel"||it/_>v?(H?(d.push(st,gt),d.push(S+L*C,b+O*C),d.push(st,gt),d.push(S+N*C,b+j*C)):(d.push(S-L*w,b-O*w),d.push(ft,K),d.push(S-N*w,b-j*w),d.push(ft,K)),y+=2):o.join==="round"?H?(d.push(st,gt),d.push(S+L*C,b+O*C),y+=Xe(S,b,S+L*C,b+O*C,S+N*C,b+j*C,d,!0)+4,d.push(st,gt),d.push(S+N*C,b+j*C)):(d.push(S-L*w,b-O*w),d.push(ft,K),y+=Xe(S,b,S-L*w,b-O*w,S-N*w,b-j*w,d,!1)+4,d.push(S-N*w,b-j*w),d.push(ft,K)):(d.push(st,gt),d.push(ft,K)):(d.push(S-L*w,b-O*w),d.push(S+L*C,b+O*C),o.join==="round"?H?y+=Xe(S,b,S+L*C,b+O*C,S+N*C,b+j*C,d,!0)+2:y+=Xe(S,b,S-L*w,b-O*w,S-N*w,b-j*w,d,!1)+2:o.join==="miter"&&it/_<=v&&(H?(d.push(ft,K),d.push(ft,K)):(d.push(st,gt),d.push(st,gt)),y+=2),d.push(S-N*w,b-j*w),d.push(S+N*C,b+j*C),y+=2)}A=r[(g-2)*2],x=r[(g-2)*2+1],S=r[(g-1)*2],b=r[(g-1)*2+1],L=-(x-b),O=A-S,J=Math.sqrt(L*L+O*O),L/=J,O/=J,L*=m,O*=m,d.push(S-L*w,b-O*w),d.push(S+L*C,b+O*C),u||(o.cap==="round"?y+=Xe(S-L*(w-C)*.5,b-O*(w-C)*.5,S-L*w,b-O*w,S+L*C,b+O*C,d,!1)+2:o.cap==="square"&&(y+=fc(S,b,L,O,w,C,!1,d)));const T=dc*dc;for(let P=p;P<y+p-2;++P)A=d[P*2],x=d[P*2+1],S=d[(P+1)*2],b=d[(P+1)*2+1],B=d[(P+2)*2],G=d[(P+2)*2+1],!(Math.abs(A*(b-G)+S*(G-x)+B*(x-b))<T)&&n.push(P,P+1,P+2)}function X0(r,t,e,i){const s=_f;if(r.length===0)return;const n=r[0],a=r[1],o=r[r.length-2],h=r[r.length-1],l=t||Math.abs(n-o)<s&&Math.abs(a-h)<s,c=e,u=r.length/2,f=c.length/2;for(let d=0;d<u;d++)c.push(r[d*2]),c.push(r[d*2+1]);for(let d=0;d<u-1;d++)i.push(f+d,f+d+1);l&&i.push(f+u-1,f)}function xf(r,t,e,i,s,n,a){const o=O_(r,t,2);if(!o)return;for(let l=0;l<o.length;l+=3)n[a++]=o[l]+s,n[a++]=o[l+1]+s,n[a++]=o[l+2]+s;let h=s*i;for(let l=0;l<r.length;l+=2)e[h]=r[l],e[h+1]=r[l+1],h+=i}const W0=[],j0={extension:{type:Z.ShapeBuilder,name:"polygon"},build(r,t){for(let e=0;e<r.points.length;e++)t[e]=r.points[e];return t},triangulate(r,t,e,i,s,n){xf(r,W0,t,e,i,s,n)}},Y0={extension:{type:Z.ShapeBuilder,name:"rectangle"},build(r,t){const e=r,i=e.x,s=e.y,n=e.width,a=e.height;return n>=0&&a>=0&&(t[0]=i,t[1]=s,t[2]=i+n,t[3]=s,t[4]=i+n,t[5]=s+a,t[6]=i,t[7]=s+a),t},triangulate(r,t,e,i,s,n){let a=0;i*=e,t[i+a]=r[0],t[i+a+1]=r[1],a+=e,t[i+a]=r[2],t[i+a+1]=r[3],a+=e,t[i+a]=r[6],t[i+a+1]=r[7],a+=e,t[i+a]=r[4],t[i+a+1]=r[5],a+=e;const o=i/e;s[n++]=o,s[n++]=o+1,s[n++]=o+2,s[n++]=o+1,s[n++]=o+3,s[n++]=o+2}},q0={extension:{type:Z.ShapeBuilder,name:"triangle"},build(r,t){return t[0]=r.x,t[1]=r.y,t[2]=r.x2,t[3]=r.y2,t[4]=r.x3,t[5]=r.y3,t},triangulate(r,t,e,i,s,n){let a=0;i*=e,t[i+a]=r[0],t[i+a+1]=r[1],a+=e,t[i+a]=r[2],t[i+a+1]=r[3],a+=e,t[i+a]=r[4],t[i+a+1]=r[5];const o=i/e;s[n++]=o,s[n++]=o+1,s[n++]=o+2}},Ws={};Kt.handleByMap(Z.ShapeBuilder,Ws);Kt.add(Y0,j0,q0,bi,$0,H0);const K0=new Yt;function Z0(r,t){const{geometryData:e,batches:i}=t;i.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let s=0;s<r.instructions.length;s++){const n=r.instructions[s];if(n.action==="texture")Q0(n.data,i,e);else if(n.action==="fill"||n.action==="stroke"){const a=n.action==="stroke",o=n.data.path.shapePath,h=n.data.style,l=n.data.hole;a&&l&&pc(l.shapePath,h,null,!0,i,e),pc(o,h,l,a,i,e)}}}function Q0(r,t,e){const{vertices:i,uvs:s,indices:n}=e,a=n.length,o=i.length/2,h=[],l=Ws.rectangle,c=K0,u=r.image;c.x=r.dx,c.y=r.dy,c.width=r.dw,c.height=r.dh;const f=r.transform;l.build(c,h),f&&gf(h,f),l.triangulate(h,i,2,o,n,a);const d=u.uvs;s.push(d.x0,d.y0,d.x1,d.y1,d.x3,d.y3,d.x2,d.y2);const g=Pe.get(yf);g.indexOffset=a,g.indexSize=n.length-a,g.attributeOffset=o,g.attributeSize=i.length/2-o,g.baseColor=r.style,g.alpha=r.alpha,g.texture=u,g.geometryData=e,t.push(g)}function pc(r,t,e,i,s,n){const{vertices:a,uvs:o,indices:h}=n,l=r.shapePrimitives.length-1;r.shapePrimitives.forEach(({shape:c,transform:u},f)=>{const d=h.length,g=a.length/2,y=[],p=Ws[c.type];let m="triangle-list";if(p.build(c,y),u&&gf(y,u),i){const x=c.closePath??!0,S=t;S.pixelLine?(X0(y,x,a,h),m="line-list"):z0(y,S,!1,x,a,h)}else if(e&&l===f){l!==0&&console.warn("[Pixi Graphics] only the last shape have be cut out");const x=[],S=y.slice();J0(e.shapePath).forEach(B=>{x.push(S.length/2),S.push(...B)}),xf(S,x,a,2,g,h,d)}else p.triangulate(y,a,2,g,h,d);const _=o.length/2,v=t.texture;if(v!==ht.WHITE){const x=t.matrix;x&&(u&&x.append(u.clone().invert()),U0(a,2,g,o,_,2,a.length/2-g,x))}else G0(o,_,2,a.length/2-g);const A=Pe.get(yf);A.indexOffset=d,A.indexSize=h.length-d,A.attributeOffset=g,A.attributeSize=a.length/2-g,A.baseColor=t.color,A.alpha=t.alpha,A.texture=v,A.geometryData=n,A.topology=m,s.push(A)})}function J0(r){if(!r)return[];const t=r.shapePrimitives,e=[];for(let i=0;i<t.length;i++){const s=t[i].shape,n=[];Ws[s.type].build(s,n),e.push(n)}return e}class tx{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class ex{constructor(){this.batcher=new O0,this.instructions=new Td}init(){this.instructions.reset()}get geometry(){return wt(by,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const Zo=class uo{constructor(t){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(t){uo.defaultOptions.bezierSmoothness=(t==null?void 0:t.bezierSmoothness)??uo.defaultOptions.bezierSmoothness}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),Z0(t,e);const i=t.batchMode;t.customShader||i==="no-batch"?e.isBatchable=!1:i==="auto"&&(e.isBatchable=e.geometryData.vertices.length<400),t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_initContextRenderData(t){const e=Pe.get(ex),{batches:i,geometryData:s}=this._gpuContextHash[t.uid],n=s.vertices.length,a=s.indices.length;for(let c=0;c<i.length;c++)i[c].applyTransform=!1;const o=e.batcher;o.ensureAttributeBuffer(n),o.ensureIndexBuffer(a),o.begin();for(let c=0;c<i.length;c++){const u=i[c];o.add(u)}o.finish(e.instructions);const h=o.geometry;h.indexBuffer.setDataWithSize(o.indexBuffer,o.indexSize,!0),h.buffers[0].setDataWithSize(o.attributeBuffer.float32View,o.attributeSize,!0);const l=o.batches;for(let c=0;c<l.length;c++){const u=l[c];u.bindGroup=Q_(u.textures.textures,u.textures.count)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new tx;return e.context=t,this._gpuContextHash[t.uid]=e,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(Pe.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach(i=>{Pe.return(i)})}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context)}};Zo.extension={type:[Z.WebGLSystem,Z.WebGPUSystem,Z.CanvasSystem],name:"graphicsContext"};Zo.defaultOptions={bezierSmoothness:.5};let vf=Zo;const rx=8,ji=11920929e-14,ix=1;function bf(r,t,e,i,s,n,a,o,h,l){const u=Math.min(.99,Math.max(0,l??vf.defaultOptions.bezierSmoothness));let f=(ix-u)/1;return f*=f,sx(t,e,i,s,n,a,o,h,r,f),r}function sx(r,t,e,i,s,n,a,o,h,l){fo(r,t,e,i,s,n,a,o,h,l,0),h.push(a,o)}function fo(r,t,e,i,s,n,a,o,h,l,c){if(c>rx)return;const u=(r+e)/2,f=(t+i)/2,d=(e+s)/2,g=(i+n)/2,y=(s+a)/2,p=(n+o)/2,m=(u+d)/2,_=(f+g)/2,v=(d+y)/2,A=(g+p)/2,x=(m+v)/2,S=(_+A)/2;if(c>0){let b=a-r,B=o-t;const G=Math.abs((e-a)*B-(i-o)*b),L=Math.abs((s-a)*B-(n-o)*b);if(G>ji&&L>ji){if((G+L)*(G+L)<=l*(b*b+B*B)){h.push(x,S);return}}else if(G>ji){if(G*G<=l*(b*b+B*B)){h.push(x,S);return}}else if(L>ji){if(L*L<=l*(b*b+B*B)){h.push(x,S);return}}else if(b=x-(r+a)/2,B=S-(t+o)/2,b*b+B*B<=l){h.push(x,S);return}}fo(r,t,u,f,m,_,x,S,h,l,c+1),fo(x,S,v,A,y,p,a,o,h,l,c+1)}const nx=8,ax=11920929e-14,ox=1;function hx(r,t,e,i,s,n,a,o){const l=Math.min(.99,Math.max(0,o??vf.defaultOptions.bezierSmoothness));let c=(ox-l)/1;return c*=c,lx(t,e,i,s,n,a,r,c),r}function lx(r,t,e,i,s,n,a,o){po(a,r,t,e,i,s,n,o,0),a.push(s,n)}function po(r,t,e,i,s,n,a,o,h){if(h>nx)return;const l=(t+i)/2,c=(e+s)/2,u=(i+n)/2,f=(s+a)/2,d=(l+u)/2,g=(c+f)/2;let y=n-t,p=a-e;const m=Math.abs((i-n)*p-(s-a)*y);if(m>ax){if(m*m<=o*(y*y+p*p)){r.push(d,g);return}}else if(y=d-(t+n)/2,p=g-(e+a)/2,y*y+p*p<=o){r.push(d,g);return}po(r,t,e,l,c,d,g,o,h+1),po(r,d,g,u,f,n,a,o,h+1)}function wf(r,t,e,i,s,n,a,o){let h=Math.abs(s-n);(!a&&s>n||a&&n>s)&&(h=2*Math.PI-h),o||(o=Math.max(6,Math.floor(6*Math.pow(i,1/3)*(h/Math.PI)))),o=Math.max(o,3);let l=h/o,c=s;l*=a?-1:1;for(let u=0;u<o+1;u++){const f=Math.cos(c),d=Math.sin(c),g=t+f*i,y=e+d*i;r.push(g,y),c+=l}}function cx(r,t,e,i,s,n){const a=r[r.length-2],h=r[r.length-1]-e,l=a-t,c=s-e,u=i-t,f=Math.abs(h*u-l*c);if(f<1e-8||n===0){(r[r.length-2]!==t||r[r.length-1]!==e)&&r.push(t,e);return}const d=h*h+l*l,g=c*c+u*u,y=h*c+l*u,p=n*Math.sqrt(d)/f,m=n*Math.sqrt(g)/f,_=p*y/d,v=m*y/g,A=p*u+m*l,x=p*c+m*h,S=l*(m+_),b=h*(m+_),B=u*(p+v),G=c*(p+v),L=Math.atan2(b-x,S-A),O=Math.atan2(G-x,B-A);wf(r,A+t,x+e,n,L,O,l*c>u*h)}const mi=Math.PI*2,Xn={centerX:0,centerY:0,ang1:0,ang2:0},Wn=({x:r,y:t},e,i,s,n,a,o,h)=>{r*=e,t*=i;const l=s*r-n*t,c=n*r+s*t;return h.x=l+a,h.y=c+o,h};function ux(r,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),i=t===1.5707963267948966?.551915024494:e,s=Math.cos(r),n=Math.sin(r),a=Math.cos(r+t),o=Math.sin(r+t);return[{x:s-n*i,y:n+s*i},{x:a+o*i,y:o-a*i},{x:a,y:o}]}const mc=(r,t,e,i)=>{const s=r*i-t*e<0?-1:1;let n=r*e+t*i;return n>1&&(n=1),n<-1&&(n=-1),s*Math.acos(n)},dx=(r,t,e,i,s,n,a,o,h,l,c,u,f)=>{const d=Math.pow(s,2),g=Math.pow(n,2),y=Math.pow(c,2),p=Math.pow(u,2);let m=d*g-d*p-g*y;m<0&&(m=0),m/=d*p+g*y,m=Math.sqrt(m)*(a===o?-1:1);const _=m*s/n*u,v=m*-n/s*c,A=l*_-h*v+(r+e)/2,x=h*_+l*v+(t+i)/2,S=(c-_)/s,b=(u-v)/n,B=(-c-_)/s,G=(-u-v)/n,L=mc(1,0,S,b);let O=mc(S,b,B,G);o===0&&O>0&&(O-=mi),o===1&&O<0&&(O+=mi),f.centerX=A,f.centerY=x,f.ang1=L,f.ang2=O};function fx(r,t,e,i,s,n,a,o=0,h=0,l=0){if(n===0||a===0)return;const c=Math.sin(o*mi/360),u=Math.cos(o*mi/360),f=u*(t-i)/2+c*(e-s)/2,d=-c*(t-i)/2+u*(e-s)/2;if(f===0&&d===0)return;n=Math.abs(n),a=Math.abs(a);const g=Math.pow(f,2)/Math.pow(n,2)+Math.pow(d,2)/Math.pow(a,2);g>1&&(n*=Math.sqrt(g),a*=Math.sqrt(g)),dx(t,e,i,s,n,a,h,l,c,u,f,d,Xn);let{ang1:y,ang2:p}=Xn;const{centerX:m,centerY:_}=Xn;let v=Math.abs(p)/(mi/4);Math.abs(1-v)<1e-7&&(v=1);const A=Math.max(Math.ceil(v),1);p/=A;let x=r[r.length-2],S=r[r.length-1];const b={x:0,y:0};for(let B=0;B<A;B++){const G=ux(y,p),{x:L,y:O}=Wn(G[0],n,a,u,c,m,_,b),{x:N,y:j}=Wn(G[1],n,a,u,c,m,_,b),{x:J,y:rt}=Wn(G[2],n,a,u,c,m,_,b);bf(r,x,S,L,O,N,j,J,rt),x=J,S=rt,y+=p}}function px(r,t,e){const i=(a,o)=>{const h=o.x-a.x,l=o.y-a.y,c=Math.sqrt(h*h+l*l),u=h/c,f=l/c;return{len:c,nx:u,ny:f}},s=(a,o)=>{a===0?r.moveTo(o.x,o.y):r.lineTo(o.x,o.y)};let n=t[t.length-1];for(let a=0;a<t.length;a++){const o=t[a%t.length],h=o.radius??e;if(h<=0){s(a,o),n=o;continue}const l=t[(a+1)%t.length],c=i(o,n),u=i(o,l);if(c.len<1e-4||u.len<1e-4){s(a,o),n=o;continue}let f=Math.asin(c.nx*u.ny-c.ny*u.nx),d=1,g=!1;c.nx*u.nx-c.ny*-u.ny<0?f<0?f=Math.PI+f:(f=Math.PI-f,d=-1,g=!0):f>0&&(d=-1,g=!0);const y=f/2;let p,m=Math.abs(Math.cos(y)*h/Math.sin(y));m>Math.min(c.len/2,u.len/2)?(m=Math.min(c.len/2,u.len/2),p=Math.abs(m*Math.sin(y)/Math.cos(y))):p=h;const _=o.x+u.nx*m+-u.ny*p*d,v=o.y+u.ny*m+u.nx*p*d,A=Math.atan2(c.ny,c.nx)+Math.PI/2*d,x=Math.atan2(u.ny,u.nx)-Math.PI/2*d;a===0&&r.moveTo(_+Math.cos(A)*p,v+Math.sin(A)*p),r.arc(_,v,p,A,x,g),n=o}}function mx(r,t,e,i){const s=(o,h)=>Math.sqrt((o.x-h.x)**2+(o.y-h.y)**2),n=(o,h,l)=>({x:o.x+(h.x-o.x)*l,y:o.y+(h.y-o.y)*l}),a=t.length;for(let o=0;o<a;o++){const h=t[(o+1)%a],l=h.radius??e;if(l<=0){o===0?r.moveTo(h.x,h.y):r.lineTo(h.x,h.y);continue}const c=t[o],u=t[(o+2)%a],f=s(c,h);let d;if(f<1e-4)d=h;else{const p=Math.min(f/2,l);d=n(h,c,p/f)}const g=s(u,h);let y;if(g<1e-4)y=h;else{const p=Math.min(g/2,l);y=n(h,u,p/g)}o===0?r.moveTo(d.x,d.y):r.lineTo(d.x,d.y),r.quadraticCurveTo(h.x,h.y,y.x,y.y,i)}}const gx=new Yt;class yx{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new He,this._graphicsPath2D=t}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const i=this._currentPoly.points,s=i[i.length-2],n=i[i.length-1];return(s!==t||n!==e)&&i.push(t,e),this}arc(t,e,i,s,n,a){this._ensurePoly(!1);const o=this._currentPoly.points;return wf(o,t,e,i,s,n,a),this}arcTo(t,e,i,s,n){this._ensurePoly();const a=this._currentPoly.points;return cx(a,t,e,i,s,n),this}arcToSvg(t,e,i,s,n,a,o){const h=this._currentPoly.points;return fx(h,this._currentPoly.lastX,this._currentPoly.lastY,a,o,t,e,i,s,n),this}bezierCurveTo(t,e,i,s,n,a,o){this._ensurePoly();const h=this._currentPoly;return bf(this._currentPoly.points,h.lastX,h.lastY,t,e,i,s,n,a,o),this}quadraticCurveTo(t,e,i,s,n){this._ensurePoly();const a=this._currentPoly;return hx(this._currentPoly.points,a.lastX,a.lastY,t,e,i,s,n),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));for(let i=0;i<t.instructions.length;i++){const s=t.instructions[i];this[s.action](...s.data)}return this}finish(t=!1){this.endPoly(t)}rect(t,e,i,s,n){return this.drawShape(new Yt(t,e,i,s),n),this}circle(t,e,i,s){return this.drawShape(new jo(t,e,i),s),this}poly(t,e,i){const s=new pi(t);return s.closePath=e,this.drawShape(s,i),this}regularPoly(t,e,i,s,n=0,a){s=Math.max(s|0,3);const o=-1*Math.PI/2+n,h=Math.PI*2/s,l=[];for(let c=0;c<s;c++){const u=c*h+o;l.push(t+i*Math.cos(u),e+i*Math.sin(u))}return this.poly(l,!0,a),this}roundPoly(t,e,i,s,n,a=0,o){if(s=Math.max(s|0,3),n<=0)return this.regularPoly(t,e,i,s,a);const h=i*Math.sin(Math.PI/s)-.001;n=Math.min(n,h);const l=-1*Math.PI/2+a,c=Math.PI*2/s,u=(s-2)*Math.PI/s/2;for(let f=0;f<s;f++){const d=f*c+l,g=t+i*Math.cos(d),y=e+i*Math.sin(d),p=d+Math.PI+u,m=d-Math.PI-u,_=g+n*Math.cos(p),v=y+n*Math.sin(p),A=g+n*Math.cos(m),x=y+n*Math.sin(m);f===0?this.moveTo(_,v):this.lineTo(_,v),this.quadraticCurveTo(g,y,A,x,o)}return this.closePath()}roundShape(t,e,i=!1,s){return t.length<3?this:(i?mx(this,t,e,s):px(this,t,e),this.closePath())}filletRect(t,e,i,s,n){if(n===0)return this.rect(t,e,i,s);const a=Math.min(i,s)/2,o=Math.min(a,Math.max(-a,n)),h=t+i,l=e+s,c=o<0?-o:0,u=Math.abs(o);return this.moveTo(t,e+u).arcTo(t+c,e+c,t+u,e,u).lineTo(h-u,e).arcTo(h-c,e+c,h,e+u,u).lineTo(h,l-u).arcTo(h-c,l-c,t+i-u,l,u).lineTo(t+u,l).arcTo(t+c,l-c,t,l-u,u).closePath()}chamferRect(t,e,i,s,n,a){if(n<=0)return this.rect(t,e,i,s);const o=Math.min(n,Math.min(i,s)/2),h=t+i,l=e+s,c=[t+o,e,h-o,e,h,e+o,h,l-o,h-o,l,t+o,l,t,l-o,t,e+o];for(let u=c.length-1;u>=2;u-=2)c[u]===c[u-2]&&c[u-1]===c[u-3]&&c.splice(u-1,2);return this.poly(c,!0,a)}ellipse(t,e,i,s,n){return this.drawShape(new Yo(t,e,i,s),n),this}roundRect(t,e,i,s,n,a){return this.drawShape(new qo(t,e,i,s,n),a),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let i=this._currentPoly;return i&&this.endPoly(),i=new pi,i.points.push(t,e),this._currentPoly=i,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new pi,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let i=e.shape.x,s=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const n=e.transform,a=i;i=n.a*i+n.c*s+n.tx,s=n.b*a+n.d*s+n.ty}this._currentPoly.points.push(i,s)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const i=t.instructions[e];this[i.action](...i.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let i=0;i<e.length;i++){const s=e[i],n=s.shape.getBounds(gx);s.transform?t.addRect(n,s.transform):t.addRect(n)}return t}}class Or{constructor(t){this.instructions=[],this.uid=Gt("graphicsPath"),this._dirty=!0,typeof t=="string"?j_(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new yx(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,i,s,n){const a=this.instructions[this.instructions.length-1],o=this.getLastPoint(jt.shared);let h=0,l=0;if(!a||a.action!=="bezierCurveTo")h=o.x,l=o.y;else{h=a.data[2],l=a.data[3];const c=o.x,u=o.y;h=c+(c-h),l=u+(u-l)}return this.instructions.push({action:"bezierCurveTo",data:[h,l,t,e,i,s,n]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,i){const s=this.instructions[this.instructions.length-1],n=this.getLastPoint(jt.shared);let a=0,o=0;if(!s||s.action!=="quadraticCurveTo")a=n.x,o=n.y;else{a=s.data[0],o=s.data[1];const h=n.x,l=n.y;a=h+(h-a),o=l+(l-o)}return this.instructions.push({action:"quadraticCurveTo",data:[a,o,t,e,i]}),this._dirty=!0,this}rect(t,e,i,s,n){return this.instructions.push({action:"rect",data:[t,e,i,s,n]}),this._dirty=!0,this}circle(t,e,i,s){return this.instructions.push({action:"circle",data:[t,e,i,s]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,i,s,n,a,o){n||(n=s/2);const h=-1*Math.PI/2+a,l=i*2,c=Math.PI*2/l,u=[];for(let f=0;f<l;f++){const d=f%2?n:s,g=f*c+h;u.push(t+d*Math.cos(g),e+d*Math.sin(g))}return this.poly(u,!0,o),this}clone(t=!1){const e=new Or;if(!t)e.instructions=this.instructions.slice();else for(let i=0;i<this.instructions.length;i++){const s=this.instructions[i];e.instructions.push({action:s.action,data:s.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,i=t.b,s=t.c,n=t.d,a=t.tx,o=t.ty;let h=0,l=0,c=0,u=0,f=0,d=0,g=0,y=0;for(let p=0;p<this.instructions.length;p++){const m=this.instructions[p],_=m.data;switch(m.action){case"moveTo":case"lineTo":h=_[0],l=_[1],_[0]=e*h+s*l+a,_[1]=i*h+n*l+o;break;case"bezierCurveTo":c=_[0],u=_[1],f=_[2],d=_[3],h=_[4],l=_[5],_[0]=e*c+s*u+a,_[1]=i*c+n*u+o,_[2]=e*f+s*d+a,_[3]=i*f+n*d+o,_[4]=e*h+s*l+a,_[5]=i*h+n*l+o;break;case"quadraticCurveTo":c=_[0],u=_[1],h=_[2],l=_[3],_[0]=e*c+s*u+a,_[1]=i*c+n*u+o,_[2]=e*h+s*l+a,_[3]=i*h+n*l+o;break;case"arcToSvg":h=_[5],l=_[6],g=_[0],y=_[1],_[0]=e*g+s*y,_[1]=i*g+n*y,_[5]=e*h+s*l+a,_[6]=i*h+n*l+o;break;case"circle":_[4]=Qr(_[3],t);break;case"rect":_[4]=Qr(_[4],t);break;case"ellipse":_[8]=Qr(_[8],t);break;case"roundRect":_[5]=Qr(_[5],t);break;case"addPath":_[0].transform(t);break;case"poly":_[2]=Qr(_[2],t);break;default:Ot("unknown transform action",m.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,i=this.instructions[e];if(!i)return t.x=0,t.y=0,t;for(;i.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;i=this.instructions[e]}switch(i.action){case"moveTo":case"lineTo":t.x=i.data[0],t.y=i.data[1];break;case"quadraticCurveTo":t.x=i.data[2],t.y=i.data[3];break;case"bezierCurveTo":t.x=i.data[4],t.y=i.data[5];break;case"arc":case"arcToSvg":t.x=i.data[5],t.y=i.data[6];break;case"addPath":i.data[0].getLastPoint(t);break}return t}}function Qr(r,t){return r?r.prepend(t):t.clone()}function _x(r,t){if(typeof r=="string"){const i=document.createElement("div");i.innerHTML=r.trim(),r=i.querySelector("svg")}const e={context:t,path:new Or};return Af(r,e,null,null),t}function Af(r,t,e,i){const s=r.children,{fillStyle:n,strokeStyle:a}=xx(r);n&&e?e={...e,...n}:n&&(e=n),a&&i?i={...i,...a}:a&&(i=a),t.context.fillStyle=e,t.context.strokeStyle=i;let o,h,l,c,u,f,d,g,y,p,m,_,v,A,x,S,b;switch(r.nodeName.toLowerCase()){case"path":A=r.getAttribute("d"),x=new Or(A),t.context.path(x),e&&t.context.fill(),i&&t.context.stroke();break;case"circle":d=Ht(r,"cx",0),g=Ht(r,"cy",0),y=Ht(r,"r",0),t.context.ellipse(d,g,y,y),e&&t.context.fill(),i&&t.context.stroke();break;case"rect":o=Ht(r,"x",0),h=Ht(r,"y",0),S=Ht(r,"width",0),b=Ht(r,"height",0),p=Ht(r,"rx",0),m=Ht(r,"ry",0),p||m?t.context.roundRect(o,h,S,b,p||m):t.context.rect(o,h,S,b),e&&t.context.fill(),i&&t.context.stroke();break;case"ellipse":d=Ht(r,"cx",0),g=Ht(r,"cy",0),p=Ht(r,"rx",0),m=Ht(r,"ry",0),t.context.beginPath(),t.context.ellipse(d,g,p,m),e&&t.context.fill(),i&&t.context.stroke();break;case"line":l=Ht(r,"x1",0),c=Ht(r,"y1",0),u=Ht(r,"x2",0),f=Ht(r,"y2",0),t.context.beginPath(),t.context.moveTo(l,c),t.context.lineTo(u,f),i&&t.context.stroke();break;case"polygon":v=r.getAttribute("points"),_=v.match(/\d+/g).map(B=>parseInt(B,10)),t.context.poly(_,!0),e&&t.context.fill(),i&&t.context.stroke();break;case"polyline":v=r.getAttribute("points"),_=v.match(/\d+/g).map(B=>parseInt(B,10)),t.context.poly(_,!1),i&&t.context.stroke();break;case"g":case"svg":break;default:{console.info(`[SVG parser] <${r.nodeName}> elements unsupported`);break}}for(let B=0;B<s.length;B++)Af(s[B],t,e,i)}function Ht(r,t,e){const i=r.getAttribute(t);return i?Number(i):e}function xx(r){const t=r.getAttribute("style"),e={},i={};let s=!1,n=!1;if(t){const a=t.split(";");for(let o=0;o<a.length;o++){const h=a[o],[l,c]=h.split(":");switch(l){case"stroke":c!=="none"&&(e.color=Nt.shared.setValue(c).toNumber(),n=!0);break;case"stroke-width":e.width=Number(c);break;case"fill":c!=="none"&&(s=!0,i.color=Nt.shared.setValue(c).toNumber());break;case"fill-opacity":i.alpha=Number(c);break;case"stroke-opacity":e.alpha=Number(c);break;case"opacity":i.alpha=Number(c),e.alpha=Number(c);break}}}else{const a=r.getAttribute("stroke");a&&a!=="none"&&(n=!0,e.color=Nt.shared.setValue(a).toNumber(),e.width=Ht(r,"stroke-width",1));const o=r.getAttribute("fill");o&&o!=="none"&&(s=!0,i.color=Nt.shared.setValue(o).toNumber())}return{strokeStyle:n?e:null,fillStyle:s?i:null}}function vx(r){return Nt.isColorLike(r)}function gc(r){return r instanceof Xs}function yc(r){return r instanceof vi}function bx(r,t,e){const i=Nt.shared.setValue(t??0);return r.color=i.toNumber(),r.alpha=i.alpha===1?e.alpha:i.alpha,r.texture=ht.WHITE,{...e,...r}}function _c(r,t,e){return r.fill=t,r.color=16777215,r.texture=t.texture,r.matrix=t.transform,{...e,...r}}function xc(r,t,e){return t.buildLinearGradient(),r.fill=t,r.color=16777215,r.texture=t.texture,r.matrix=t.transform,{...e,...r}}function wx(r,t){var s;const e={...t,...r};if(e.texture){if(e.texture!==ht.WHITE){const a=((s=e.matrix)==null?void 0:s.clone().invert())||new mt;a.translate(e.texture.frame.x,e.texture.frame.y),a.scale(1/e.texture.source.width,1/e.texture.source.height),e.matrix=a}const n=e.texture.source.style;n.addressMode==="clamp-to-edge"&&(n.addressMode="repeat",n.update())}const i=Nt.shared.setValue(e.color);return e.alpha*=i.alpha,e.color=i.toNumber(),e.matrix=e.matrix?e.matrix.clone():null,e}function hr(r,t){if(r==null)return null;const e={},i=r;return vx(r)?bx(e,r,t):gc(r)?_c(e,r,t):yc(r)?xc(e,r,t):i.fill&&gc(i.fill)?_c(i,i.fill,t):i.fill&&yc(i.fill)?xc(i,i.fill,t):wx(i,t)}function Ps(r,t){const{width:e,alignment:i,miterLimit:s,cap:n,join:a,pixelLine:o,...h}=t,l=hr(r,h);return l?{width:e,alignment:i,miterLimit:s,cap:n,join:a,pixelLine:o,...l}:null}const Ax=new jt,vc=new mt,Qo=class ye extends me{constructor(){super(...arguments),this.uid=Gt("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new Or,this._transform=new mt,this._fillStyle={...ye.defaultFillStyle},this._strokeStyle={...ye.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new He,this._boundsDirty=!0}clone(){const t=new ye;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=hr(t,ye.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=Ps(t,ye.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=hr(t,ye.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=hr(t,ye.defaultStrokeStyle),this}texture(t,e,i,s,n,a){return this.instructions.push({action:"texture",data:{image:t,dx:i||0,dy:s||0,dw:n||t.frame.width,dh:a||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?Nt.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new Or,this}fill(t,e){let i;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s&&s.action==="stroke"?i=s.data.path:i=this._activePath.clone(),i?(t!=null&&(e!==void 0&&typeof t=="number"&&(wt(Rt,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=hr(t,ye.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:i}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(jt.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const i=this.instructions[this.instructions.length-1];return this._tick===0&&i&&i.action==="fill"?e=i.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=Ps(t,ye.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],i=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(i);else{e.data.hole=i;break}}return this._initNextPathLocation(),this}arc(t,e,i,s,n,a){this._tick++;const o=this._transform;return this._activePath.arc(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,i,s,n,a),this}arcTo(t,e,i,s,n){this._tick++;const a=this._transform;return this._activePath.arcTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*i+a.c*s+a.tx,a.b*i+a.d*s+a.ty,n),this}arcToSvg(t,e,i,s,n,a,o){this._tick++;const h=this._transform;return this._activePath.arcToSvg(t,e,i,s,n,h.a*a+h.c*o+h.tx,h.b*a+h.d*o+h.ty),this}bezierCurveTo(t,e,i,s,n,a,o){this._tick++;const h=this._transform;return this._activePath.bezierCurveTo(h.a*t+h.c*e+h.tx,h.b*t+h.d*e+h.ty,h.a*i+h.c*s+h.tx,h.b*i+h.d*s+h.ty,h.a*n+h.c*a+h.tx,h.b*n+h.d*a+h.ty,o),this}closePath(){var t;return this._tick++,(t=this._activePath)==null||t.closePath(),this}ellipse(t,e,i,s){return this._tick++,this._activePath.ellipse(t,e,i,s,this._transform.clone()),this}circle(t,e,i){return this._tick++,this._activePath.circle(t,e,i,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const i=this._transform;return this._activePath.lineTo(i.a*t+i.c*e+i.tx,i.b*t+i.d*e+i.ty),this}moveTo(t,e){this._tick++;const i=this._transform,s=this._activePath.instructions,n=i.a*t+i.c*e+i.tx,a=i.b*t+i.d*e+i.ty;return s.length===1&&s[0].action==="moveTo"?(s[0].data[0]=n,s[0].data[1]=a,this):(this._activePath.moveTo(n,a),this)}quadraticCurveTo(t,e,i,s,n){this._tick++;const a=this._transform;return this._activePath.quadraticCurveTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*i+a.c*s+a.tx,a.b*i+a.d*s+a.ty,n),this}rect(t,e,i,s){return this._tick++,this._activePath.rect(t,e,i,s,this._transform.clone()),this}roundRect(t,e,i,s,n){return this._tick++,this._activePath.roundRect(t,e,i,s,n,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,i,s,n=0,a){return this._tick++,this._activePath.regularPoly(t,e,i,s,n,a),this}roundPoly(t,e,i,s,n,a){return this._tick++,this._activePath.roundPoly(t,e,i,s,n,a),this}roundShape(t,e,i,s){return this._tick++,this._activePath.roundShape(t,e,i,s),this}filletRect(t,e,i,s,n){return this._tick++,this._activePath.filletRect(t,e,i,s,n),this}chamferRect(t,e,i,s,n,a){return this._tick++,this._activePath.chamferRect(t,e,i,s,n,a),this}star(t,e,i,s,n=0,a=0){return this._tick++,this._activePath.star(t,e,i,s,n,a,this._transform.clone()),this}svg(t){return this._tick++,_x(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,i,s,n,a){return t instanceof mt?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,i,s,n,a),this)}transform(t,e,i,s,n,a){return t instanceof mt?(this._transform.append(t),this):(vc.set(t,e,i,s,n,a),this._transform.append(vc),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const i=this.instructions[e],s=i.action;if(s==="fill"){const n=i.data;t.addBounds(n.path.bounds)}else if(s==="texture"){const n=i.data;t.addFrame(n.dx,n.dy,n.dx+n.dw,n.dy+n.dh,n.transform)}if(s==="stroke"){const n=i.data,a=n.style.alignment,o=n.style.width*(1-a),h=n.path.bounds;t.addFrame(h.minX-o,h.minY-o,h.maxX+o,h.maxY+o)}}return t}containsPoint(t){var s;if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let i=!1;for(let n=0;n<e.length;n++){const a=e[n],o=a.data,h=o.path;if(!a.action||!h)continue;const l=o.style,c=h.shapePath.shapePrimitives;for(let u=0;u<c.length;u++){const f=c[u].shape;if(!l||!f)continue;const d=c[u].transform,g=d?d.applyInverse(t,Ax):t;a.action==="fill"?i=f.contains(g.x,g.y):i=f.strokeContains(g.x,g.y,l.width);const y=o.hole;if(y){const p=(s=y.shapePath)==null?void 0:s.shapePrimitives;if(p)for(let m=0;m<p.length;m++)p[m].shape.contains(g.x,g.y)&&(i=!1)}if(i)return!0}}return i}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(i),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(i)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Qo.defaultFillStyle={color:16777215,alpha:1,texture:ht.WHITE,matrix:null,fill:null};Qo.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:ht.WHITE,matrix:null,fill:null,pixelLine:!1};let Je=Qo;const bc=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function Tx(r){const t=[];let e=0;for(let i=0;i<bc.length;i++){const s=`_${bc[i]}`;t[e++]=r[s]}return e=Tf(r._fill,t,e),e=Sx(r._stroke,t,e),e=Cx(r.dropShadow,t,e),t.join("-")}function Tf(r,t,e){var i;return r&&(t[e++]=r.color,t[e++]=r.alpha,t[e++]=(i=r.fill)==null?void 0:i.styleKey),e}function Sx(r,t,e){return r&&(e=Tf(r,t,e),t[e++]=r.width,t[e++]=r.alignment,t[e++]=r.cap,t[e++]=r.join,t[e++]=r.miterLimit),e}function Cx(r,t,e){return r&&(t[e++]=r.alpha,t[e++]=r.angle,t[e++]=r.blur,t[e++]=r.distance,t[e++]=Nt.shared.setValue(r.color).toNumber()),e}const Jo=class wr extends me{constructor(t={}){super(),Ex(t);const e={...wr.defaultTextStyle,...t};for(const i in e){const s=i;this[s]=e[i]}this.update()}get align(){return this._align}set align(t){this._align=t,this.update()}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords=t,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(t){t!==null&&typeof t=="object"?this._dropShadow=this._createProxy({...wr.defaultDropShadow,...t}):this._dropShadow=t?this._createProxy({...wr.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t,this.update()}get fontSize(){return this._fontSize}set fontSize(t){typeof t=="string"?this._fontSize=parseInt(t,10):this._fontSize=t,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t,this.update()}get leading(){return this._leading}set leading(t){this._leading=t,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing=t,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t,this.update()}get padding(){return this._padding}set padding(t){this._padding=t,this.update()}get trim(){return this._trim}set trim(t){this._trim=t,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace=t,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap=t,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth=t,this.update()}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...Je.defaultFillStyle,...t},()=>{this._fill=hr({...this._originalFill},Je.defaultFillStyle)})),this._fill=hr(t===0?"black":t,Je.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...Je.defaultStrokeStyle,...t},()=>{this._stroke=Ps({...this._originalStroke},Je.defaultStrokeStyle)})),this._stroke=Ps(t,Je.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=Tx(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const t=wr.defaultTextStyle;for(const e in t)this[e]=t[e]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new wr({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(t=!1){var i,s,n,a;if(this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const o=typeof t=="boolean"?t:t==null?void 0:t.textureSource;(i=this._fill)!=null&&i.texture&&this._fill.texture.destroy(o),(s=this._originalFill)!=null&&s.texture&&this._originalFill.texture.destroy(o),(n=this._stroke)!=null&&n.texture&&this._stroke.texture.destroy(o),(a=this._originalStroke)!=null&&a.texture&&this._originalStroke.texture.destroy(o)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,e){return new Proxy(t,{set:(i,s,n)=>(i[s]=n,e==null||e(s,n),this.update(),!0)})}_isFillStyle(t){return(t??null)!==null&&!(Nt.isColorLike(t)||t instanceof vi||t instanceof Xs)}};Jo.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};Jo.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let wi=Jo;function Ex(r){const t=r;if(typeof t.dropShadow=="boolean"&&t.dropShadow){const e=wi.defaultDropShadow;r.dropShadow={alpha:t.dropShadowAlpha??e.alpha,angle:t.dropShadowAngle??e.angle,blur:t.dropShadowBlur??e.blur,color:t.dropShadowColor??e.color,distance:t.dropShadowDistance??e.distance}}if(t.strokeThickness!==void 0){wt(Rt,"strokeThickness is now a part of stroke");const e=t.stroke;let i={};if(Nt.isColorLike(e))i.color=e;else if(e instanceof vi||e instanceof Xs)i.fill=e;else if(Object.hasOwnProperty.call(e,"color")||Object.hasOwnProperty.call(e,"fill"))i=e;else throw new Error("Invalid stroke value.");r.stroke={...i,width:t.strokeThickness}}if(Array.isArray(t.fillGradientStops)){wt(Rt,"gradient fill is now a fill pattern: `new FillGradient(...)`");let e;r.fontSize==null?r.fontSize=wi.defaultTextStyle.fontSize:typeof r.fontSize=="string"?e=parseInt(r.fontSize,10):e=r.fontSize;const i=new vi(0,0,0,e*1.7),s=t.fillGradientStops.map(n=>Nt.shared.setValue(n).toNumber());s.forEach((n,a)=>{const o=a/(s.length-1);i.addColorStop(o,n)}),r.fill={fill:i}}}class Ix{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,e){const i=Ft.get().createCanvas();i.width=t,i.height=e;const s=i.getContext("2d");return{canvas:i,context:s}}getOptimalCanvasAndContext(t,e,i=1){t=Math.ceil(t*i-1e-6),e=Math.ceil(e*i-1e-6),t=Es(t),e=Es(e);const s=(t<<17)+(e<<1);this._canvasPool[s]||(this._canvasPool[s]=[]);let n=this._canvasPool[s].pop();return n||(n=this._createCanvasAndContext(t,e)),n}returnCanvasAndContext(t){const e=t.canvas,{width:i,height:s}=e,n=(i<<17)+(s<<1);t.context.clearRect(0,0,i,s),this._canvasPool[n].push(t)}clear(){this._canvasPool={}}}const wc=new Ix,Px=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function mo(r){const t=typeof r.fontSize=="number"?`${r.fontSize}px`:r.fontSize;let e=r.fontFamily;Array.isArray(r.fontFamily)||(e=r.fontFamily.split(","));for(let i=e.length-1;i>=0;i--){let s=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!Px.includes(s)&&(s=`"${s}"`),e[i]=s}return`${r.fontStyle} ${r.fontVariant} ${r.fontWeight} ${t} ${e.join(",")}`}const jn={willReadFrequently:!0},ge=class Y{static get experimentalLetterSpacingSupported(){let t=Y._experimentalLetterSpacingSupported;if(t!==void 0){const e=Ft.get().getCanvasRenderingContext2D().prototype;t=Y._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,i,s,n,a,o,h,l){this.text=t,this.style=e,this.width=i,this.height=s,this.lines=n,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=h,this.fontProperties=l}static measureText(t=" ",e,i=Y._canvas,s=e.wordWrap){var _;const n=`${t}:${e.styleKey}`;if(Y._measurementCache[n])return Y._measurementCache[n];const a=mo(e),o=Y.measureFont(a);o.fontSize===0&&(o.fontSize=e.fontSize,o.ascent=e.fontSize);const h=Y.__context;h.font=a;const c=(s?Y._wordWrap(t,e,i):t).split(/(?:\r\n|\r|\n)/),u=new Array(c.length);let f=0;for(let v=0;v<c.length;v++){const A=Y._measureText(c[v],e.letterSpacing,h);u[v]=A,f=Math.max(f,A)}const d=((_=e._stroke)==null?void 0:_.width)||0;let g=f+d;e.dropShadow&&(g+=e.dropShadow.distance);const y=e.lineHeight||o.fontSize;let p=Math.max(y,o.fontSize+d)+(c.length-1)*(y+e.leading);return e.dropShadow&&(p+=e.dropShadow.distance),new Y(t,e,g,p,c,u,y+e.leading,f,o)}static _measureText(t,e,i){let s=!1;Y.experimentalLetterSpacingSupported&&(Y.experimentalLetterSpacing?(i.letterSpacing=`${e}px`,i.textLetterSpacing=`${e}px`,s=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));const n=i.measureText(t);let a=n.width;const o=-n.actualBoundingBoxLeft;let l=n.actualBoundingBoxRight-o;if(a>0)if(s)a-=e,l-=e;else{const c=(Y.graphemeSegmenter(t).length-1)*e;a+=c,l+=c}return Math.max(a,l)}static _wordWrap(t,e,i=Y._canvas){const s=i.getContext("2d",jn);let n=0,a="",o="";const h=Object.create(null),{letterSpacing:l,whiteSpace:c}=e,u=Y._collapseSpaces(c),f=Y._collapseNewlines(c);let d=!u;const g=e.wordWrapWidth+l,y=Y._tokenize(t);for(let p=0;p<y.length;p++){let m=y[p];if(Y._isNewline(m)){if(!f){o+=Y._addLine(a),d=!u,a="",n=0;continue}m=" "}if(u){const v=Y.isBreakingSpace(m),A=Y.isBreakingSpace(a[a.length-1]);if(v&&A)continue}const _=Y._getFromCache(m,l,h,s);if(_>g)if(a!==""&&(o+=Y._addLine(a),a="",n=0),Y.canBreakWords(m,e.breakWords)){const v=Y.wordWrapSplit(m);for(let A=0;A<v.length;A++){let x=v[A],S=x,b=1;for(;v[A+b];){const G=v[A+b];if(!Y.canBreakChars(S,G,m,A,e.breakWords))x+=G;else break;S=G,b++}A+=b-1;const B=Y._getFromCache(x,l,h,s);B+n>g&&(o+=Y._addLine(a),d=!1,a="",n=0),a+=x,n+=B}}else{a.length>0&&(o+=Y._addLine(a),a="",n=0);const v=p===y.length-1;o+=Y._addLine(m,!v),d=!1,a="",n=0}else _+n>g&&(d=!1,o+=Y._addLine(a),a="",n=0),(a.length>0||!Y.isBreakingSpace(m)||d)&&(a+=m,n+=_)}return o+=Y._addLine(a,!1),o}static _addLine(t,e=!0){return t=Y._trimRight(t),t=e?`${t}
`:t,t}static _getFromCache(t,e,i,s){let n=i[t];return typeof n!="number"&&(n=Y._measureText(t,e,s)+e,i[t]=n),n}static _collapseSpaces(t){return t==="normal"||t==="pre-line"}static _collapseNewlines(t){return t==="normal"}static _trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const i=t[e];if(!Y.isBreakingSpace(i))break;t=t.slice(0,-1)}return t}static _isNewline(t){return typeof t!="string"?!1:Y._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:Y._breakingSpaces.includes(t.charCodeAt(0))}static _tokenize(t){const e=[];let i="";if(typeof t!="string")return e;for(let s=0;s<t.length;s++){const n=t[s],a=t[s+1];if(Y.isBreakingSpace(n,a)||Y._isNewline(n)){i!==""&&(e.push(i),i=""),e.push(n);continue}i+=n}return i!==""&&e.push(i),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,i,s,n){return!0}static wordWrapSplit(t){return Y.graphemeSegmenter(t)}static measureFont(t){if(Y._fonts[t])return Y._fonts[t];const e=Y._context;e.font=t;const i=e.measureText(Y.METRICS_STRING+Y.BASELINE_SYMBOL),s={ascent:i.actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent,fontSize:i.actualBoundingBoxAscent+i.actualBoundingBoxDescent};return Y._fonts[t]=s,s}static clearMetrics(t=""){t?delete Y._fonts[t]:Y._fonts={}}static get _canvas(){if(!Y.__canvas){let t;try{const e=new OffscreenCanvas(0,0),i=e.getContext("2d",jn);if(i!=null&&i.measureText)return Y.__canvas=e,e;t=Ft.get().createCanvas()}catch{t=Ft.get().createCanvas()}t.width=t.height=10,Y.__canvas=t}return Y.__canvas}static get _context(){return Y.__context||(Y.__context=Y._canvas.getContext("2d",jn)),Y.__context}};ge.METRICS_STRING="|ÉqÅ";ge.BASELINE_SYMBOL="M";ge.BASELINE_MULTIPLIER=1.4;ge.HEIGHT_MULTIPLIER=2;ge.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const r=new Intl.Segmenter;return t=>[...r.segment(t)].map(e=>e.segment)}return r=>[...r]})();ge.experimentalLetterSpacing=!1;ge._fonts={};ge._newlines=[10,13];ge._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];ge._measurementCache={};let Ac=ge;function Tc(r,t){if(r.texture===ht.WHITE&&!r.fill)return Nt.shared.setValue(r.color).setAlpha(r.alpha??1).toHexa();if(r.fill){if(r.fill instanceof Xs){const e=r.fill,i=t.createPattern(e.texture.source.resource,"repeat"),s=e.transform.copyTo(mt.shared);return s.scale(e.texture.frame.width,e.texture.frame.height),i.setTransform(s),i}else if(r.fill instanceof vi){const e=r.fill;if(e.type==="linear"){const i=t.createLinearGradient(e.x0,e.y0,e.x1,e.y1);return e.gradientStops.forEach(s=>{i.addColorStop(s.offset,Nt.shared.setValue(s.color).toHex())}),i}}}else{const e=t.createPattern(r.texture.source.resource,"repeat"),i=r.matrix.copyTo(mt.shared);return i.scale(r.texture.frame.width,r.texture.frame.height),e.setTransform(i),e}return Ot("FillStyle not recognised",r),"red"}function Sf(r){if(r==="")return[];typeof r=="string"&&(r=[r]);const t=[];for(let e=0,i=r.length;e<i;e++){const s=r[e];if(Array.isArray(s)){if(s.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${s.length}.`);if(s[0].length===0||s[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const n=s[0].charCodeAt(0),a=s[1].charCodeAt(0);if(a<n)throw new Error("[BitmapFont]: Invalid character range.");for(let o=n,h=a;o<=h;o++)t.push(String.fromCharCode(o))}else t.push(...Array.from(s))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const Cf=class Ef extends nf{constructor(t){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;const e={...Ef.defaultOptions,...t};this._textureSize=e.textureSize,this._mipmap=e.mipmap;const i=e.style.clone();e.overrideFill&&(i._fill.color=16777215,i._fill.alpha=1,i._fill.texture=ht.WHITE,i._fill.fill=null),this.applyFillAsTint=e.overrideFill;const s=i.fontSize;i.fontSize=this.baseMeasurementFontSize;const n=mo(i);e.overrideSize?i._stroke&&(i._stroke.width*=this.baseRenderedFontSize/s):i.fontSize=this.baseRenderedFontSize=s,this._style=i,this._skipKerning=e.skipKerning??!1,this.resolution=e.resolution??1,this._padding=e.padding??4,this.fontMetrics=Ac.measureFont(n),this.lineHeight=i.lineHeight||this.fontMetrics.fontSize||i.fontSize}ensureCharacters(t){var p,m;const e=Sf(t).filter(_=>!this._currentChars.includes(_)).filter((_,v,A)=>A.indexOf(_)===v);if(!e.length)return;this._currentChars=[...this._currentChars,...e];let i;this._currentPageIndex===-1?i=this._nextPage():i=this.pages[this._currentPageIndex];let{canvas:s,context:n}=i.canvasAndContext,a=i.texture.source;const o=this._style;let h=this._currentX,l=this._currentY;const c=this.baseRenderedFontSize/this.baseMeasurementFontSize,u=this._padding*c;let f=0,d=!1;const g=s.width/this.resolution,y=s.height/this.resolution;for(let _=0;_<e.length;_++){const v=e[_],A=Ac.measureText(v,o,s,!1);A.lineHeight=A.height;const x=A.width*c,S=Math.ceil((o.fontStyle==="italic"?2:1)*x),b=A.height*c,B=S+u*2,G=b+u*2;if(d=!1,v!==`
`&&v!=="\r"&&v!=="	"&&v!==" "&&(d=!0,f=Math.ceil(Math.max(G,f))),h+B>g&&(l+=f,f=G,h=0,l+f>y)){a.update();const O=this._nextPage();s=O.canvasAndContext.canvas,n=O.canvasAndContext.context,a=O.texture.source,l=0}const L=x/c-(((p=o.dropShadow)==null?void 0:p.distance)??0)-(((m=o._stroke)==null?void 0:m.width)??0);if(this.chars[v]={id:v.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:L,kerning:{}},d){this._drawGlyph(n,A,h+u,l+u,c,o);const O=a.width*c,N=a.height*c,j=new Yt(h/O*a.width,l/N*a.height,B/O*a.width,G/N*a.height);this.chars[v].texture=new ht({source:a,frame:j}),h+=Math.ceil(B)}}a.update(),this._currentX=h,this._currentY=l,this._skipKerning&&this._applyKerning(e,n)}get pageTextures(){return wt(Rt,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(t,e){const i=this._measureCache;for(let s=0;s<t.length;s++){const n=t[s];for(let a=0;a<this._currentChars.length;a++){const o=this._currentChars[a];let h=i[n];h||(h=i[n]=e.measureText(n).width);let l=i[o];l||(l=i[o]=e.measureText(o).width);let c=e.measureText(n+o).width,u=c-(h+l);u&&(this.chars[n].kerning[o]=u),c=e.measureText(n+o).width,u=c-(h+l),u&&(this.chars[o].kerning[n]=u)}}}_nextPage(){this._currentPageIndex++;const t=this.resolution,e=wc.getOptimalCanvasAndContext(this._textureSize,this._textureSize,t);this._setupContext(e.context,this._style,t);const i=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),s=new ht({source:new Dr({resource:e.canvas,resolution:i,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})}),n={canvasAndContext:e,texture:s};return this.pages[this._currentPageIndex]=n,n}_setupContext(t,e,i){e.fontSize=this.baseRenderedFontSize,t.scale(i,i),t.font=mo(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;const s=e._stroke,n=(s==null?void 0:s.width)??0;if(s&&(t.lineWidth=n,t.lineJoin=s.join,t.miterLimit=s.miterLimit,t.strokeStyle=Tc(s,t)),e._fill&&(t.fillStyle=Tc(e._fill,t)),e.dropShadow){const a=e.dropShadow,o=Nt.shared.setValue(a.color).toArray(),h=a.blur*i,l=a.distance*i;t.shadowColor=`rgba(${o[0]*255},${o[1]*255},${o[2]*255},${a.alpha})`,t.shadowBlur=h,t.shadowOffsetX=Math.cos(a.angle)*l,t.shadowOffsetY=Math.sin(a.angle)*l}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}_drawGlyph(t,e,i,s,n,a){const o=e.text,h=e.fontProperties,l=a._stroke,c=((l==null?void 0:l.width)??0)*n,u=i+c/2,f=s-c/2,d=h.descent*n,g=e.lineHeight*n;a.stroke&&c&&t.strokeText(o,u,f+g-d),a._fill&&t.fillText(o,u,f+g-d)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{canvasAndContext:e,texture:i}=this.pages[t];wc.returnCanvasAndContext(e),i.destroy(!0)}this.pages=null}};Cf.defaultOptions={textureSize:512,style:new wi,mipmap:!0};let Sc=Cf;function Rx(r,t,e,i){const s={width:0,height:0,offsetY:0,scale:t.fontSize/e.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};s.offsetY=e.baseLineOffset;let n=s.lines[0],a=null,o=!0;const h={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},l=g=>{const y=n.width;for(let p=0;p<h.index;p++){const m=g.positions[p];n.chars.push(g.chars[p]),n.charPositions.push(m+y)}n.width+=g.width,o=!1,h.width=0,h.index=0,h.chars.length=0},c=()=>{let g=n.chars.length-1;if(i){let y=n.chars[g];for(;y===" ";)n.width-=e.chars[y].xAdvance,y=n.chars[--g]}s.width=Math.max(s.width,n.width),n={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},o=!0,s.lines.push(n),s.height+=e.lineHeight},u=e.baseMeasurementFontSize/t.fontSize,f=t.letterSpacing*u,d=t.wordWrapWidth*u;for(let g=0;g<r.length+1;g++){let y;const p=g===r.length;p||(y=r[g]);const m=e.chars[y]||e.chars[" "];if(/(?:\s)/.test(y)||y==="\r"||y===`
`||p){if(!o&&t.wordWrap&&n.width+h.width-f>d?(c(),l(h),p||n.charPositions.push(0)):(h.start=n.width,l(h),p||n.charPositions.push(0)),y==="\r"||y===`
`)n.width!==0&&c();else if(!p){const x=m.xAdvance+(m.kerning[a]||0)+f;n.width+=x,n.spaceWidth=x,n.spacesIndex.push(n.charPositions.length),n.chars.push(y)}}else{const A=m.kerning[a]||0,x=m.xAdvance+A+f;h.positions[h.index++]=h.width+A,h.chars.push(y),h.width+=x}a=y}return c(),t.align==="center"?Mx(s):t.align==="right"?Fx(s):t.align==="justify"&&kx(s),s}function Mx(r){for(let t=0;t<r.lines.length;t++){const e=r.lines[t],i=r.width/2-e.width/2;for(let s=0;s<e.charPositions.length;s++)e.charPositions[s]+=i}}function Fx(r){for(let t=0;t<r.lines.length;t++){const e=r.lines[t],i=r.width-e.width;for(let s=0;s<e.charPositions.length;s++)e.charPositions[s]+=i}}function kx(r){const t=r.width;for(let e=0;e<r.lines.length;e++){const i=r.lines[e];let s=0,n=i.spacesIndex[s++],a=0;const o=i.spacesIndex.length,l=(t-i.width)/o;for(let c=0;c<i.charPositions.length;c++)c===n&&(n=i.spacesIndex[s++],a+=l),i.charPositions[c]+=a}}let Yi=0;class Bx{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(t,e){var a;let i=`${e.fontFamily}-bitmap`,s=!0;if(e._fill.fill&&!e._stroke)i+=e._fill.fill.styleKey,s=!1;else if(e._stroke||e.dropShadow){let o=e.styleKey;o=o.substring(0,o.lastIndexOf("-")),i=`${o}-bitmap`,s=!1}if(!Mt.has(i)){const o=new Sc({style:e,overrideFill:s,overrideSize:!0,...this.defaultOptions});Yi++,Yi>50&&Ot("BitmapText",`You have dynamically created ${Yi} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),o.once("destroy",()=>{Yi--,Mt.remove(i)}),Mt.set(i,o)}const n=Mt.get(i);return(a=n.ensureCharacters)==null||a.call(n,t),n}getLayout(t,e,i=!0){const s=this.getFont(t,e);return Rx([...t],e,s,i)}measureText(t,e,i=!0){return this.getLayout(t,e,i)}install(...t){var l,c,u,f;let e=t[0];typeof e=="string"&&(e={name:e,style:t[1],chars:(l=t[2])==null?void 0:l.chars,resolution:(c=t[2])==null?void 0:c.resolution,padding:(u=t[2])==null?void 0:u.padding,skipKerning:(f=t[2])==null?void 0:f.skipKerning},wt(Rt,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const i=e==null?void 0:e.name;if(!i)throw new Error("[BitmapFontManager] Property `name` is required.");e={...this.defaultOptions,...e};const s=e.style,n=s instanceof wi?s:new wi(s),a=n._fill.fill!==null&&n._fill.fill!==void 0,o=new Sc({style:n,overrideFill:a,skipKerning:e.skipKerning,padding:e.padding,resolution:e.resolution,overrideSize:!1}),h=Sf(e.chars);return o.ensureCharacters(h.join("")),Mt.set(`${i}-bitmap`,o),o.once("destroy",()=>Mt.remove(`${i}-bitmap`)),o}uninstall(t){const e=`${t}-bitmap`,i=Mt.get(e);i&&i.destroy()}}const Cc=new Bx;class If extends nf{constructor(t,e){super();const{textures:i,data:s}=t;Object.keys(s.pages).forEach(n=>{const a=s.pages[parseInt(n,10)],o=i[a.id];this.pages.push({texture:o})}),Object.keys(s.chars).forEach(n=>{const a=s.chars[n],{frame:o,source:h}=i[a.page],l=new Yt(a.x+o.x,a.y+o.y,a.width,a.height),c=new ht({source:h,frame:l});this.chars[n]={id:n.codePointAt(0),xOffset:a.xOffset,yOffset:a.yOffset,xAdvance:a.xAdvance,kerning:a.kerning??{},texture:c}}),this.baseRenderedFontSize=s.fontSize,this.baseMeasurementFontSize=s.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:s.fontSize},this.baseLineOffset=s.baseLineOffset,this.lineHeight=s.lineHeight,this.fontFamily=s.fontFamily,this.distanceField=s.distanceField??{type:"none",range:0},this.url=e}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{texture:e}=this.pages[t];e.destroy(!0)}this.pages=null}static install(t){Cc.install(t)}static uninstall(t){Cc.uninstall(t)}}const Yn={test(r){return typeof r=="string"&&r.startsWith("info face=")},parse(r){const t=r.match(/^[a-z]+\s+.+$/gm),e={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const u in t){const f=t[u].match(/^[a-z]+/gm)[0],d=t[u].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),g={};for(const y in d){const p=d[y].split("="),m=p[0],_=p[1].replace(/"/gm,""),v=parseFloat(_),A=isNaN(v)?_:v;g[m]=A}e[f].push(g)}const i={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[s]=e.info,[n]=e.common,[a]=e.distanceField??[];a&&(i.distanceField={range:parseInt(a.distanceRange,10),type:a.fieldType}),i.fontSize=parseInt(s.size,10),i.fontFamily=s.face,i.lineHeight=parseInt(n.lineHeight,10);const o=e.page;for(let u=0;u<o.length;u++)i.pages.push({id:parseInt(o[u].id,10)||0,file:o[u].file});const h={};i.baseLineOffset=i.lineHeight-parseInt(n.base,10);const l=e.char;for(let u=0;u<l.length;u++){const f=l[u],d=parseInt(f.id,10);let g=f.letter??f.char??String.fromCharCode(d);g==="space"&&(g=" "),h[d]=g,i.chars[g]={id:d,page:parseInt(f.page,10)||0,x:parseInt(f.x,10),y:parseInt(f.y,10),width:parseInt(f.width,10),height:parseInt(f.height,10),xOffset:parseInt(f.xoffset,10),yOffset:parseInt(f.yoffset,10),xAdvance:parseInt(f.xadvance,10),kerning:{}}}const c=e.kerning||[];for(let u=0;u<c.length;u++){const f=parseInt(c[u].first,10),d=parseInt(c[u].second,10),g=parseInt(c[u].amount,10);i.chars[h[d]].kerning[h[f]]=g}return i}},Ec={test(r){const t=r;return typeof t!="string"&&"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(r){const t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},e=r.getElementsByTagName("info")[0],i=r.getElementsByTagName("common")[0],s=r.getElementsByTagName("distanceField")[0];s&&(t.distanceField={type:s.getAttribute("fieldType"),range:parseInt(s.getAttribute("distanceRange"),10)});const n=r.getElementsByTagName("page"),a=r.getElementsByTagName("char"),o=r.getElementsByTagName("kerning");t.fontSize=parseInt(e.getAttribute("size"),10),t.fontFamily=e.getAttribute("face"),t.lineHeight=parseInt(i.getAttribute("lineHeight"),10);for(let l=0;l<n.length;l++)t.pages.push({id:parseInt(n[l].getAttribute("id"),10)||0,file:n[l].getAttribute("file")});const h={};t.baseLineOffset=t.lineHeight-parseInt(i.getAttribute("base"),10);for(let l=0;l<a.length;l++){const c=a[l],u=parseInt(c.getAttribute("id"),10);let f=c.getAttribute("letter")??c.getAttribute("char")??String.fromCharCode(u);f==="space"&&(f=" "),h[u]=f,t.chars[f]={id:u,page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xOffset:parseInt(c.getAttribute("xoffset"),10),yOffset:parseInt(c.getAttribute("yoffset"),10),xAdvance:parseInt(c.getAttribute("xadvance"),10),kerning:{}}}for(let l=0;l<o.length;l++){const c=parseInt(o[l].getAttribute("first"),10),u=parseInt(o[l].getAttribute("second"),10),f=parseInt(o[l].getAttribute("amount"),10);t.chars[h[u]].kerning[h[c]]=f}return t}},Ic={test(r){return typeof r=="string"&&r.includes("<font>")?Ec.test(Ft.get().parseXML(r)):!1},parse(r){return Ec.parse(Ft.get().parseXML(r))}},Lx=[".xml",".fnt"],Nx={extension:{type:Z.CacheParser,name:"cacheBitmapFont"},test:r=>r instanceof If,getCacheableAssets(r,t){const e={};return r.forEach(i=>{e[i]=t,e[`${i}-bitmap`]=t}),e[`${t.fontFamily}-bitmap`]=t,e}},Ox={extension:{type:Z.LoadParser,priority:Ve.Normal},name:"loadBitmapFont",test(r){return Lx.includes(re.extname(r).toLowerCase())},async testParse(r){return Yn.test(r)||Ic.test(r)},async parse(r,t,e){const i=Yn.test(r)?Yn.parse(r):Ic.parse(r),{src:s}=t,{pages:n}=i,a=[],o=i.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let u=0;u<n.length;++u){const f=n[u].file;let d=re.join(re.dirname(s),f);d=io(d,s),a.push({src:d,data:o})}const h=await e.load(a),l=a.map(u=>h[u.src]);return new If({data:i,textures:l},s)},async load(r,t){return await(await Ft.get().fetch(r)).text()},async unload(r,t,e){await Promise.all(r.pages.map(i=>e.unload(i.texture.source._sourceOrigin))),r.destroy()}};class Ux{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<e;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}const Gx={extension:{type:Z.CacheParser,name:"cacheTextureArray"},test:r=>Array.isArray(r)&&r.every(t=>t instanceof ht),getCacheableAssets:(r,t)=>{const e={};return r.forEach(i=>{t.forEach((s,n)=>{e[i+(n===0?"":n+1)]=s})}),e}};async function Pf(r){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=r});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(r)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const Dx={extension:{type:Z.DetectionParser,priority:1},test:async()=>Pf("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async r=>[...r,"avif"],remove:async r=>r.filter(t=>t!=="avif")},Pc=["png","jpg","jpeg"],$x={extension:{type:Z.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async r=>[...r,...Pc],remove:async r=>r.filter(t=>!Pc.includes(t))},Hx="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function th(r){return Hx?!1:document.createElement("video").canPlayType(r)!==""}const Vx={extension:{type:Z.DetectionParser,priority:0},test:async()=>th("video/mp4"),add:async r=>[...r,"mp4","m4v"],remove:async r=>r.filter(t=>t!=="mp4"&&t!=="m4v")},zx={extension:{type:Z.DetectionParser,priority:0},test:async()=>th("video/ogg"),add:async r=>[...r,"ogv"],remove:async r=>r.filter(t=>t!=="ogv")},Xx={extension:{type:Z.DetectionParser,priority:0},test:async()=>th("video/webm"),add:async r=>[...r,"webm"],remove:async r=>r.filter(t=>t!=="webm")},Wx={extension:{type:Z.DetectionParser,priority:0},test:async()=>Pf("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async r=>[...r,"webp"],remove:async r=>r.filter(t=>t!=="webp")};class jx{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,i)=>(this._parsersValidated=!1,t[e]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const i={promise:null,parser:null};return i.promise=(async()=>{var a,o;let s=null,n=null;if(e.loadParser&&(n=this._parserHash[e.loadParser],n||Ot(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!n){for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];if(l.load&&((a=l.test)!=null&&a.call(l,t,e,this))){n=l;break}}if(!n)return Ot(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}s=await n.load(t,e,this),i.parser=n;for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];l.parse&&l.parse&&await((o=l.testParse)==null?void 0:o.call(l,s,e,this))&&(s=await l.parse(s,e,this)||s,i.parser=l)}return s})(),i}async load(t,e){this._parsersValidated||this._validateParsers();let i=0;const s={},n=Is(t),a=ce(t,l=>({alias:[l],src:l,data:{}})),o=a.length,h=a.map(async l=>{const c=re.toAbsolute(l.src);if(!s[l.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,l)),s[l.src]=await this.promiseCache[c].promise,e&&e(++i/o)}catch(u){throw delete this.promiseCache[c],delete s[l.src],new Error(`[Loader.load] Failed to load ${c}.
${u}`)}});return await Promise.all(h),n?s[a[0].src]:s}async unload(t){const i=ce(t,s=>({alias:[s],src:s})).map(async s=>{var o,h;const n=re.toAbsolute(s.src),a=this.promiseCache[n];if(a){const l=await a.promise;delete this.promiseCache[n],await((h=(o=a.parser)==null?void 0:o.unload)==null?void 0:h.call(o,l,s,this))}});await Promise.all(i)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(e.name?t[e.name]&&Ot(`[Assets] loadParser name conflict "${e.name}"`):Ot("[Assets] loadParser should have a name"),{...t,[e.name]:e}),{})}}function Hr(r,t){if(Array.isArray(t)){for(const e of t)if(r.startsWith(`data:${e}`))return!0;return!1}return r.startsWith(`data:${t}`)}function Vr(r,t){const e=r.split("?")[0],i=re.extname(e).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}const Yx=".json",qx="application/json",Kx={extension:{type:Z.LoadParser,priority:Ve.Low},name:"loadJson",test(r){return Hr(r,qx)||Vr(r,Yx)},async load(r){return await(await Ft.get().fetch(r)).json()}},Zx=".txt",Qx="text/plain",Jx={name:"loadTxt",extension:{type:Z.LoadParser,priority:Ve.Low,name:"loadTxt"},test(r){return Hr(r,Qx)||Vr(r,Zx)},async load(r){return await(await Ft.get().fetch(r)).text()}},t1=["normal","bold","100","200","300","400","500","600","700","800","900"],e1=[".ttf",".otf",".woff",".woff2"],r1=["font/ttf","font/otf","font/woff","font/woff2"],i1=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function s1(r){const t=re.extname(r),s=re.basename(r,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1));let n=s.length>0;for(const o of s)if(!o.match(i1)){n=!1;break}let a=s.join(" ");return n||(a=`"${a.replace(/[\\"]/g,"\\$&")}"`),a}const n1=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function a1(r){return n1.test(r)?r:encodeURI(r)}const o1={extension:{type:Z.LoadParser,priority:Ve.Low},name:"loadWebFont",test(r){return Hr(r,r1)||Vr(r,e1)},async load(r,t){var i,s,n;const e=Ft.get().getFontFaceSet();if(e){const a=[],o=((i=t.data)==null?void 0:i.family)??s1(r),h=((n=(s=t.data)==null?void 0:s.weights)==null?void 0:n.filter(c=>t1.includes(c)))??["normal"],l=t.data??{};for(let c=0;c<h.length;c++){const u=h[c],f=new FontFace(o,`url(${a1(r)})`,{...l,weight:u});await f.load(),e.add(f),a.push(f)}return Mt.set(`${o}-and-url`,{url:r,fontFaces:a}),a.length===1?a[0]:a}return Ot("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(r){(Array.isArray(r)?r:[r]).forEach(t=>{Mt.remove(t.family),Ft.get().getFontFaceSet().delete(t)})}};function eh(r,t=1){var i;const e=(i=$r.RETINA_PREFIX)==null?void 0:i.exec(r);return e?parseFloat(e[1]):t}function rh(r,t,e){r.label=e,r._sourceOrigin=e;const i=new ht({source:r,label:e}),s=()=>{delete t.promiseCache[e],Mt.has(e)&&Mt.remove(e)};return i.source.once("destroy",()=>{t.promiseCache[e]&&(Ot("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),s())}),i.once("destroy",()=>{r.destroyed||(Ot("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),s())}),i}const h1=".svg",l1="image/svg+xml",c1={extension:{type:Z.LoadParser,priority:Ve.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(r){return Hr(r,l1)||Vr(r,h1)},async load(r,t,e){return t.data.parseAsGraphicsContext??this.config.parseAsGraphicsContext?d1(r):u1(r,t,e,this.config.crossOrigin)},unload(r){r.destroy(!0)}};async function u1(r,t,e,i){var p,m,_;const n=await(await Ft.get().fetch(r)).blob(),a=URL.createObjectURL(n),o=new Image;o.src=a,o.crossOrigin=i,await o.decode(),URL.revokeObjectURL(a);const h=document.createElement("canvas"),l=h.getContext("2d"),c=((p=t.data)==null?void 0:p.resolution)||eh(r),u=((m=t.data)==null?void 0:m.width)??o.width,f=((_=t.data)==null?void 0:_.height)??o.height;h.width=u*c,h.height=f*c,l.drawImage(o,0,0,u*c,f*c);const{parseAsGraphicsContext:d,...g}=t.data,y=new Dr({resource:h,alphaMode:"premultiply-alpha-on-upload",resolution:c,...g});return rh(y,e,r)}async function d1(r){const e=await(await Ft.get().fetch(r)).text(),i=new Je;return i.svg(e),i}const f1=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let Rr=null,go=class{constructor(){Rr||(Rr=URL.createObjectURL(new Blob([f1],{type:"application/javascript"}))),this.worker=new Worker(Rr)}};go.revokeObjectURL=function(){Rr&&(URL.revokeObjectURL(Rr),Rr=null)};const p1=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let Mr=null;class Rf{constructor(){Mr||(Mr=URL.createObjectURL(new Blob([p1],{type:"application/javascript"}))),this.worker=new Worker(Mr)}}Rf.revokeObjectURL=function(){Mr&&(URL.revokeObjectURL(Mr),Mr=null)};let Rc=0,qn;class m1{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new go;e.addEventListener("message",i=>{e.terminate(),go.revokeObjectURL(),t(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t,e){var i;return this._run("loadImageBitmap",[t,(i=e==null?void 0:e.data)==null?void 0:i.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){qn===void 0&&(qn=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<qn&&(this._createdWorkers++,t=new Rf().worker,t.addEventListener("message",e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){t.error!==void 0?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),this._resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const i=new Promise((s,n)=>{this._queue.push({id:t,arguments:e,resolve:s,reject:n})});return this._next(),i}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const e=this._queue.pop(),i=e.id;this._resolveHash[Rc]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Rc++,id:i})}}const Mc=new m1,g1=[".jpeg",".jpg",".png",".webp",".avif"],y1=["image/jpeg","image/png","image/webp","image/avif"];async function _1(r,t){var s;const e=await Ft.get().fetch(r);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${r}: ${e.status} ${e.statusText}`);const i=await e.blob();return((s=t==null?void 0:t.data)==null?void 0:s.alphaMode)==="premultiplied-alpha"?createImageBitmap(i,{premultiplyAlpha:"none"}):createImageBitmap(i)}const Mf={name:"loadTextures",extension:{type:Z.LoadParser,priority:Ve.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(r){return Hr(r,y1)||Vr(r,g1)},async load(r,t,e){var n;let i=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Mc.isImageBitmapSupported()?i=await Mc.loadImageBitmap(r,t):i=await _1(r,t):i=await new Promise(a=>{i=new Image,i.crossOrigin=this.config.crossOrigin,i.src=r,i.complete?a(i):i.onload=()=>{a(i)}});const s=new Dr({resource:i,alphaMode:"premultiply-alpha-on-upload",resolution:((n=t.data)==null?void 0:n.resolution)||eh(r),...t.data});return rh(s,e,r)},unload(r){r.destroy(!0)}},Ff=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],x1=Ff.map(r=>`video/${r.substring(1)}`);function v1(r,t,e){e===void 0&&!t.startsWith("data:")?r.crossOrigin=w1(t):e!==!1&&(r.crossOrigin=typeof e=="string"?e:"anonymous")}function b1(r){return new Promise((t,e)=>{r.addEventListener("canplaythrough",i),r.addEventListener("error",s),r.load();function i(){n(),t()}function s(a){n(),e(a)}function n(){r.removeEventListener("canplaythrough",i),r.removeEventListener("error",s)}})}function w1(r,t=globalThis.location){if(r.startsWith("data:"))return"";t||(t=globalThis.location);const e=new URL(r,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}const A1={name:"loadVideo",extension:{type:Z.LoadParser,name:"loadVideo"},test(r){const t=Hr(r,x1),e=Vr(r,Ff);return t||e},async load(r,t,e){var h,l;const i={...fs.defaultOptions,resolution:((h=t.data)==null?void 0:h.resolution)||eh(r),alphaMode:((l=t.data)==null?void 0:l.alphaMode)||await Ld(),...t.data},s=document.createElement("video"),n={preload:i.autoLoad!==!1?"auto":void 0,"webkit-playsinline":i.playsinline!==!1?"":void 0,playsinline:i.playsinline!==!1?"":void 0,muted:i.muted===!0?"":void 0,loop:i.loop===!0?"":void 0,autoplay:i.autoPlay!==!1?"":void 0};Object.keys(n).forEach(c=>{const u=n[c];u!==void 0&&s.setAttribute(c,u)}),i.muted===!0&&(s.muted=!0),v1(s,r,i.crossorigin);const a=document.createElement("source");let o;if(r.startsWith("data:"))o=r.slice(5,r.indexOf(";"));else if(!r.startsWith("blob:")){const c=r.split("?")[0].slice(r.lastIndexOf(".")+1).toLowerCase();o=fs.MIME_TYPES[c]||`video/${c}`}return a.src=r,o&&(a.type=o),new Promise(c=>{const u=async()=>{const f=new fs({...i,resource:s});s.removeEventListener("canplay",u),t.data.preload&&await b1(s),c(rh(f,e,r))};s.addEventListener("canplay",u),s.appendChild(a)})},unload(r){r.destroy(!0)}},kf={extension:{type:Z.ResolveParser,name:"resolveTexture"},test:Mf.test,parse:r=>{var t;return{resolution:parseFloat(((t=$r.RETINA_PREFIX.exec(r))==null?void 0:t[1])??"1"),format:r.split(".").pop(),src:r}}},T1={extension:{type:Z.ResolveParser,priority:-2,name:"resolveJson"},test:r=>$r.RETINA_PREFIX.test(r)&&r.endsWith(".json"),parse:kf.parse};class S1{constructor(){this._detections=[],this._initialized=!1,this.resolver=new $r,this.loader=new jx,this.cache=Mt,this._backgroundLoader=new Ux(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var n,a;if(this._initialized){Ot("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let o=t.manifest;typeof o=="string"&&(o=await this.load(o)),this.resolver.addManifest(o)}const e=((n=t.texturePreference)==null?void 0:n.resolution)??1,i=typeof e=="number"?[e]:e,s=await this._detectFormats({preferredFormats:(a=t.texturePreference)==null?void 0:a.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:s,resolution:i}}),t.preferences&&this.setPreferences(t.preferences)}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const i=Is(t),s=ce(t).map(o=>{if(typeof o!="string"){const h=this.resolver.getAlias(o);return h.some(l=>!this.resolver.hasKey(l))&&this.add(o),Array.isArray(h)?h[0]:h}return this.resolver.hasKey(o)||this.add({alias:o,src:o}),o}),n=this.resolver.resolve(s),a=await this._mapLoadToResolve(n,e);return i?a[s[0]]:a}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);const s=this.resolver.resolveBundle(t),n={},a=Object.keys(s);let o=0,h=0;const l=()=>{e==null||e(++o/h)},c=a.map(u=>{const f=s[u];return h+=Object.keys(f).length,this._mapLoadToResolve(f,l).then(d=>{n[u]=d})});return await Promise.all(c),i?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Mt.get(t);const e={};for(let i=0;i<t.length;i++)e[i]=Mt.get(t[i]);return e}async _mapLoadToResolve(t,e){const i=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const s=await this.loader.load(i,e);this._backgroundLoader.active=!0;const n={};return i.forEach(a=>{const o=s[a.src],h=[a.src];a.alias&&h.push(...a.alias),h.forEach(l=>{n[l]=o}),Mt.set(h,o)}),n}async unload(t){this._initialized||await this.init();const e=ce(t).map(s=>typeof s!="string"?s.src:s),i=this.resolver.resolve(e);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=ce(t);const e=this.resolver.resolveBundle(t),i=Object.keys(e).map(s=>this._unloadFromResolved(e[s]));await Promise.all(i)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(i=>{Mt.remove(i.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const i of t.detections)t.skipDetections||await i.test()?e=await i.add(e):t.skipDetections||(e=await i.remove(e));return e=e.filter((i,s)=>e.indexOf(i)===s),e}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(i=>i in t).forEach(i=>{e.config[i]=t[i]})})}}const ai=new S1;Kt.handleByList(Z.LoadParser,ai.loader.parsers).handleByList(Z.ResolveParser,ai.resolver.parsers).handleByList(Z.CacheParser,ai.cache.parsers).handleByList(Z.DetectionParser,ai.detections);Kt.add(Gx,$x,Dx,Wx,Vx,zx,Xx,Kx,Jx,o1,c1,Mf,A1,Ox,Nx,kf,T1);const Fc={loader:Z.LoadParser,resolver:Z.ResolveParser,cache:Z.CacheParser,detection:Z.DetectionParser};Kt.handle(Z.Asset,r=>{const t=r.ref;Object.entries(Fc).filter(([e])=>!!t[e]).forEach(([e,i])=>Kt.add(Object.assign(t[e],{extension:t[e].extension??i})))},r=>{const t=r.ref;Object.keys(Fc).filter(e=>!!t[e]).forEach(e=>Kt.remove(t[e]))});function kc(r,t,e,i,s,n,a,o){const h=a-e,l=o-i,c=s-e,u=n-i,f=r-e,d=t-i,g=h*h+l*l,y=h*c+l*u,p=h*f+l*d,m=c*c+u*u,_=c*f+u*d,v=1/(g*m-y*y),A=(m*p-y*_)*v,x=(g*_-y*p)*v;return A>=0&&x>=0&&A+x<1}const Bf=class Lf extends Ko{constructor(...t){let e=t[0]??{};e instanceof Float32Array&&(wt(Rt,"use new MeshGeometry({ positions, uvs, indices }) instead"),e={positions:e,uvs:t[1],indices:t[2]}),e={...Lf.defaultOptions,...e};const i=e.positions||new Float32Array([0,0,1,0,1,1,0,1]),s=e.uvs||new Float32Array([0,0,1,0,1,1,0,1]),n=e.indices||new Uint32Array([0,1,2,0,2,3]),a=e.shrinkBuffersToFit,o=new De({data:i,label:"attribute-mesh-positions",shrinkToFit:a,usage:Lt.VERTEX|Lt.COPY_DST}),h=new De({data:s,label:"attribute-mesh-uvs",shrinkToFit:a,usage:Lt.VERTEX|Lt.COPY_DST}),l=new De({data:n,label:"index-mesh-buffer",shrinkToFit:a,usage:Lt.INDEX|Lt.COPY_DST});super({attributes:{aPosition:{buffer:o,format:"float32x2",stride:2*4,offset:0},aUV:{buffer:h,format:"float32x2",stride:2*4,offset:0}},indexBuffer:l,topology:e.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(t){this.attributes.aPosition.buffer.data=t}get uvs(){return this.attributes.aUV.buffer.data}set uvs(t){this.attributes.aUV.buffer.data=t}get indices(){return this.indexBuffer.data}set indices(t){this.indexBuffer.data=t}};Bf.defaultOptions={topology:"triangle-list",shrinkBuffersToFit:!1};let Nf=Bf;class C1 extends Cd{constructor(...t){let e=t[0];e instanceof Ko&&(wt(Rt,"Mesh: use new Mesh({ geometry, shader }) instead"),e={geometry:e,shader:t[1]},t[3]&&(wt(Rt,"Mesh: drawMode argument has been removed, use geometry.topology instead"),e.geometry.topology=t[3]));const{geometry:i,shader:s,texture:n,roundPixels:a,state:o,...h}=e;super({label:"Mesh",...h}),this.renderPipeId="mesh",this._shader=null,this.allowChildren=!1,this.shader=s??null,this.texture=n??(s==null?void 0:s.texture)??ht.WHITE,this.state=o??F_.for2d(),this._geometry=i,this._geometry.on("update",this.onViewUpdate,this),this.roundPixels=a??!1}get material(){return wt(Rt,"mesh.material property has been removed, use mesh.shader instead"),this._shader}set shader(t){this._shader!==t&&(this._shader=t,this.onViewUpdate())}get shader(){return this._shader}set geometry(t){var e;this._geometry!==t&&((e=this._geometry)==null||e.off("update",this.onViewUpdate,this),t.on("update",this.onViewUpdate,this),this._geometry=t,this.onViewUpdate())}get geometry(){return this._geometry}set texture(t){t||(t=ht.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this.shader&&(this.shader.texture=t),this._texture=t,this.onViewUpdate())}get texture(){return this._texture}get batched(){return this._shader||this.state.data&12?!1:this._geometry instanceof Nf?this._geometry.batchMode==="auto"?this._geometry.positions.length/2<=100:this._geometry.batchMode==="batch":!1}get bounds(){return this._geometry.bounds}updateBounds(){this._bounds=this._geometry.bounds}containsPoint(t){const{x:e,y:i}=t;if(!this.bounds.containsPoint(e,i))return!1;const s=this.geometry.getBuffer("aPosition").data,n=this.geometry.topology==="triangle-strip"?3:1;if(this.geometry.getIndex()){const a=this.geometry.getIndex().data,o=a.length;for(let h=0;h+2<o;h+=n){const l=a[h]*2,c=a[h+1]*2,u=a[h+2]*2;if(kc(e,i,s[l],s[l+1],s[c],s[c+1],s[u],s[u+1]))return!0}}else{const a=s.length/2;for(let o=0;o+2<a;o+=n){const h=o*2,l=(o+1)*2,c=(o+2)*2;if(kc(e,i,s[h],s[h+1],s[l],s[l+1],s[c],s[c+1]))return!0}}return!1}destroy(t){var i;if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(s)}(i=this._geometry)==null||i.off("update",this.onViewUpdate,this),this._texture=null,this._geometry=null,this._shader=null}}const Of=class Uf extends Nf{constructor(t){const{width:e,points:i,textureScale:s}={...Uf.defaultOptions,...t};super({positions:new Float32Array(i.length*4),uvs:new Float32Array(i.length*4),indices:new Uint32Array((i.length-1)*6)}),this.points=i,this._width=e,this.textureScale=s,this._build()}get width(){return this._width}_build(){const t=this.points;if(!t)return;const e=this.getBuffer("aPosition"),i=this.getBuffer("aUV"),s=this.getIndex();if(t.length<1)return;e.data.length/4!==t.length&&(e.data=new Float32Array(t.length*4),i.data=new Float32Array(t.length*4),s.data=new Uint16Array((t.length-1)*6));const n=i.data,a=s.data;n[0]=0,n[1]=0,n[2]=0,n[3]=1;let o=0,h=t[0];const l=this._width*this.textureScale,c=t.length;for(let f=0;f<c;f++){const d=f*4;if(this.textureScale>0){const g=h.x-t[f].x,y=h.y-t[f].y,p=Math.sqrt(g*g+y*y);h=t[f],o+=p/l}else o=f/(c-1);n[d]=o,n[d+1]=0,n[d+2]=o,n[d+3]=1}let u=0;for(let f=0;f<c-1;f++){const d=f*2;a[u++]=d,a[u++]=d+1,a[u++]=d+2,a[u++]=d+2,a[u++]=d+1,a[u++]=d+3}i.update(),s.update(),this.updateVertices()}updateVertices(){const t=this.points;if(t.length<1)return;let e=t[0],i,s=0,n=0;const a=this.buffers[0].data,o=t.length,h=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let l=0;l<o;l++){const c=t[l],u=l*4;l<t.length-1?i=t[l+1]:i=c,n=-(i.x-e.x),s=i.y-e.y;const f=Math.sqrt(s*s+n*n);f<1e-6?(s=0,n=0):(s/=f,n/=f,s*=h,n*=h),a[u]=c.x+s,a[u+1]=c.y+n,a[u+2]=c.x-s,a[u+3]=c.y-n,e=c}this.buffers[0].update()}update(){this.textureScale>0?this._build():this.updateVertices()}};Of.defaultOptions={width:200,points:[],textureScale:0};let E1=Of;const Gf=class Df extends C1{constructor(t){const{texture:e,points:i,textureScale:s,...n}={...Df.defaultOptions,...t},a=new E1(Ka({width:e.height,points:i,textureScale:s}));s>0&&(e.source.style.addressMode="repeat"),super(Ka({...n,texture:e,geometry:a})),this.autoUpdate=!0,this.onRender=this._render}_render(){const t=this.geometry;(this.autoUpdate||t._width!==this.texture.height)&&(t._width=this.texture.height,t.update())}};Gf.defaultOptions={textureScale:0};let I1=Gf;Kt.add(cy,uy);var dr=(r=>(r[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2",r))(dr||{}),$f=(r=>(r[r.UNKNOWN=0]="UNKNOWN",r[r.WEBGL=1]="WEBGL",r[r.CANVAS=2]="CANVAS",r))($f||{}),yo=(r=>(r[r.COLOR=16384]="COLOR",r[r.DEPTH=256]="DEPTH",r[r.STENCIL=1024]="STENCIL",r))(yo||{}),et=(r=>(r[r.NORMAL=0]="NORMAL",r[r.ADD=1]="ADD",r[r.MULTIPLY=2]="MULTIPLY",r[r.SCREEN=3]="SCREEN",r[r.OVERLAY=4]="OVERLAY",r[r.DARKEN=5]="DARKEN",r[r.LIGHTEN=6]="LIGHTEN",r[r.COLOR_DODGE=7]="COLOR_DODGE",r[r.COLOR_BURN=8]="COLOR_BURN",r[r.HARD_LIGHT=9]="HARD_LIGHT",r[r.SOFT_LIGHT=10]="SOFT_LIGHT",r[r.DIFFERENCE=11]="DIFFERENCE",r[r.EXCLUSION=12]="EXCLUSION",r[r.HUE=13]="HUE",r[r.SATURATION=14]="SATURATION",r[r.COLOR=15]="COLOR",r[r.LUMINOSITY=16]="LUMINOSITY",r[r.NORMAL_NPM=17]="NORMAL_NPM",r[r.ADD_NPM=18]="ADD_NPM",r[r.SCREEN_NPM=19]="SCREEN_NPM",r[r.NONE=20]="NONE",r[r.SRC_OVER=0]="SRC_OVER",r[r.SRC_IN=21]="SRC_IN",r[r.SRC_OUT=22]="SRC_OUT",r[r.SRC_ATOP=23]="SRC_ATOP",r[r.DST_OVER=24]="DST_OVER",r[r.DST_IN=25]="DST_IN",r[r.DST_OUT=26]="DST_OUT",r[r.DST_ATOP=27]="DST_ATOP",r[r.ERASE=26]="ERASE",r[r.SUBTRACT=28]="SUBTRACT",r[r.XOR=29]="XOR",r))(et||{}),Rs=(r=>(r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN",r))(Rs||{}),$=(r=>(r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.RG=33319]="RG",r[r.RED=6403]="RED",r[r.RGBA_INTEGER=36249]="RGBA_INTEGER",r[r.RGB_INTEGER=36248]="RGB_INTEGER",r[r.RG_INTEGER=33320]="RG_INTEGER",r[r.RED_INTEGER=36244]="RED_INTEGER",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL",r))($||{}),Fr=(r=>(r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",r))(Fr||{}),at=(r=>(r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.UNSIGNED_INT=5125]="UNSIGNED_INT",r[r.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",r[r.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",r[r.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",r[r.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",r[r.BYTE=5120]="BYTE",r[r.SHORT=5122]="SHORT",r[r.INT=5124]="INT",r[r.FLOAT=5126]="FLOAT",r[r.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",r[r.HALF_FLOAT=36193]="HALF_FLOAT",r))(at||{}),V=(r=>(r[r.FLOAT=0]="FLOAT",r[r.INT=1]="INT",r[r.UINT=2]="UINT",r))(V||{}),Ee=(r=>(r[r.NEAREST=0]="NEAREST",r[r.LINEAR=1]="LINEAR",r))(Ee||{}),ih=(r=>(r[r.CLAMP=33071]="CLAMP",r[r.REPEAT=10497]="REPEAT",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",r))(ih||{}),ur=(r=>(r[r.OFF=0]="OFF",r[r.POW2=1]="POW2",r[r.ON=2]="ON",r[r.ON_MANUAL=3]="ON_MANUAL",r))(ur||{}),fr=(r=>(r[r.NPM=0]="NPM",r[r.UNPACK=1]="UNPACK",r[r.PMA=2]="PMA",r[r.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",r[r.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",r[r.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",r))(fr||{}),tr=(r=>(r[r.NO=0]="NO",r[r.YES=1]="YES",r[r.AUTO=2]="AUTO",r[r.BLEND=0]="BLEND",r[r.CLEAR=1]="CLEAR",r[r.BLIT=2]="BLIT",r))(tr||{}),sh=(r=>(r[r.AUTO=0]="AUTO",r[r.MANUAL=1]="MANUAL",r))(sh||{}),se=(r=>(r.LOW="lowp",r.MEDIUM="mediump",r.HIGH="highp",r))(se||{}),Ut=(r=>(r[r.NONE=0]="NONE",r[r.SCISSOR=1]="SCISSOR",r[r.STENCIL=2]="STENCIL",r[r.SPRITE=3]="SPRITE",r[r.COLOR=4]="COLOR",r))(Ut||{}),Bt=(r=>(r[r.NONE=0]="NONE",r[r.LOW=2]="LOW",r[r.MEDIUM=4]="MEDIUM",r[r.HIGH=8]="HIGH",r))(Bt||{}),we=(r=>(r[r.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",r[r.ARRAY_BUFFER=34962]="ARRAY_BUFFER",r[r.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",r))(we||{});const P1={createCanvas:(r,t)=>{const e=document.createElement("canvas");return e.width=r,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(r,t)=>fetch(r,t),parseXML:r=>new DOMParser().parseFromString(r,"text/xml")},lt={ADAPTER:P1,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},R1=Wl.default??Wl,Cr=R1(globalThis.navigator);lt.RETINA_PREFIX=/@([0-9\.]+)x/;lt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Kn={exports:{}},Bc;function M1(){return Bc||(Bc=1,function(r){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function s(h,l,c){this.fn=h,this.context=l,this.once=c||!1}function n(h,l,c,u,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var d=new s(c,u||h,f),g=e?e+l:l;return h._events[g]?h._events[g].fn?h._events[g]=[h._events[g],d]:h._events[g].push(d):(h._events[g]=d,h._eventsCount++),h}function a(h,l){--h._eventsCount===0?h._events=new i:delete h._events[l]}function o(){this._events=new i,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],c,u;if(this._eventsCount===0)return l;for(u in c=this._events)t.call(c,u)&&l.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},o.prototype.listeners=function(l){var c=e?e+l:l,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var f=0,d=u.length,g=new Array(d);f<d;f++)g[f]=u[f].fn;return g},o.prototype.listenerCount=function(l){var c=e?e+l:l,u=this._events[c];return u?u.fn?1:u.length:0},o.prototype.emit=function(l,c,u,f,d,g){var y=e?e+l:l;if(!this._events[y])return!1;var p=this._events[y],m=arguments.length,_,v;if(p.fn){switch(p.once&&this.removeListener(l,p.fn,void 0,!0),m){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,c),!0;case 3:return p.fn.call(p.context,c,u),!0;case 4:return p.fn.call(p.context,c,u,f),!0;case 5:return p.fn.call(p.context,c,u,f,d),!0;case 6:return p.fn.call(p.context,c,u,f,d,g),!0}for(v=1,_=new Array(m-1);v<m;v++)_[v-1]=arguments[v];p.fn.apply(p.context,_)}else{var A=p.length,x;for(v=0;v<A;v++)switch(p[v].once&&this.removeListener(l,p[v].fn,void 0,!0),m){case 1:p[v].fn.call(p[v].context);break;case 2:p[v].fn.call(p[v].context,c);break;case 3:p[v].fn.call(p[v].context,c,u);break;case 4:p[v].fn.call(p[v].context,c,u,f);break;default:if(!_)for(x=1,_=new Array(m-1);x<m;x++)_[x-1]=arguments[x];p[v].fn.apply(p[v].context,_)}}return!0},o.prototype.on=function(l,c,u){return n(this,l,c,u,!1)},o.prototype.once=function(l,c,u){return n(this,l,c,u,!0)},o.prototype.removeListener=function(l,c,u,f){var d=e?e+l:l;if(!this._events[d])return this;if(!c)return a(this,d),this;var g=this._events[d];if(g.fn)g.fn===c&&(!f||g.once)&&(!u||g.context===u)&&a(this,d);else{for(var y=0,p=[],m=g.length;y<m;y++)(g[y].fn!==c||f&&!g[y].once||u&&g[y].context!==u)&&p.push(g[y]);p.length?this._events[d]=p.length===1?p[0]:p:a(this,d)}return this},o.prototype.removeAllListeners=function(l){var c;return l?(c=e?e+l:l,this._events[c]&&a(this,c)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=e,o.EventEmitter=o,r.exports=o}(Kn)),Kn.exports}var F1=M1();const js=Hs(F1);var We={},oi={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */var k1=oi.exports,Lc;function B1(){return Lc||(Lc=1,function(r,t){(function(e){var i=t&&!t.nodeType&&t,s=r&&!r.nodeType&&r,n=typeof Cs=="object"&&Cs;(n.global===n||n.window===n||n.self===n)&&(e=n);var a,o=2147483647,h=36,l=1,c=26,u=38,f=700,d=72,g=128,y="-",p=/^xn--/,m=/[^\x20-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,v={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},A=h-l,x=Math.floor,S=String.fromCharCode,b;function B(E){throw new RangeError(v[E])}function G(E,I){for(var R=E.length,F=[];R--;)F[R]=I(E[R]);return F}function L(E,I){var R=E.split("@"),F="";R.length>1&&(F=R[0]+"@",E=R[1]),E=E.replace(_,".");var U=E.split("."),D=G(U,I).join(".");return F+D}function O(E){for(var I=[],R=0,F=E.length,U,D;R<F;)U=E.charCodeAt(R++),U>=55296&&U<=56319&&R<F?(D=E.charCodeAt(R++),(D&64512)==56320?I.push(((U&1023)<<10)+(D&1023)+65536):(I.push(U),R--)):I.push(U);return I}function N(E){return G(E,function(I){var R="";return I>65535&&(I-=65536,R+=S(I>>>10&1023|55296),I=56320|I&1023),R+=S(I),R}).join("")}function j(E){return E-48<10?E-22:E-65<26?E-65:E-97<26?E-97:h}function J(E,I){return E+22+75*(E<26)-((I!=0)<<5)}function rt(E,I,R){var F=0;for(E=R?x(E/f):E>>1,E+=x(E/I);E>A*c>>1;F+=h)E=x(E/A);return x(F+(A+1)*E/(E+u))}function w(E){var I=[],R=E.length,F,U=0,D=g,H=d,X,W,q,z,it,st,gt,ft,K;for(X=E.lastIndexOf(y),X<0&&(X=0),W=0;W<X;++W)E.charCodeAt(W)>=128&&B("not-basic"),I.push(E.charCodeAt(W));for(q=X>0?X+1:0;q<R;){for(z=U,it=1,st=h;q>=R&&B("invalid-input"),gt=j(E.charCodeAt(q++)),(gt>=h||gt>x((o-U)/it))&&B("overflow"),U+=gt*it,ft=st<=H?l:st>=H+c?c:st-H,!(gt<ft);st+=h)K=h-ft,it>x(o/K)&&B("overflow"),it*=K;F=I.length+1,H=rt(U-z,F,z==0),x(U/F)>o-D&&B("overflow"),D+=x(U/F),U%=F,I.splice(U++,0,D)}return N(I)}function C(E){var I,R,F,U,D,H,X,W,q,z,it,st=[],gt,ft,K,tt;for(E=O(E),gt=E.length,I=g,R=0,D=d,H=0;H<gt;++H)it=E[H],it<128&&st.push(S(it));for(F=U=st.length,U&&st.push(y);F<gt;){for(X=o,H=0;H<gt;++H)it=E[H],it>=I&&it<X&&(X=it);for(ft=F+1,X-I>x((o-R)/ft)&&B("overflow"),R+=(X-I)*ft,I=X,H=0;H<gt;++H)if(it=E[H],it<I&&++R>o&&B("overflow"),it==I){for(W=R,q=h;z=q<=D?l:q>=D+c?c:q-D,!(W<z);q+=h)tt=W-z,K=h-z,st.push(S(J(z+tt%K,0))),W=x(tt/K);st.push(S(J(W,0))),D=rt(R,ft,F==U),R=0,++F}++R,++I}return st.join("")}function T(E){return L(E,function(I){return p.test(I)?w(I.slice(4).toLowerCase()):I})}function P(E){return L(E,function(I){return m.test(I)?"xn--"+C(I):I})}if(a={version:"1.4.1",ucs2:{decode:O,encode:N},decode:w,encode:C,toASCII:P,toUnicode:T},i&&s)if(r.exports==i)s.exports=a;else for(b in a)a.hasOwnProperty(b)&&(i[b]=a[b]);else e.punycode=a})(k1)}(oi,oi.exports)),oi.exports}var Zn,Nc;function L1(){return Nc||(Nc=1,Zn=Error),Zn}var Qn,Oc;function N1(){return Oc||(Oc=1,Qn=EvalError),Qn}var Jn,Uc;function O1(){return Uc||(Uc=1,Jn=RangeError),Jn}var ta,Gc;function U1(){return Gc||(Gc=1,ta=ReferenceError),ta}var ea,Dc;function Hf(){return Dc||(Dc=1,ea=SyntaxError),ea}var ra,$c;function Ii(){return $c||($c=1,ra=TypeError),ra}var ia,Hc;function G1(){return Hc||(Hc=1,ia=URIError),ia}var sa,Vc;function D1(){return Vc||(Vc=1,sa=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),i=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var s=42;t[e]=s;for(var n in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var a=Object.getOwnPropertySymbols(t);if(a.length!==1||a[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(t,e);if(o.value!==s||o.enumerable!==!0)return!1}return!0}),sa}var na,zc;function $1(){if(zc)return na;zc=1;var r=typeof Symbol<"u"&&Symbol,t=D1();return na=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},na}var aa,Xc;function H1(){if(Xc)return aa;Xc=1;var r={__proto__:null,foo:{}},t={__proto__:r}.foo===r.foo&&!(r instanceof Object);return aa=function(){return t},aa}var oa,Wc;function V1(){if(Wc)return oa;Wc=1;var r="Function.prototype.bind called on incompatible ",t=Object.prototype.toString,e=Math.max,i="[object Function]",s=function(h,l){for(var c=[],u=0;u<h.length;u+=1)c[u]=h[u];for(var f=0;f<l.length;f+=1)c[f+h.length]=l[f];return c},n=function(h,l){for(var c=[],u=l,f=0;u<h.length;u+=1,f+=1)c[f]=h[u];return c},a=function(o,h){for(var l="",c=0;c<o.length;c+=1)l+=o[c],c+1<o.length&&(l+=h);return l};return oa=function(h){var l=this;if(typeof l!="function"||t.apply(l)!==i)throw new TypeError(r+l);for(var c=n(arguments,1),u,f=function(){if(this instanceof u){var m=l.apply(this,s(c,arguments));return Object(m)===m?m:this}return l.apply(h,s(c,arguments))},d=e(0,l.length-c.length),g=[],y=0;y<d;y++)g[y]="$"+y;if(u=Function("binder","return function ("+a(g,",")+"){ return binder.apply(this,arguments); }")(f),l.prototype){var p=function(){};p.prototype=l.prototype,u.prototype=new p,p.prototype=null}return u},oa}var ha,jc;function nh(){if(jc)return ha;jc=1;var r=V1();return ha=Function.prototype.bind||r,ha}var la,Yc;function z1(){if(Yc)return la;Yc=1;var r=Function.prototype.call,t=Object.prototype.hasOwnProperty,e=nh();return la=e.call(r,t),la}var ca,qc;function Pi(){if(qc)return ca;qc=1;var r,t=L1(),e=N1(),i=O1(),s=U1(),n=Hf(),a=Ii(),o=G1(),h=Function,l=function(C){try{return h('"use strict"; return ('+C+").constructor;")()}catch{}},c=Object.getOwnPropertyDescriptor;if(c)try{c({},"")}catch{c=null}var u=function(){throw new a},f=c?function(){try{return arguments.callee,u}catch{try{return c(arguments,"callee").get}catch{return u}}}():u,d=$1()(),g=H1()(),y=Object.getPrototypeOf||(g?function(C){return C.__proto__}:null),p={},m=typeof Uint8Array>"u"||!y?r:y(Uint8Array),_={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?r:ArrayBuffer,"%ArrayIteratorPrototype%":d&&y?y([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":p,"%AsyncGenerator%":p,"%AsyncGeneratorFunction%":p,"%AsyncIteratorPrototype%":p,"%Atomics%":typeof Atomics>"u"?r:Atomics,"%BigInt%":typeof BigInt>"u"?r:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?r:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":e,"%Float32Array%":typeof Float32Array>"u"?r:Float32Array,"%Float64Array%":typeof Float64Array>"u"?r:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?r:FinalizationRegistry,"%Function%":h,"%GeneratorFunction%":p,"%Int8Array%":typeof Int8Array>"u"?r:Int8Array,"%Int16Array%":typeof Int16Array>"u"?r:Int16Array,"%Int32Array%":typeof Int32Array>"u"?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":d&&y?y(y([][Symbol.iterator]())):r,"%JSON%":typeof JSON=="object"?JSON:r,"%Map%":typeof Map>"u"?r:Map,"%MapIteratorPrototype%":typeof Map>"u"||!d||!y?r:y(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?r:Promise,"%Proxy%":typeof Proxy>"u"?r:Proxy,"%RangeError%":i,"%ReferenceError%":s,"%Reflect%":typeof Reflect>"u"?r:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?r:Set,"%SetIteratorPrototype%":typeof Set>"u"||!d||!y?r:y(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":d&&y?y(""[Symbol.iterator]()):r,"%Symbol%":d?Symbol:r,"%SyntaxError%":n,"%ThrowTypeError%":f,"%TypedArray%":m,"%TypeError%":a,"%Uint8Array%":typeof Uint8Array>"u"?r:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?r:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?r:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?r:Uint32Array,"%URIError%":o,"%WeakMap%":typeof WeakMap>"u"?r:WeakMap,"%WeakRef%":typeof WeakRef>"u"?r:WeakRef,"%WeakSet%":typeof WeakSet>"u"?r:WeakSet};if(y)try{null.error}catch(C){var v=y(y(C));_["%Error.prototype%"]=v}var A=function C(T){var P;if(T==="%AsyncFunction%")P=l("async function () {}");else if(T==="%GeneratorFunction%")P=l("function* () {}");else if(T==="%AsyncGeneratorFunction%")P=l("async function* () {}");else if(T==="%AsyncGenerator%"){var E=C("%AsyncGeneratorFunction%");E&&(P=E.prototype)}else if(T==="%AsyncIteratorPrototype%"){var I=C("%AsyncGenerator%");I&&y&&(P=y(I.prototype))}return _[T]=P,P},x={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},S=nh(),b=z1(),B=S.call(Function.call,Array.prototype.concat),G=S.call(Function.apply,Array.prototype.splice),L=S.call(Function.call,String.prototype.replace),O=S.call(Function.call,String.prototype.slice),N=S.call(Function.call,RegExp.prototype.exec),j=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,J=/\\(\\)?/g,rt=function(T){var P=O(T,0,1),E=O(T,-1);if(P==="%"&&E!=="%")throw new n("invalid intrinsic syntax, expected closing `%`");if(E==="%"&&P!=="%")throw new n("invalid intrinsic syntax, expected opening `%`");var I=[];return L(T,j,function(R,F,U,D){I[I.length]=U?L(D,J,"$1"):F||R}),I},w=function(T,P){var E=T,I;if(b(x,E)&&(I=x[E],E="%"+I[0]+"%"),b(_,E)){var R=_[E];if(R===p&&(R=A(E)),typeof R>"u"&&!P)throw new a("intrinsic "+T+" exists, but is not available. Please file an issue!");return{alias:I,name:E,value:R}}throw new n("intrinsic "+T+" does not exist!")};return ca=function(T,P){if(typeof T!="string"||T.length===0)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof P!="boolean")throw new a('"allowMissing" argument must be a boolean');if(N(/^%?[^%]*%?$/,T)===null)throw new n("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var E=rt(T),I=E.length>0?E[0]:"",R=w("%"+I+"%",P),F=R.name,U=R.value,D=!1,H=R.alias;H&&(I=H[0],G(E,B([0,1],H)));for(var X=1,W=!0;X<E.length;X+=1){var q=E[X],z=O(q,0,1),it=O(q,-1);if((z==='"'||z==="'"||z==="`"||it==='"'||it==="'"||it==="`")&&z!==it)throw new n("property names with quotes must have matching quotes");if((q==="constructor"||!W)&&(D=!0),I+="."+q,F="%"+I+"%",b(_,F))U=_[F];else if(U!=null){if(!(q in U)){if(!P)throw new a("base intrinsic for "+T+" exists, but the property is not available.");return}if(c&&X+1>=E.length){var st=c(U,q);W=!!st,W&&"get"in st&&!("originalValue"in st.get)?U=st.get:U=U[q]}else W=b(U,q),U=U[q];W&&!D&&(_[F]=U)}}return U},ca}var ua={exports:{}},da,Kc;function ah(){if(Kc)return da;Kc=1;var r=Pi(),t=r("%Object.defineProperty%",!0)||!1;if(t)try{t({},"a",{value:1})}catch{t=!1}return da=t,da}var fa,Zc;function X1(){return Zc||(Zc=1,fa=Object.getOwnPropertyDescriptor),fa}var pa,Qc;function Vf(){if(Qc)return pa;Qc=1;var r=X1();if(r)try{r([],"length")}catch{r=null}return pa=r,pa}var ma,Jc;function W1(){if(Jc)return ma;Jc=1;var r=ah(),t=Hf(),e=Ii(),i=Vf();return ma=function(n,a,o){if(!n||typeof n!="object"&&typeof n!="function")throw new e("`obj` must be an object or a function`");if(typeof a!="string"&&typeof a!="symbol")throw new e("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new e("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new e("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new e("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new e("`loose`, if provided, must be a boolean");var h=arguments.length>3?arguments[3]:null,l=arguments.length>4?arguments[4]:null,c=arguments.length>5?arguments[5]:null,u=arguments.length>6?arguments[6]:!1,f=!!i&&i(n,a);if(r)r(n,a,{configurable:c===null&&f?f.configurable:!c,enumerable:h===null&&f?f.enumerable:!h,value:o,writable:l===null&&f?f.writable:!l});else if(u||!h&&!l&&!c)n[a]=o;else throw new t("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},ma}var ga,tu;function j1(){if(tu)return ga;tu=1;var r=ah(),t=function(){return!!r};return t.hasArrayLengthDefineBug=function(){if(!r)return null;try{return r([],"length",{value:1}).length!==1}catch{return!0}},ga=t,ga}var ya,eu;function Y1(){if(eu)return ya;eu=1;var r=Pi(),t=W1(),e=j1()(),i=Vf(),s=Ii(),n=r("%Math.floor%");return ya=function(o,h){if(typeof o!="function")throw new s("`fn` is not a function");if(typeof h!="number"||h<0||h>4294967295||n(h)!==h)throw new s("`length` must be a positive 32-bit integer");var l=arguments.length>2&&!!arguments[2],c=!0,u=!0;if("length"in o&&i){var f=i(o,"length");f&&!f.configurable&&(c=!1),f&&!f.writable&&(u=!1)}return(c||u||!l)&&(e?t(o,"length",h,!0,!0):t(o,"length",h)),o},ya}var ru;function q1(){return ru||(ru=1,function(r){var t=nh(),e=Pi(),i=Y1(),s=Ii(),n=e("%Function.prototype.apply%"),a=e("%Function.prototype.call%"),o=e("%Reflect.apply%",!0)||t.call(a,n),h=ah(),l=e("%Math.max%");r.exports=function(f){if(typeof f!="function")throw new s("a function is required");var d=o(t,a,arguments);return i(d,1+l(0,f.length-(arguments.length-1)),!0)};var c=function(){return o(t,n,arguments)};h?h(r.exports,"apply",{value:c}):r.exports.apply=c}(ua)),ua.exports}var _a,iu;function K1(){if(iu)return _a;iu=1;var r=Pi(),t=q1(),e=t(r("String.prototype.indexOf"));return _a=function(s,n){var a=r(s,!!n);return typeof a=="function"&&e(s,".prototype.")>-1?t(a):a},_a}const Z1={},Q1=Object.freeze(Object.defineProperty({__proto__:null,default:Z1},Symbol.toStringTag,{value:"Module"})),J1=dy(Q1);var xa,su;function tv(){if(su)return xa;su=1;var r=typeof Map=="function"&&Map.prototype,t=Object.getOwnPropertyDescriptor&&r?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,e=r&&t&&typeof t.get=="function"?t.get:null,i=r&&Map.prototype.forEach,s=typeof Set=="function"&&Set.prototype,n=Object.getOwnPropertyDescriptor&&s?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,a=s&&n&&typeof n.get=="function"?n.get:null,o=s&&Set.prototype.forEach,h=typeof WeakMap=="function"&&WeakMap.prototype,l=h?WeakMap.prototype.has:null,c=typeof WeakSet=="function"&&WeakSet.prototype,u=c?WeakSet.prototype.has:null,f=typeof WeakRef=="function"&&WeakRef.prototype,d=f?WeakRef.prototype.deref:null,g=Boolean.prototype.valueOf,y=Object.prototype.toString,p=Function.prototype.toString,m=String.prototype.match,_=String.prototype.slice,v=String.prototype.replace,A=String.prototype.toUpperCase,x=String.prototype.toLowerCase,S=RegExp.prototype.test,b=Array.prototype.concat,B=Array.prototype.join,G=Array.prototype.slice,L=Math.floor,O=typeof BigInt=="function"?BigInt.prototype.valueOf:null,N=Object.getOwnPropertySymbols,j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,J=typeof Symbol=="function"&&typeof Symbol.iterator=="object",rt=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===J||!0)?Symbol.toStringTag:null,w=Object.prototype.propertyIsEnumerable,C=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(M){return M.__proto__}:null);function T(M,k){if(M===1/0||M===-1/0||M!==M||M&&M>-1e3&&M<1e3||S.call(/e/,k))return k;var dt=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof M=="number"){var bt=M<0?-L(-M):L(M);if(bt!==M){var Tt=String(bt),nt=_.call(k,Tt.length+1);return v.call(Tt,dt,"$&_")+"."+v.call(v.call(nt,/([0-9]{3})/g,"$&_"),/_$/,"")}}return v.call(k,dt,"$&_")}var P=J1,E=P.custom,I=gt(E)?E:null,R={__proto__:null,double:'"',single:"'"},F={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};xa=function M(k,dt,bt,Tt){var nt=dt||{};if(tt(nt,"quoteStyle")&&!tt(R,nt.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(tt(nt,"maxStringLength")&&(typeof nt.maxStringLength=="number"?nt.maxStringLength<0&&nt.maxStringLength!==1/0:nt.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var Be=tt(nt,"customInspect")?nt.customInspect:!0;if(typeof Be!="boolean"&&Be!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(tt(nt,"indent")&&nt.indent!==null&&nt.indent!=="	"&&!(parseInt(nt.indent,10)===nt.indent&&nt.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(tt(nt,"numericSeparator")&&typeof nt.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var ze=nt.numericSeparator;if(typeof k>"u")return"undefined";if(k===null)return"null";if(typeof k=="boolean")return k?"true":"false";if(typeof k=="string")return Lh(k,nt);if(typeof k=="number"){if(k===0)return 1/0/k>0?"0":"-0";var Jt=String(k);return ze?T(k,Jt):Jt}if(typeof k=="bigint"){var Le=String(k)+"n";return ze?T(k,Le):Le}var en=typeof nt.depth>"u"?5:nt.depth;if(typeof bt>"u"&&(bt=0),bt>=en&&en>0&&typeof k=="object")return H(k)?"[Array]":"[Object]";var pr=Hp(nt,bt);if(typeof Tt>"u")Tt=[];else if(Qs(Tt,k)>=0)return"[Circular]";function ne(mr,Bi,zp){if(Bi&&(Tt=G.call(Tt),Tt.push(Bi)),zp){var zh={depth:nt.depth};return tt(nt,"quoteStyle")&&(zh.quoteStyle=nt.quoteStyle),M(mr,zh,bt+1,Tt)}return M(mr,nt,bt+1,Tt)}if(typeof k=="function"&&!W(k)){var Oh=Xr(k),Uh=Fi(k,ne);return"[Function"+(Oh?": "+Oh:" (anonymous)")+"]"+(Uh.length>0?" { "+B.call(Uh,", ")+" }":"")}if(gt(k)){var Gh=J?v.call(String(k),/^(Symbol\(.*\))_[^)]*$/,"$1"):j.call(k);return typeof k=="object"&&!J?Wr(Gh):Gh}if(Gp(k)){for(var jr="<"+x.call(String(k.nodeName)),rn=k.attributes||[],ki=0;ki<rn.length;ki++)jr+=" "+rn[ki].name+"="+U(D(rn[ki].value),"double",nt);return jr+=">",k.childNodes&&k.childNodes.length&&(jr+="..."),jr+="</"+x.call(String(k.nodeName))+">",jr}if(H(k)){if(k.length===0)return"[]";var sn=Fi(k,ne);return pr&&!$p(sn)?"["+tn(sn,pr)+"]":"[ "+B.call(sn,", ")+" ]"}if(q(k)){var nn=Fi(k,ne);return!("cause"in Error.prototype)&&"cause"in k&&!w.call(k,"cause")?"{ ["+String(k)+"] "+B.call(b.call("[cause]: "+ne(k.cause),nn),", ")+" }":nn.length===0?"["+String(k)+"]":"{ ["+String(k)+"] "+B.call(nn,", ")+" }"}if(typeof k=="object"&&Be){if(I&&typeof k[I]=="function"&&P)return P(k,{depth:en-bt});if(Be!=="symbol"&&typeof k.inspect=="function")return k.inspect()}if(Bp(k)){var Dh=[];return i&&i.call(k,function(mr,Bi){Dh.push(ne(Bi,k,!0)+" => "+ne(mr,k))}),Nh("Map",e.call(k),Dh,pr)}if(Op(k)){var $h=[];return o&&o.call(k,function(mr){$h.push(ne(mr,k))}),Nh("Set",a.call(k),$h,pr)}if(Lp(k))return Js("WeakMap");if(Up(k))return Js("WeakSet");if(Np(k))return Js("WeakRef");if(it(k))return Wr(ne(Number(k)));if(ft(k))return Wr(ne(O.call(k)));if(st(k))return Wr(g.call(k));if(z(k))return Wr(ne(String(k)));if(typeof window<"u"&&k===window)return"{ [object Window] }";if(typeof globalThis<"u"&&k===globalThis||typeof Cs<"u"&&k===Cs)return"{ [object globalThis] }";if(!X(k)&&!W(k)){var an=Fi(k,ne),Hh=C?C(k)===Object.prototype:k instanceof Object||k.constructor===Object,on=k instanceof Object?"":"null prototype",Vh=!Hh&&rt&&Object(k)===k&&rt in k?_.call(zt(k),8,-1):on?"Object":"",Vp=Hh||typeof k.constructor!="function"?"":k.constructor.name?k.constructor.name+" ":"",hn=Vp+(Vh||on?"["+B.call(b.call([],Vh||[],on||[]),": ")+"] ":"");return an.length===0?hn+"{}":pr?hn+"{"+tn(an,pr)+"}":hn+"{ "+B.call(an,", ")+" }"}return String(k)};function U(M,k,dt){var bt=dt.quoteStyle||k,Tt=R[bt];return Tt+M+Tt}function D(M){return v.call(String(M),/"/g,"&quot;")}function H(M){return zt(M)==="[object Array]"&&(!rt||!(typeof M=="object"&&rt in M))}function X(M){return zt(M)==="[object Date]"&&(!rt||!(typeof M=="object"&&rt in M))}function W(M){return zt(M)==="[object RegExp]"&&(!rt||!(typeof M=="object"&&rt in M))}function q(M){return zt(M)==="[object Error]"&&(!rt||!(typeof M=="object"&&rt in M))}function z(M){return zt(M)==="[object String]"&&(!rt||!(typeof M=="object"&&rt in M))}function it(M){return zt(M)==="[object Number]"&&(!rt||!(typeof M=="object"&&rt in M))}function st(M){return zt(M)==="[object Boolean]"&&(!rt||!(typeof M=="object"&&rt in M))}function gt(M){if(J)return M&&typeof M=="object"&&M instanceof Symbol;if(typeof M=="symbol")return!0;if(!M||typeof M!="object"||!j)return!1;try{return j.call(M),!0}catch{}return!1}function ft(M){if(!M||typeof M!="object"||!O)return!1;try{return O.call(M),!0}catch{}return!1}var K=Object.prototype.hasOwnProperty||function(M){return M in this};function tt(M,k){return K.call(M,k)}function zt(M){return y.call(M)}function Xr(M){if(M.name)return M.name;var k=m.call(p.call(M),/^function\s*([\w$]+)/);return k?k[1]:null}function Qs(M,k){if(M.indexOf)return M.indexOf(k);for(var dt=0,bt=M.length;dt<bt;dt++)if(M[dt]===k)return dt;return-1}function Bp(M){if(!e||!M||typeof M!="object")return!1;try{e.call(M);try{a.call(M)}catch{return!0}return M instanceof Map}catch{}return!1}function Lp(M){if(!l||!M||typeof M!="object")return!1;try{l.call(M,l);try{u.call(M,u)}catch{return!0}return M instanceof WeakMap}catch{}return!1}function Np(M){if(!d||!M||typeof M!="object")return!1;try{return d.call(M),!0}catch{}return!1}function Op(M){if(!a||!M||typeof M!="object")return!1;try{a.call(M);try{e.call(M)}catch{return!0}return M instanceof Set}catch{}return!1}function Up(M){if(!u||!M||typeof M!="object")return!1;try{u.call(M,u);try{l.call(M,l)}catch{return!0}return M instanceof WeakSet}catch{}return!1}function Gp(M){return!M||typeof M!="object"?!1:typeof HTMLElement<"u"&&M instanceof HTMLElement?!0:typeof M.nodeName=="string"&&typeof M.getAttribute=="function"}function Lh(M,k){if(M.length>k.maxStringLength){var dt=M.length-k.maxStringLength,bt="... "+dt+" more character"+(dt>1?"s":"");return Lh(_.call(M,0,k.maxStringLength),k)+bt}var Tt=F[k.quoteStyle||"single"];Tt.lastIndex=0;var nt=v.call(v.call(M,Tt,"\\$1"),/[\x00-\x1f]/g,Dp);return U(nt,"single",k)}function Dp(M){var k=M.charCodeAt(0),dt={8:"b",9:"t",10:"n",12:"f",13:"r"}[k];return dt?"\\"+dt:"\\x"+(k<16?"0":"")+A.call(k.toString(16))}function Wr(M){return"Object("+M+")"}function Js(M){return M+" { ? }"}function Nh(M,k,dt,bt){var Tt=bt?tn(dt,bt):B.call(dt,", ");return M+" ("+k+") {"+Tt+"}"}function $p(M){for(var k=0;k<M.length;k++)if(Qs(M[k],`
`)>=0)return!1;return!0}function Hp(M,k){var dt;if(M.indent==="	")dt="	";else if(typeof M.indent=="number"&&M.indent>0)dt=B.call(Array(M.indent+1)," ");else return null;return{base:dt,prev:B.call(Array(k+1),dt)}}function tn(M,k){if(M.length===0)return"";var dt=`
`+k.prev+k.base;return dt+B.call(M,","+dt)+`
`+k.prev}function Fi(M,k){var dt=H(M),bt=[];if(dt){bt.length=M.length;for(var Tt=0;Tt<M.length;Tt++)bt[Tt]=tt(M,Tt)?k(M[Tt],M):""}var nt=typeof N=="function"?N(M):[],Be;if(J){Be={};for(var ze=0;ze<nt.length;ze++)Be["$"+nt[ze]]=nt[ze]}for(var Jt in M)tt(M,Jt)&&(dt&&String(Number(Jt))===Jt&&Jt<M.length||J&&Be["$"+Jt]instanceof Symbol||(S.call(/[^\w$]/,Jt)?bt.push(k(Jt,M)+": "+k(M[Jt],M)):bt.push(Jt+": "+k(M[Jt],M))));if(typeof N=="function")for(var Le=0;Le<nt.length;Le++)w.call(M,nt[Le])&&bt.push("["+k(nt[Le])+"]: "+k(M[nt[Le]],M));return bt}return xa}var va,nu;function ev(){if(nu)return va;nu=1;var r=Pi(),t=K1(),e=tv(),i=Ii(),s=r("%WeakMap%",!0),n=r("%Map%",!0),a=t("WeakMap.prototype.get",!0),o=t("WeakMap.prototype.set",!0),h=t("WeakMap.prototype.has",!0),l=t("Map.prototype.get",!0),c=t("Map.prototype.set",!0),u=t("Map.prototype.has",!0),f=function(p,m){for(var _=p,v;(v=_.next)!==null;_=v)if(v.key===m)return _.next=v.next,v.next=p.next,p.next=v,v},d=function(p,m){var _=f(p,m);return _&&_.value},g=function(p,m,_){var v=f(p,m);v?v.value=_:p.next={key:m,next:p.next,value:_}},y=function(p,m){return!!f(p,m)};return va=function(){var m,_,v,A={assert:function(x){if(!A.has(x))throw new i("Side channel does not contain "+e(x))},get:function(x){if(s&&x&&(typeof x=="object"||typeof x=="function")){if(m)return a(m,x)}else if(n){if(_)return l(_,x)}else if(v)return d(v,x)},has:function(x){if(s&&x&&(typeof x=="object"||typeof x=="function")){if(m)return h(m,x)}else if(n){if(_)return u(_,x)}else if(v)return y(v,x);return!1},set:function(x,S){s&&x&&(typeof x=="object"||typeof x=="function")?(m||(m=new s),o(m,x,S)):n?(_||(_=new n),c(_,x,S)):(v||(v={key:{},next:null}),g(v,x,S))}};return A},va}var ba,au;function oh(){if(au)return ba;au=1;var r=String.prototype.replace,t=/%20/g,e={RFC1738:"RFC1738",RFC3986:"RFC3986"};return ba={default:e.RFC3986,formatters:{RFC1738:function(i){return r.call(i,t,"+")},RFC3986:function(i){return String(i)}},RFC1738:e.RFC1738,RFC3986:e.RFC3986},ba}var wa,ou;function zf(){if(ou)return wa;ou=1;var r=oh(),t=Object.prototype.hasOwnProperty,e=Array.isArray,i=function(){for(var p=[],m=0;m<256;++m)p.push("%"+((m<16?"0":"")+m.toString(16)).toUpperCase());return p}(),s=function(m){for(;m.length>1;){var _=m.pop(),v=_.obj[_.prop];if(e(v)){for(var A=[],x=0;x<v.length;++x)typeof v[x]<"u"&&A.push(v[x]);_.obj[_.prop]=A}}},n=function(m,_){for(var v=_&&_.plainObjects?{__proto__:null}:{},A=0;A<m.length;++A)typeof m[A]<"u"&&(v[A]=m[A]);return v},a=function p(m,_,v){if(!_)return m;if(typeof _!="object"&&typeof _!="function"){if(e(m))m.push(_);else if(m&&typeof m=="object")(v&&(v.plainObjects||v.allowPrototypes)||!t.call(Object.prototype,_))&&(m[_]=!0);else return[m,_];return m}if(!m||typeof m!="object")return[m].concat(_);var A=m;return e(m)&&!e(_)&&(A=n(m,v)),e(m)&&e(_)?(_.forEach(function(x,S){if(t.call(m,S)){var b=m[S];b&&typeof b=="object"&&x&&typeof x=="object"?m[S]=p(b,x,v):m.push(x)}else m[S]=x}),m):Object.keys(_).reduce(function(x,S){var b=_[S];return t.call(x,S)?x[S]=p(x[S],b,v):x[S]=b,x},A)},o=function(m,_){return Object.keys(_).reduce(function(v,A){return v[A]=_[A],v},m)},h=function(p,m,_){var v=p.replace(/\+/g," ");if(_==="iso-8859-1")return v.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(v)}catch{return v}},l=1024,c=function(m,_,v,A,x){if(m.length===0)return m;var S=m;if(typeof m=="symbol"?S=Symbol.prototype.toString.call(m):typeof m!="string"&&(S=String(m)),v==="iso-8859-1")return escape(S).replace(/%u[0-9a-f]{4}/gi,function(j){return"%26%23"+parseInt(j.slice(2),16)+"%3B"});for(var b="",B=0;B<S.length;B+=l){for(var G=S.length>=l?S.slice(B,B+l):S,L=[],O=0;O<G.length;++O){var N=G.charCodeAt(O);if(N===45||N===46||N===95||N===126||N>=48&&N<=57||N>=65&&N<=90||N>=97&&N<=122||x===r.RFC1738&&(N===40||N===41)){L[L.length]=G.charAt(O);continue}if(N<128){L[L.length]=i[N];continue}if(N<2048){L[L.length]=i[192|N>>6]+i[128|N&63];continue}if(N<55296||N>=57344){L[L.length]=i[224|N>>12]+i[128|N>>6&63]+i[128|N&63];continue}O+=1,N=65536+((N&1023)<<10|G.charCodeAt(O)&1023),L[L.length]=i[240|N>>18]+i[128|N>>12&63]+i[128|N>>6&63]+i[128|N&63]}b+=L.join("")}return b},u=function(m){for(var _=[{obj:{o:m},prop:"o"}],v=[],A=0;A<_.length;++A)for(var x=_[A],S=x.obj[x.prop],b=Object.keys(S),B=0;B<b.length;++B){var G=b[B],L=S[G];typeof L=="object"&&L!==null&&v.indexOf(L)===-1&&(_.push({obj:S,prop:G}),v.push(L))}return s(_),m},f=function(m){return Object.prototype.toString.call(m)==="[object RegExp]"},d=function(m){return!m||typeof m!="object"?!1:!!(m.constructor&&m.constructor.isBuffer&&m.constructor.isBuffer(m))},g=function(m,_){return[].concat(m,_)},y=function(m,_){if(e(m)){for(var v=[],A=0;A<m.length;A+=1)v.push(_(m[A]));return v}return _(m)};return wa={arrayToObject:n,assign:o,combine:g,compact:u,decode:h,encode:c,isBuffer:d,isRegExp:f,maybeMap:y,merge:a},wa}var Aa,hu;function rv(){if(hu)return Aa;hu=1;var r=ev(),t=zf(),e=oh(),i=Object.prototype.hasOwnProperty,s={brackets:function(p){return p+"[]"},comma:"comma",indices:function(p,m){return p+"["+m+"]"},repeat:function(p){return p}},n=Array.isArray,a=Array.prototype.push,o=function(y,p){a.apply(y,n(p)?p:[p])},h=Date.prototype.toISOString,l=e.default,c={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:t.encode,encodeValuesOnly:!1,filter:void 0,format:l,formatter:e.formatters[l],indices:!1,serializeDate:function(p){return h.call(p)},skipNulls:!1,strictNullHandling:!1},u=function(p){return typeof p=="string"||typeof p=="number"||typeof p=="boolean"||typeof p=="symbol"||typeof p=="bigint"},f={},d=function y(p,m,_,v,A,x,S,b,B,G,L,O,N,j,J,rt,w,C){for(var T=p,P=C,E=0,I=!1;(P=P.get(f))!==void 0&&!I;){var R=P.get(p);if(E+=1,typeof R<"u"){if(R===E)throw new RangeError("Cyclic object value");I=!0}typeof P.get(f)>"u"&&(E=0)}if(typeof G=="function"?T=G(m,T):T instanceof Date?T=N(T):_==="comma"&&n(T)&&(T=t.maybeMap(T,function(K){return K instanceof Date?N(K):K})),T===null){if(x)return B&&!rt?B(m,c.encoder,w,"key",j):m;T=""}if(u(T)||t.isBuffer(T)){if(B){var F=rt?m:B(m,c.encoder,w,"key",j);return[J(F)+"="+J(B(T,c.encoder,w,"value",j))]}return[J(m)+"="+J(String(T))]}var U=[];if(typeof T>"u")return U;var D;if(_==="comma"&&n(T))rt&&B&&(T=t.maybeMap(T,B)),D=[{value:T.length>0?T.join(",")||null:void 0}];else if(n(G))D=G;else{var H=Object.keys(T);D=L?H.sort(L):H}var X=b?String(m).replace(/\./g,"%2E"):String(m),W=v&&n(T)&&T.length===1?X+"[]":X;if(A&&n(T)&&T.length===0)return W+"[]";for(var q=0;q<D.length;++q){var z=D[q],it=typeof z=="object"&&z&&typeof z.value<"u"?z.value:T[z];if(!(S&&it===null)){var st=O&&b?String(z).replace(/\./g,"%2E"):String(z),gt=n(T)?typeof _=="function"?_(W,st):W:W+(O?"."+st:"["+st+"]");C.set(p,E);var ft=r();ft.set(f,C),o(U,y(it,gt,_,v,A,x,S,b,_==="comma"&&rt&&n(T)?null:B,G,L,O,N,j,J,rt,w,ft))}}return U},g=function(p){if(!p)return c;if(typeof p.allowEmptyArrays<"u"&&typeof p.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof p.encodeDotInKeys<"u"&&typeof p.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(p.encoder!==null&&typeof p.encoder<"u"&&typeof p.encoder!="function")throw new TypeError("Encoder has to be a function.");var m=p.charset||c.charset;if(typeof p.charset<"u"&&p.charset!=="utf-8"&&p.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var _=e.default;if(typeof p.format<"u"){if(!i.call(e.formatters,p.format))throw new TypeError("Unknown format option provided.");_=p.format}var v=e.formatters[_],A=c.filter;(typeof p.filter=="function"||n(p.filter))&&(A=p.filter);var x;if(p.arrayFormat in s?x=p.arrayFormat:"indices"in p?x=p.indices?"indices":"repeat":x=c.arrayFormat,"commaRoundTrip"in p&&typeof p.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var S=typeof p.allowDots>"u"?p.encodeDotInKeys===!0?!0:c.allowDots:!!p.allowDots;return{addQueryPrefix:typeof p.addQueryPrefix=="boolean"?p.addQueryPrefix:c.addQueryPrefix,allowDots:S,allowEmptyArrays:typeof p.allowEmptyArrays=="boolean"?!!p.allowEmptyArrays:c.allowEmptyArrays,arrayFormat:x,charset:m,charsetSentinel:typeof p.charsetSentinel=="boolean"?p.charsetSentinel:c.charsetSentinel,commaRoundTrip:!!p.commaRoundTrip,delimiter:typeof p.delimiter>"u"?c.delimiter:p.delimiter,encode:typeof p.encode=="boolean"?p.encode:c.encode,encodeDotInKeys:typeof p.encodeDotInKeys=="boolean"?p.encodeDotInKeys:c.encodeDotInKeys,encoder:typeof p.encoder=="function"?p.encoder:c.encoder,encodeValuesOnly:typeof p.encodeValuesOnly=="boolean"?p.encodeValuesOnly:c.encodeValuesOnly,filter:A,format:_,formatter:v,serializeDate:typeof p.serializeDate=="function"?p.serializeDate:c.serializeDate,skipNulls:typeof p.skipNulls=="boolean"?p.skipNulls:c.skipNulls,sort:typeof p.sort=="function"?p.sort:null,strictNullHandling:typeof p.strictNullHandling=="boolean"?p.strictNullHandling:c.strictNullHandling}};return Aa=function(y,p){var m=y,_=g(p),v,A;typeof _.filter=="function"?(A=_.filter,m=A("",m)):n(_.filter)&&(A=_.filter,v=A);var x=[];if(typeof m!="object"||m===null)return"";var S=s[_.arrayFormat],b=S==="comma"&&_.commaRoundTrip;v||(v=Object.keys(m)),_.sort&&v.sort(_.sort);for(var B=r(),G=0;G<v.length;++G){var L=v[G],O=m[L];_.skipNulls&&O===null||o(x,d(O,L,S,b,_.allowEmptyArrays,_.strictNullHandling,_.skipNulls,_.encodeDotInKeys,_.encode?_.encoder:null,_.filter,_.sort,_.allowDots,_.serializeDate,_.format,_.formatter,_.encodeValuesOnly,_.charset,B))}var N=x.join(_.delimiter),j=_.addQueryPrefix===!0?"?":"";return _.charsetSentinel&&(_.charset==="iso-8859-1"?j+="utf8=%26%2310003%3B&":j+="utf8=%E2%9C%93&"),N.length>0?j+N:""},Aa}var Ta,lu;function iv(){if(lu)return Ta;lu=1;var r=zf(),t=Object.prototype.hasOwnProperty,e=Array.isArray,i={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:r.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1},s=function(f){return f.replace(/&#(\d+);/g,function(d,g){return String.fromCharCode(parseInt(g,10))})},n=function(f,d){return f&&typeof f=="string"&&d.comma&&f.indexOf(",")>-1?f.split(","):f},a="utf8=%26%2310003%3B",o="utf8=%E2%9C%93",h=function(d,g){var y={__proto__:null},p=g.ignoreQueryPrefix?d.replace(/^\?/,""):d;p=p.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var m=g.parameterLimit===1/0?void 0:g.parameterLimit,_=p.split(g.delimiter,m),v=-1,A,x=g.charset;if(g.charsetSentinel)for(A=0;A<_.length;++A)_[A].indexOf("utf8=")===0&&(_[A]===o?x="utf-8":_[A]===a&&(x="iso-8859-1"),v=A,A=_.length);for(A=0;A<_.length;++A)if(A!==v){var S=_[A],b=S.indexOf("]="),B=b===-1?S.indexOf("="):b+1,G,L;B===-1?(G=g.decoder(S,i.decoder,x,"key"),L=g.strictNullHandling?null:""):(G=g.decoder(S.slice(0,B),i.decoder,x,"key"),L=r.maybeMap(n(S.slice(B+1),g),function(N){return g.decoder(N,i.decoder,x,"value")})),L&&g.interpretNumericEntities&&x==="iso-8859-1"&&(L=s(String(L))),S.indexOf("[]=")>-1&&(L=e(L)?[L]:L);var O=t.call(y,G);O&&g.duplicates==="combine"?y[G]=r.combine(y[G],L):(!O||g.duplicates==="last")&&(y[G]=L)}return y},l=function(f,d,g,y){for(var p=y?d:n(d,g),m=f.length-1;m>=0;--m){var _,v=f[m];if(v==="[]"&&g.parseArrays)_=g.allowEmptyArrays&&(p===""||g.strictNullHandling&&p===null)?[]:[].concat(p);else{_=g.plainObjects?{__proto__:null}:{};var A=v.charAt(0)==="["&&v.charAt(v.length-1)==="]"?v.slice(1,-1):v,x=g.decodeDotInKeys?A.replace(/%2E/g,"."):A,S=parseInt(x,10);!g.parseArrays&&x===""?_={0:p}:!isNaN(S)&&v!==x&&String(S)===x&&S>=0&&g.parseArrays&&S<=g.arrayLimit?(_=[],_[S]=p):x!=="__proto__"&&(_[x]=p)}p=_}return p},c=function(d,g,y,p){if(d){var m=y.allowDots?d.replace(/\.([^.[]+)/g,"[$1]"):d,_=/(\[[^[\]]*])/,v=/(\[[^[\]]*])/g,A=y.depth>0&&_.exec(m),x=A?m.slice(0,A.index):m,S=[];if(x){if(!y.plainObjects&&t.call(Object.prototype,x)&&!y.allowPrototypes)return;S.push(x)}for(var b=0;y.depth>0&&(A=v.exec(m))!==null&&b<y.depth;){if(b+=1,!y.plainObjects&&t.call(Object.prototype,A[1].slice(1,-1))&&!y.allowPrototypes)return;S.push(A[1])}if(A){if(y.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+y.depth+" and strictDepth is true");S.push("["+m.slice(A.index)+"]")}return l(S,g,y,p)}},u=function(d){if(!d)return i;if(typeof d.allowEmptyArrays<"u"&&typeof d.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof d.decodeDotInKeys<"u"&&typeof d.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(d.decoder!==null&&typeof d.decoder<"u"&&typeof d.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof d.charset<"u"&&d.charset!=="utf-8"&&d.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var g=typeof d.charset>"u"?i.charset:d.charset,y=typeof d.duplicates>"u"?i.duplicates:d.duplicates;if(y!=="combine"&&y!=="first"&&y!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var p=typeof d.allowDots>"u"?d.decodeDotInKeys===!0?!0:i.allowDots:!!d.allowDots;return{allowDots:p,allowEmptyArrays:typeof d.allowEmptyArrays=="boolean"?!!d.allowEmptyArrays:i.allowEmptyArrays,allowPrototypes:typeof d.allowPrototypes=="boolean"?d.allowPrototypes:i.allowPrototypes,allowSparse:typeof d.allowSparse=="boolean"?d.allowSparse:i.allowSparse,arrayLimit:typeof d.arrayLimit=="number"?d.arrayLimit:i.arrayLimit,charset:g,charsetSentinel:typeof d.charsetSentinel=="boolean"?d.charsetSentinel:i.charsetSentinel,comma:typeof d.comma=="boolean"?d.comma:i.comma,decodeDotInKeys:typeof d.decodeDotInKeys=="boolean"?d.decodeDotInKeys:i.decodeDotInKeys,decoder:typeof d.decoder=="function"?d.decoder:i.decoder,delimiter:typeof d.delimiter=="string"||r.isRegExp(d.delimiter)?d.delimiter:i.delimiter,depth:typeof d.depth=="number"||d.depth===!1?+d.depth:i.depth,duplicates:y,ignoreQueryPrefix:d.ignoreQueryPrefix===!0,interpretNumericEntities:typeof d.interpretNumericEntities=="boolean"?d.interpretNumericEntities:i.interpretNumericEntities,parameterLimit:typeof d.parameterLimit=="number"?d.parameterLimit:i.parameterLimit,parseArrays:d.parseArrays!==!1,plainObjects:typeof d.plainObjects=="boolean"?d.plainObjects:i.plainObjects,strictDepth:typeof d.strictDepth=="boolean"?!!d.strictDepth:i.strictDepth,strictNullHandling:typeof d.strictNullHandling=="boolean"?d.strictNullHandling:i.strictNullHandling}};return Ta=function(f,d){var g=u(d);if(f===""||f===null||typeof f>"u")return g.plainObjects?{__proto__:null}:{};for(var y=typeof f=="string"?h(f,g):f,p=g.plainObjects?{__proto__:null}:{},m=Object.keys(y),_=0;_<m.length;++_){var v=m[_],A=c(v,y[v],g,typeof f=="string");p=r.merge(p,A,g)}return g.allowSparse===!0?p:r.compact(p)},Ta}var Sa,cu;function sv(){if(cu)return Sa;cu=1;var r=rv(),t=iv(),e=oh();return Sa={formats:e,parse:t,stringify:r},Sa}var uu;function nv(){if(uu)return We;uu=1;var r=B1();function t(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var e=/^([a-z0-9.+-]+:)/i,i=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,n=["<",">",'"',"`"," ","\r",`
`,"	"],a=["{","}","|","\\","^","`"].concat(n),o=["'"].concat(a),h=["%","/","?",";","#"].concat(o),l=["/","?","#"],c=255,u=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,d={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},y={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},p=sv();function m(x,S,b){if(x&&typeof x=="object"&&x instanceof t)return x;var B=new t;return B.parse(x,S,b),B}t.prototype.parse=function(x,S,b){if(typeof x!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof x);var B=x.indexOf("?"),G=B!==-1&&B<x.indexOf("#")?"?":"#",L=x.split(G),O=/\\/g;L[0]=L[0].replace(O,"/"),x=L.join(G);var N=x;if(N=N.trim(),!b&&x.split("#").length===1){var j=s.exec(N);if(j)return this.path=N,this.href=N,this.pathname=j[1],j[2]?(this.search=j[2],S?this.query=p.parse(this.search.substr(1)):this.query=this.search.substr(1)):S&&(this.search="",this.query={}),this}var J=e.exec(N);if(J){J=J[0];var rt=J.toLowerCase();this.protocol=rt,N=N.substr(J.length)}if(b||J||N.match(/^\/\/[^@/]+@[^@/]+/)){var w=N.substr(0,2)==="//";w&&!(J&&g[J])&&(N=N.substr(2),this.slashes=!0)}if(!g[J]&&(w||J&&!y[J])){for(var C=-1,T=0;T<l.length;T++){var P=N.indexOf(l[T]);P!==-1&&(C===-1||P<C)&&(C=P)}var E,I;C===-1?I=N.lastIndexOf("@"):I=N.lastIndexOf("@",C),I!==-1&&(E=N.slice(0,I),N=N.slice(I+1),this.auth=decodeURIComponent(E)),C=-1;for(var T=0;T<h.length;T++){var P=N.indexOf(h[T]);P!==-1&&(C===-1||P<C)&&(C=P)}C===-1&&(C=N.length),this.host=N.slice(0,C),N=N.slice(C),this.parseHost(),this.hostname=this.hostname||"";var R=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!R)for(var F=this.hostname.split(/\./),T=0,U=F.length;T<U;T++){var D=F[T];if(D&&!D.match(u)){for(var H="",X=0,W=D.length;X<W;X++)D.charCodeAt(X)>127?H+="x":H+=D[X];if(!H.match(u)){var q=F.slice(0,T),z=F.slice(T+1),it=D.match(f);it&&(q.push(it[1]),z.unshift(it[2])),z.length&&(N="/"+z.join(".")+N),this.hostname=q.join(".");break}}}this.hostname.length>c?this.hostname="":this.hostname=this.hostname.toLowerCase(),R||(this.hostname=r.toASCII(this.hostname));var st=this.port?":"+this.port:"",gt=this.hostname||"";this.host=gt+st,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),N[0]!=="/"&&(N="/"+N))}if(!d[rt])for(var T=0,U=o.length;T<U;T++){var ft=o[T];if(N.indexOf(ft)!==-1){var K=encodeURIComponent(ft);K===ft&&(K=escape(ft)),N=N.split(ft).join(K)}}var tt=N.indexOf("#");tt!==-1&&(this.hash=N.substr(tt),N=N.slice(0,tt));var zt=N.indexOf("?");if(zt!==-1?(this.search=N.substr(zt),this.query=N.substr(zt+1),S&&(this.query=p.parse(this.query)),N=N.slice(0,zt)):S&&(this.search="",this.query={}),N&&(this.pathname=N),y[rt]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var st=this.pathname||"",Xr=this.search||"";this.path=st+Xr}return this.href=this.format(),this};function _(x){return typeof x=="string"&&(x=m(x)),x instanceof t?x.format():t.prototype.format.call(x)}t.prototype.format=function(){var x=this.auth||"";x&&(x=encodeURIComponent(x),x=x.replace(/%3A/i,":"),x+="@");var S=this.protocol||"",b=this.pathname||"",B=this.hash||"",G=!1,L="";this.host?G=x+this.host:this.hostname&&(G=x+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(G+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(L=p.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var O=this.search||L&&"?"+L||"";return S&&S.substr(-1)!==":"&&(S+=":"),this.slashes||(!S||y[S])&&G!==!1?(G="//"+(G||""),b&&b.charAt(0)!=="/"&&(b="/"+b)):G||(G=""),B&&B.charAt(0)!=="#"&&(B="#"+B),O&&O.charAt(0)!=="?"&&(O="?"+O),b=b.replace(/[?#]/g,function(N){return encodeURIComponent(N)}),O=O.replace("#","%23"),S+G+b+O+B};function v(x,S){return m(x,!1,!0).resolve(S)}t.prototype.resolve=function(x){return this.resolveObject(m(x,!1,!0)).format()};function A(x,S){return x?m(x,!1,!0).resolveObject(S):S}return t.prototype.resolveObject=function(x){if(typeof x=="string"){var S=new t;S.parse(x,!1,!0),x=S}for(var b=new t,B=Object.keys(this),G=0;G<B.length;G++){var L=B[G];b[L]=this[L]}if(b.hash=x.hash,x.href==="")return b.href=b.format(),b;if(x.slashes&&!x.protocol){for(var O=Object.keys(x),N=0;N<O.length;N++){var j=O[N];j!=="protocol"&&(b[j]=x[j])}return y[b.protocol]&&b.hostname&&!b.pathname&&(b.pathname="/",b.path=b.pathname),b.href=b.format(),b}if(x.protocol&&x.protocol!==b.protocol){if(!y[x.protocol]){for(var J=Object.keys(x),rt=0;rt<J.length;rt++){var w=J[rt];b[w]=x[w]}return b.href=b.format(),b}if(b.protocol=x.protocol,!x.host&&!g[x.protocol]){for(var U=(x.pathname||"").split("/");U.length&&!(x.host=U.shift()););x.host||(x.host=""),x.hostname||(x.hostname=""),U[0]!==""&&U.unshift(""),U.length<2&&U.unshift(""),b.pathname=U.join("/")}else b.pathname=x.pathname;if(b.search=x.search,b.query=x.query,b.host=x.host||"",b.auth=x.auth,b.hostname=x.hostname||x.host,b.port=x.port,b.pathname||b.search){var C=b.pathname||"",T=b.search||"";b.path=C+T}return b.slashes=b.slashes||x.slashes,b.href=b.format(),b}var P=b.pathname&&b.pathname.charAt(0)==="/",E=x.host||x.pathname&&x.pathname.charAt(0)==="/",I=E||P||b.host&&x.pathname,R=I,F=b.pathname&&b.pathname.split("/")||[],U=x.pathname&&x.pathname.split("/")||[],D=b.protocol&&!y[b.protocol];if(D&&(b.hostname="",b.port=null,b.host&&(F[0]===""?F[0]=b.host:F.unshift(b.host)),b.host="",x.protocol&&(x.hostname=null,x.port=null,x.host&&(U[0]===""?U[0]=x.host:U.unshift(x.host)),x.host=null),I=I&&(U[0]===""||F[0]==="")),E)b.host=x.host||x.host===""?x.host:b.host,b.hostname=x.hostname||x.hostname===""?x.hostname:b.hostname,b.search=x.search,b.query=x.query,F=U;else if(U.length)F||(F=[]),F.pop(),F=F.concat(U),b.search=x.search,b.query=x.query;else if(x.search!=null){if(D){b.host=F.shift(),b.hostname=b.host;var H=b.host&&b.host.indexOf("@")>0?b.host.split("@"):!1;H&&(b.auth=H.shift(),b.hostname=H.shift(),b.host=b.hostname)}return b.search=x.search,b.query=x.query,(b.pathname!==null||b.search!==null)&&(b.path=(b.pathname?b.pathname:"")+(b.search?b.search:"")),b.href=b.format(),b}if(!F.length)return b.pathname=null,b.search?b.path="/"+b.search:b.path=null,b.href=b.format(),b;for(var X=F.slice(-1)[0],W=(b.host||x.host||F.length>1)&&(X==="."||X==="..")||X==="",q=0,z=F.length;z>=0;z--)X=F[z],X==="."?F.splice(z,1):X===".."?(F.splice(z,1),q++):q&&(F.splice(z,1),q--);if(!I&&!R)for(;q--;q)F.unshift("..");I&&F[0]!==""&&(!F[0]||F[0].charAt(0)!=="/")&&F.unshift(""),W&&F.join("/").substr(-1)!=="/"&&F.push("");var it=F[0]===""||F[0]&&F[0].charAt(0)==="/";if(D){b.hostname=it?"":F.length?F.shift():"",b.host=b.hostname;var H=b.host&&b.host.indexOf("@")>0?b.host.split("@"):!1;H&&(b.auth=H.shift(),b.hostname=H.shift(),b.host=b.hostname)}return I=I||b.host&&F.length,I&&!it&&F.unshift(""),F.length>0?b.pathname=F.join("/"):(b.pathname=null,b.path=null),(b.pathname!==null||b.search!==null)&&(b.path=(b.pathname?b.pathname:"")+(b.search?b.search:"")),b.auth=x.auth||b.auth,b.slashes=b.slashes||x.slashes,b.href=b.format(),b},t.prototype.parseHost=function(){var x=this.host,S=i.exec(x);S&&(S=S[0],S!==":"&&(this.port=S.substr(1)),x=x.substr(0,x.length-S.length)),x&&(this.hostname=x)},We.parse=m,We.resolve=v,We.resolveObject=A,We.format=_,We.Url=t,We}nv();const du={};function yt(r,t,e=3){if(du[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${r}`):(i=i.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${r}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${r}`),console.warn(i))),du[t]=!0}let Ca;function av(){return typeof Ca>"u"&&(Ca=function(){var t;const r={stencil:!0,failIfMajorPerformanceCaveat:lt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!lt.ADAPTER.getWebGLRenderingContext())return!1;const e=lt.ADAPTER.createCanvas();let i=e.getContext("webgl",r)||e.getContext("experimental-webgl",r);const s=!!((t=i==null?void 0:i.getContextAttributes())!=null&&t.stencil);if(i){const n=i.getExtension("WEBGL_lose_context");n&&n.loseContext()}return i=null,s}catch{return!1}}()),Ca}gd([yd]);const Ar=class gs{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof gs)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}isSourceEqual(t,e){const i=typeof t;if(i!==typeof e)return!1;if(i==="number"||i==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((s,n)=>s===e[n]);if(t!==null&&e!==null){const s=Object.keys(t),n=Object.keys(e);return s.length!==n.length?!1:s.every(a=>t[a]===e[a])}return t===e}toRgba(){const[t,e,i,s]=this._components;return{r:t,g:e,b:i,a:s}}toRgb(){const[t,e,i]=this._components;return{r:t,g:e,b:i}}toRgbaString(){const[t,e,i]=this.toUint8RgbArray();return`rgba(${t},${e},${i},${this.alpha})`}toUint8RgbArray(t){const[e,i,s]=this._components;return t=t??[],t[0]=Math.round(e*255),t[1]=Math.round(i*255),t[2]=Math.round(s*255),t}toRgbArray(t){t=t??[];const[e,i,s]=this._components;return t[0]=e,t[1]=i,t[2]=s,t}toNumber(){return this._int}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,i,s,n]=gs.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=i,this._components[2]*=s,this._components[3]*=n,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let i=this._int>>16&255,s=this._int>>8&255,n=this._int&255;return e&&(i=i*t+.5|0,s=s*t+.5|0,n=n*t+.5|0),(t*255<<24)+(i<<16)+(s<<8)+n}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){const[e,i,s]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(i*t)/t,this._components[2]=Math.round(s*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=t??[];const[e,i,s,n]=this._components;return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t}normalize(t){let e,i,s,n;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const a=t;e=(a>>16&255)/255,i=(a>>8&255)/255,s=(a&255)/255,n=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,i,s,n=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,i,s,n=255]=t,e/=255,i/=255,s/=255,n/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const o=gs.HEX_PATTERN.exec(t);o&&(t=`#${o[2]}`)}const a=he(t);a.isValid()&&({r:e,g:i,b:s,a:n}=a.rgba,e/=255,i/=255,s/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=i,this._components[2]=s,this._components[3]=n,this.refreshInt();else throw new Error(`Unable to convert color ${t}`)}refreshInt(){this._clamp(this._components);const[t,e,i]=this._components;this._int=(t*255<<16)+(e*255<<8)+(i*255|0)}_clamp(t,e=0,i=1){return typeof t=="number"?Math.min(Math.max(t,e),i):(t.forEach((s,n)=>{t[n]=Math.min(Math.max(s,e),i)}),t)}};Ar.shared=new Ar,Ar.temp=new Ar,Ar.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Ri=Ar;function ov(){const r=[],t=[];for(let i=0;i<32;i++)r[i]=i,t[i]=i;r[et.NORMAL_NPM]=et.NORMAL,r[et.ADD_NPM]=et.ADD,r[et.SCREEN_NPM]=et.SCREEN,t[et.NORMAL]=et.NORMAL_NPM,t[et.ADD]=et.ADD_NPM,t[et.SCREEN]=et.SCREEN_NPM;const e=[];return e.push(t),e.push(r),e}const hv=ov();function Xf(r){if(r.BYTES_PER_ELEMENT===4)return r instanceof Float32Array?"Float32Array":r instanceof Uint32Array?"Uint32Array":"Int32Array";if(r.BYTES_PER_ELEMENT===2){if(r instanceof Uint16Array)return"Uint16Array"}else if(r.BYTES_PER_ELEMENT===1&&r instanceof Uint8Array)return"Uint8Array";return null}function Ms(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1}function fu(r){return!(r&r-1)&&!!r}function pu(r){let t=(r>65535?1:0)<<4;r>>>=t;let e=(r>255?1:0)<<3;return r>>>=e,t|=e,e=(r>15?1:0)<<2,r>>>=e,t|=e,e=(r>3?1:0)<<1,r>>>=e,t|=e,t|r>>1}function ys(r,t,e){const i=r.length;let s;if(t>=i||e===0)return;e=t+e>i?i-t:e;const n=i-e;for(s=t;s<n;++s)r[s]=r[s+e];r.length=n}function qi(r){return r===0?0:r<0?-1:1}let lv=0;function Ai(){return++lv}const mu={},_e=Object.create(null),Ne=Object.create(null);function cv(r,t=globalThis.location){if(r.startsWith("data:"))return"";t=t||globalThis.location;const e=new URL(r,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}function gu(r,t=1){var i;const e=(i=lt.RETINA_PREFIX)==null?void 0:i.exec(r);return e?parseFloat(e[1]):t}var ct=(r=>(r.Renderer="renderer",r.Application="application",r.RendererSystem="renderer-webgl-system",r.RendererPlugin="renderer-webgl-plugin",r.CanvasRendererSystem="renderer-canvas-system",r.CanvasRendererPlugin="renderer-canvas-plugin",r.Asset="asset",r.LoadParser="load-parser",r.ResolveParser="resolve-parser",r.CacheParser="cache-parser",r.DetectionParser="detection-parser",r))(ct||{});const _o=r=>{if(typeof r=="function"||typeof r=="object"&&r.extension){if(!r.extension)throw new Error("Extension class must have an extension object");r={...typeof r.extension!="object"?{type:r.extension}:r.extension,ref:r}}if(typeof r=="object")r={...r};else throw new Error("Invalid extension type");return typeof r.type=="string"&&(r.type=[r.type]),r},yu=(r,t)=>_o(r).priority??t,_t={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...r){return r.map(_o).forEach(t=>{t.type.forEach(e=>{var i,s;return(s=(i=this._removeHandlers)[e])==null?void 0:s.call(i,t)})}),this},add(...r){return r.map(_o).forEach(t=>{t.type.forEach(e=>{var n,a;const i=this._addHandlers,s=this._queue;i[e]?(n=i[e])==null||n.call(i,t):(s[e]=s[e]||[],(a=s[e])==null||a.push(t))})}),this},handle(r,t,e){var a;const i=this._addHandlers,s=this._removeHandlers;if(i[r]||s[r])throw new Error(`Extension type ${r} already has a handler`);i[r]=t,s[r]=e;const n=this._queue;return n[r]&&((a=n[r])==null||a.forEach(o=>t(o)),delete n[r]),this},handleByMap(r,t){return this.handle(r,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByList(r,t,e=-1){return this.handle(r,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((s,n)=>yu(n,e)-yu(s,e)))},i=>{const s=t.indexOf(i.ref);s!==-1&&t.splice(s,1)})}};class uv{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const dv=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function fv(r){let t="";for(let e=0;e<r;++e)e>0&&(t+=`
else `),e<r-1&&(t+=`if(test == ${e}.0){}`);return t}function pv(r,t){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const i=dv.replace(/%forloop%/gi,fv(r));if(t.shaderSource(e,i),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))r=r/2|0;else break}return r}const Ea=0,Ia=1,Pa=2,Ra=3,Ma=4,Fa=5;class zr{constructor(){this.data=0,this.blendMode=et.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Ea)}set blend(t){!!(this.data&1<<Ea)!==t&&(this.data^=1<<Ea)}get offsets(){return!!(this.data&1<<Ia)}set offsets(t){!!(this.data&1<<Ia)!==t&&(this.data^=1<<Ia)}get culling(){return!!(this.data&1<<Pa)}set culling(t){!!(this.data&1<<Pa)!==t&&(this.data^=1<<Pa)}get depthTest(){return!!(this.data&1<<Ra)}set depthTest(t){!!(this.data&1<<Ra)!==t&&(this.data^=1<<Ra)}get depthMask(){return!!(this.data&1<<Fa)}set depthMask(t){!!(this.data&1<<Fa)!==t&&(this.data^=1<<Fa)}get clockwiseFrontFace(){return!!(this.data&1<<Ma)}set clockwiseFrontFace(t){!!(this.data&1<<Ma)!==t&&(this.data^=1<<Ma)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==et.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}static for2d(){const t=new zr;return t.depthTest=!1,t.blend=!0,t}}zr.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const xo=[];function Wf(r,t){if(!r)return null;let e="";if(typeof r=="string"){const i=/\.(\w{3,4})(?:$|\?|#)/i.exec(r);i&&(e=i[1].toLowerCase())}for(let i=xo.length-1;i>=0;--i){const s=xo[i];if(s.test&&s.test(r,e))return new s(r,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class fe{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,i,s,n,a,o,h){if(arguments.length>8)throw new Error("max arguments reached");const{name:l,items:c}=this;this._aliasCount++;for(let u=0,f=c.length;u<f;u++)c[u][l](t,e,i,s,n,a,o,h);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(fe.prototype,{dispatch:{value:fe.prototype.emit},run:{value:fe.prototype.emit}});class Ti{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new fe("setRealSize"),this.onUpdate=new fe("update"),this.onError=new fe("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class jf extends Ti{constructor(t,e){const{width:i,height:s}=e||{};if(!i||!s)throw new Error("BufferResource width or height invalid");super(i,s),this.data=t,this.unpackAlignment=e.unpackAlignment??4}upload(t,e,i){const s=t.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,this.unpackAlignment),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===fr.UNPACK);const n=e.realWidth,a=e.realHeight;return i.width===n&&i.height===a?s.texSubImage2D(e.target,0,0,0,n,a,e.format,i.type,this.data):(i.width=n,i.height=a,s.texImage2D(e.target,0,i.internalFormat,n,a,0,e.format,i.type,this.data)),!0}dispose(){this.data=null}static test(t){return t===null||t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}const mv={scaleMode:Ee.NEAREST,alphaMode:fr.NPM},vo=class Tr extends js{constructor(t=null,e=null){super(),e=Object.assign({},Tr.defaultOptions,e);const{alphaMode:i,mipmap:s,anisotropicLevel:n,scaleMode:a,width:o,height:h,wrapMode:l,format:c,type:u,target:f,resolution:d,resourceOptions:g}=e;t&&!(t instanceof Ti)&&(t=Wf(t,g),t.internal=!0),this.resolution=d||lt.RESOLUTION,this.width=Math.round((o||0)*this.resolution)/this.resolution,this.height=Math.round((h||0)*this.resolution)/this.resolution,this._mipmap=s,this.anisotropicLevel=n,this._wrapMode=l,this._scaleMode=a,this.format=c,this.type=u,this.target=f,this.alphaMode=i,this.uid=Ai(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=o>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let i;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),e!==void 0&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this}setSize(t,e,i){return i=i||this.resolution,this.setRealSize(t*i,e*i,i)}setRealSize(t,e,i){return this.resolution=i||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=fu(this.realWidth)&&fu(this.realHeight)}setResolution(t){const e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT(),this)}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Ne[this.cacheId],delete _e[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),Tr.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,e,i=lt.STRICT_TEXTURE_CACHE){const s=typeof t=="string";let n=null;if(s)n=t;else{if(!t._pixiId){const o=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${o}_${Ai()}`}n=t._pixiId}let a=Ne[n];if(s&&i&&!a)throw new Error(`The cacheId "${n}" does not exist in BaseTextureCache.`);return a||(a=new Tr(t,e),a.cacheId=n,Tr.addToCache(a,n)),a}static fromBuffer(t,e,i,s){t=t||new Float32Array(e*i*4);const n=new jf(t,{width:e,height:i,...s==null?void 0:s.resourceOptions});let a,o;return t instanceof Float32Array?(a=$.RGBA,o=at.FLOAT):t instanceof Int32Array?(a=$.RGBA_INTEGER,o=at.INT):t instanceof Uint32Array?(a=$.RGBA_INTEGER,o=at.UNSIGNED_INT):t instanceof Int16Array?(a=$.RGBA_INTEGER,o=at.SHORT):t instanceof Uint16Array?(a=$.RGBA_INTEGER,o=at.UNSIGNED_SHORT):t instanceof Int8Array?(a=$.RGBA,o=at.BYTE):(a=$.RGBA,o=at.UNSIGNED_BYTE),n.internal=!0,new Tr(n,Object.assign({},mv,{type:o,format:a},s))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Ne[e]&&Ne[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),Ne[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=Ne[t];if(e){const i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete Ne[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete Ne[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}};vo.defaultOptions={mipmap:ur.POW2,anisotropicLevel:0,scaleMode:Ee.LINEAR,wrapMode:ih.CLAMP,alphaMode:fr.UNPACK,target:Fr.TEXTURE_2D,format:$.RGBA,type:at.UNSIGNED_BYTE},vo._globalBatch=0;let xt=vo;class gv{constructor(){this.texArray=null,this.blend=0,this.type=Rs.TRIANGLES,this.start=0,this.size=0,this.data=null}}let yv=0;class Wt{constructor(t,e=!0,i=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=yv++,this.disposeRunner=new fe("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?we.ELEMENT_ARRAY_BUFFER:we.ARRAY_BUFFER}get index(){return this.type===we.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Wt(t)}}class Fs{constructor(t,e=0,i=!1,s=at.FLOAT,n,a,o,h=1){this.buffer=t,this.size=e,this.normalized=i,this.type=s,this.stride=n,this.start=a,this.instance=o,this.divisor=h}destroy(){this.buffer=null}static from(t,e,i,s,n){return new Fs(t,e,i,s,n)}}const _v={Float32Array,Uint32Array,Int32Array,Uint8Array};function xv(r,t){let e=0,i=0;const s={};for(let h=0;h<r.length;h++)i+=t[h],e+=r[h].length;const n=new ArrayBuffer(e*4);let a=null,o=0;for(let h=0;h<r.length;h++){const l=t[h],c=r[h],u=Xf(c);s[u]||(s[u]=new _v[u](n)),a=s[u];for(let f=0;f<c.length;f++){const d=(f/l|0)*i+o,g=f%l;a[d+g]=c[f]}o+=l}return new Float32Array(n)}const _u={5126:4,5123:2,5121:1};let vv=0;const bv={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Ur{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=vv++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new fe("disposeGeometry"),this.refCount=0}addAttribute(t,e,i=0,s=!1,n,a,o,h=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Wt||(e instanceof Array&&(e=new Float32Array(e)),e=new Wt(e));const l=t.split("|");if(l.length>1){for(let u=0;u<l.length;u++)this.addAttribute(l[u],e,i,s,n);return this}let c=this.buffers.indexOf(e);return c===-1&&(this.buffers.push(e),c=this.buffers.length-1),this.attributes[t]=new Fs(c,i,s,n,a,o,h),this.instanced=this.instanced||h,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Wt||(t instanceof Array&&(t=new Uint16Array(t)),t=new Wt(t)),t.type=we.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],i=new Wt;let s;for(s in this.attributes){const n=this.attributes[s],a=this.buffers[n.buffer];t.push(a.data),e.push(n.size*_u[n.type]/4),n.buffer=0}for(i.data=xv(t,e),s=0;s<this.buffers.length;s++)this.buffers[s]!==this.indexBuffer&&this.buffers[s].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new Ur;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new Wt(this.buffers[e].data.slice(0));for(const e in this.attributes){const i=this.attributes[e];t.attributes[e]=new Fs(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=we.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new Ur,i=[],s=[],n=[];let a;for(let o=0;o<t.length;o++){a=t[o];for(let h=0;h<a.buffers.length;h++)s[h]=s[h]||0,s[h]+=a.buffers[h].data.length,n[h]=0}for(let o=0;o<a.buffers.length;o++)i[o]=new bv[Xf(a.buffers[o].data)](s[o]),e.buffers[o]=new Wt(i[o]);for(let o=0;o<t.length;o++){a=t[o];for(let h=0;h<a.buffers.length;h++)i[h].set(a.buffers[h].data,n[h]),n[h]+=a.buffers[h].data.length}if(e.attributes=a.attributes,a.indexBuffer){e.indexBuffer=e.buffers[a.buffers.indexOf(a.indexBuffer)],e.indexBuffer.type=we.ELEMENT_ARRAY_BUFFER;let o=0,h=0,l=0,c=0;for(let u=0;u<a.buffers.length;u++)if(a.buffers[u]!==a.indexBuffer){c=u;break}for(const u in a.attributes){const f=a.attributes[u];(f.buffer|0)===c&&(h+=f.size*_u[f.type]/4)}for(let u=0;u<t.length;u++){const f=t[u].indexBuffer.data;for(let d=0;d<f.length;d++)e.indexBuffer.data[d+l]+=o;o+=t[u].buffers[c].data.length/h,l+=f.length}}return e}}class wv extends Ur{constructor(t=!1){super(),this._buffer=new Wt(null,t,!1),this._indexBuffer=new Wt(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,at.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,at.FLOAT).addAttribute("aColor",this._buffer,4,!0,at.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,at.FLOAT).addIndex(this._indexBuffer)}}const Av=Math.PI*2,Tv=180/Math.PI,Sv=Math.PI/180;var Yf=(r=>(r[r.POLY=0]="POLY",r[r.RECT=1]="RECT",r[r.CIRC=2]="CIRC",r[r.ELIP=3]="ELIP",r[r.RREC=4]="RREC",r))(Yf||{});class Ct{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new Ct(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}}Ct.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const Ki=[new Ct,new Ct,new Ct,new Ct];let Et=class bo{constructor(t=0,e=0,i=0,s=0){this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(s),this.type=Yf.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new bo(0,0,0,0)}clone(){return new bo(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const B=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=B)return!1;const G=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>G}const i=this.left,s=this.right,n=this.top,a=this.bottom;if(s<=i||a<=n)return!1;const o=Ki[0].set(t.left,t.top),h=Ki[1].set(t.left,t.bottom),l=Ki[2].set(t.right,t.top),c=Ki[3].set(t.right,t.bottom);if(l.x<=o.x||h.y<=o.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(o,o),e.apply(h,h),e.apply(l,l),e.apply(c,c),Math.max(o.x,h.x,l.x,c.x)<=i||Math.min(o.x,h.x,l.x,c.x)>=s||Math.max(o.y,h.y,l.y,c.y)<=n||Math.min(o.y,h.y,l.y,c.y)>=a))return!1;const f=u*(h.y-o.y),d=u*(o.x-h.x),g=f*i+d*n,y=f*s+d*n,p=f*i+d*a,m=f*s+d*a;if(Math.max(g,y,p,m)<=f*o.x+d*o.y||Math.min(g,y,p,m)>=f*c.x+d*c.y)return!1;const _=u*(o.y-l.y),v=u*(l.x-o.x),A=_*i+v*n,x=_*s+v*n,S=_*i+v*a,b=_*s+v*a;return!(Math.max(A,x,S,b)<=_*o.x+v*o.y||Math.min(A,x,S,b)>=_*c.x+v*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),s=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=s,this.height=Math.max(n-s,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,s=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=s-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),s=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=s,this.height=n-s,this}};Et.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Dt{constructor(t=1,e=0,i=0,s=1,n=0,a=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=s,this.tx=n,this.ty=a}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,s,n,a){return this.a=t,this.b=e,this.c=i,this.d=s,this.tx=n,this.ty=a,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new Ct;const i=t.x,s=t.y;return e.x=this.a*i+this.c*s+this.tx,e.y=this.b*i+this.d*s+this.ty,e}applyInverse(t,e){e=e||new Ct;const i=1/(this.a*this.d+this.c*-this.b),s=t.x,n=t.y;return e.x=this.d*i*s+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*s+(-this.ty*this.a+this.tx*this.b)*i,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),s=this.a,n=this.c,a=this.tx;return this.a=s*e-this.b*i,this.b=s*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=a*e-this.ty*i,this.ty=a*i+this.ty*e,this}append(t){const e=this.a,i=this.b,s=this.c,n=this.d;return this.a=t.a*e+t.b*s,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*s,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*s+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this}setTransform(t,e,i,s,n,a,o,h,l){return this.a=Math.cos(o+l)*n,this.b=Math.sin(o+l)*n,this.c=-Math.sin(o-h)*a,this.d=Math.cos(o-h)*a,this.tx=t-(i*this.a+s*this.c),this.ty=e-(i*this.b+s*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const i=this.a,s=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=s*t.a+this.d*t.c,this.d=s*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,i=this.b,s=this.c,n=this.d,a=t.pivot,o=-Math.atan2(-s,n),h=Math.atan2(i,e),l=Math.abs(o+h);return l<1e-5||Math.abs(Av-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=h),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(s*s+n*n),t.position.x=this.tx+(a.x*e+a.y*s),t.position.y=this.ty+(a.x*i+a.y*n),t}invert(){const t=this.a,e=this.b,i=this.c,s=this.d,n=this.tx,a=t*s-e*i;return this.a=s/a,this.b=-e/a,this.c=-i/a,this.d=t/a,this.tx=(i*this.ty-s*n)/a,this.ty=-(t*this.ty-e*n)/a,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Dt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}static get IDENTITY(){return new Dt}static get TEMP_MATRIX(){return new Dt}}Dt.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const er=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],rr=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ir=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],sr=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],wo=[],qf=[],Zi=Math.sign;function Cv(){for(let r=0;r<16;r++){const t=[];wo.push(t);for(let e=0;e<16;e++){const i=Zi(er[r]*er[e]+ir[r]*rr[e]),s=Zi(rr[r]*er[e]+sr[r]*rr[e]),n=Zi(er[r]*ir[e]+ir[r]*sr[e]),a=Zi(rr[r]*ir[e]+sr[r]*sr[e]);for(let o=0;o<16;o++)if(er[o]===i&&rr[o]===s&&ir[o]===n&&sr[o]===a){t.push(o);break}}}for(let r=0;r<16;r++){const t=new Dt;t.set(er[r],rr[r],ir[r],sr[r],0,0),qf.push(t)}}Cv();const Pt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:r=>er[r],uY:r=>rr[r],vX:r=>ir[r],vY:r=>sr[r],inv:r=>r&8?r&15:-r&7,add:(r,t)=>wo[r][t],sub:(r,t)=>wo[r][Pt.inv(t)],rotate180:r=>r^4,isVertical:r=>(r&3)===2,byDirection:(r,t)=>Math.abs(r)*2<=Math.abs(t)?t>=0?Pt.S:Pt.N:Math.abs(t)*2<=Math.abs(r)?r>0?Pt.E:Pt.W:t>0?r>0?Pt.SE:Pt.SW:r>0?Pt.NE:Pt.NW,matrixAppendRotationInv:(r,t,e=0,i=0)=>{const s=qf[Pt.inv(t)];s.tx=e,s.ty=i,r.append(s)}};class Ge{constructor(t,e,i=0,s=0){this._x=i,this._y=s,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new Ge(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}Ge.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const Ao=class{constructor(){this.worldTransform=new Dt,this.localTransform=new Dt,this.position=new Ge(this.onChange,this,0,0),this.scale=new Ge(this.onChange,this,1,1),this.pivot=new Ge(this.onChange,this,0,0),this.skew=new Ge(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const r=this.localTransform;this._localID!==this._currentLocalID&&(r.a=this._cx*this.scale.x,r.b=this._sx*this.scale.x,r.c=this._cy*this.scale.y,r.d=this._sy*this.scale.y,r.tx=this.position.x-(this.pivot.x*r.a+this.pivot.y*r.c),r.ty=this.position.y-(this.pivot.x*r.b+this.pivot.y*r.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(r){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==r._worldID){const e=r.worldTransform,i=this.worldTransform;i.a=t.a*e.a+t.b*e.c,i.b=t.a*e.b+t.b*e.d,i.c=t.c*e.a+t.d*e.c,i.d=t.c*e.b+t.d*e.d,i.tx=t.tx*e.a+t.ty*e.c+e.tx,i.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=r._worldID,this._worldID++}}setFromMatrix(r){r.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(r){this._rotation!==r&&(this._rotation=r,this.updateSkew())}};Ao.IDENTITY=new Ao;let hh=Ao;hh.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var Ev=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,Iv=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function xu(r,t,e){const i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),i}function ka(r){const t=new Array(r);for(let e=0;e<t.length;e++)t[e]=!1;return t}function Kf(r,t){switch(r){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return ka(2*t);case"bvec3":return ka(3*t);case"bvec4":return ka(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const kr=[{test:r=>r.type==="float"&&r.size===1&&!r.isArray,code:r=>`
            if(uv["${r}"] !== ud["${r}"].value)
            {
                ud["${r}"].value = uv["${r}"]
                gl.uniform1f(ud["${r}"].location, uv["${r}"])
            }
            `},{test:(r,t)=>(r.type==="sampler2D"||r.type==="samplerCube"||r.type==="sampler2DArray")&&r.size===1&&!r.isArray&&(t==null||t.castToBaseTexture!==void 0),code:r=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${r}"], t);

            if(ud["${r}"].value !== t)
            {
                ud["${r}"].value = t;
                gl.uniform1i(ud["${r}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(r,t)=>r.type==="mat3"&&r.size===1&&!r.isArray&&t.a!==void 0,code:r=>`
            gl.uniformMatrix3fv(ud["${r}"].location, false, uv["${r}"].toArray(true));
            `,codeUbo:r=>`
                var ${r}_matrix = uv.${r}.toArray(true);

                data[offset] = ${r}_matrix[0];
                data[offset+1] = ${r}_matrix[1];
                data[offset+2] = ${r}_matrix[2];
        
                data[offset + 4] = ${r}_matrix[3];
                data[offset + 5] = ${r}_matrix[4];
                data[offset + 6] = ${r}_matrix[5];
        
                data[offset + 8] = ${r}_matrix[6];
                data[offset + 9] = ${r}_matrix[7];
                data[offset + 10] = ${r}_matrix[8];
            `},{test:(r,t)=>r.type==="vec2"&&r.size===1&&!r.isArray&&t.x!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${r}"].location, v.x, v.y);
                }`,codeUbo:r=>`
                v = uv.${r};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:r=>r.type==="vec2"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${r}"].location, v[0], v[1]);
                }
            `},{test:(r,t)=>r.type==="vec4"&&r.size===1&&!r.isArray&&t.width!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${r}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(r,t)=>r.type==="vec4"&&r.size===1&&!r.isArray&&t.red!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${r}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(r,t)=>r.type==="vec3"&&r.size===1&&!r.isArray&&t.red!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${r}"].location, v.red, v.green, v.blue)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:r=>r.type==="vec4"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${r}"].location, v[0], v[1], v[2], v[3])
                }`}],Pv={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},Rv={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Mv(r,t){var i;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const s in r.uniforms){const n=t[s];if(!n){((i=r.uniforms[s])==null?void 0:i.group)===!0&&(r.uniforms[s].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${s}, '${s}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${s}, syncData);
                    `));continue}const a=r.uniforms[s];let o=!1;for(let h=0;h<kr.length;h++)if(kr[h].test(n,a)){e.push(kr[h].code(s,a)),o=!0;break}if(!o){const h=(n.size===1&&!n.isArray?Pv:Rv)[n.type].replace("location",`ud["${s}"].location`);e.push(`
            cu = ud["${s}"];
            cv = cu.value;
            v = uv["${s}"];
            ${h};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const Zf={};let vr=Zf;function Fv(){if(vr===Zf||vr!=null&&vr.isContextLost()){const r=lt.ADAPTER.createCanvas();let t;lt.PREFER_ENV>=dr.WEBGL2&&(t=r.getContext("webgl2",{})),t||(t=r.getContext("webgl",{})||r.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),vr=t}return vr}let Qi;function kv(){if(!Qi){Qi=se.MEDIUM;const r=Fv();if(r&&r.getShaderPrecisionFormat){const t=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);t&&(Qi=t.precision?se.HIGH:se.MEDIUM)}}return Qi}function vu(r,t){const e=r.getShaderSource(t).split(`
`).map((l,c)=>`${c}: ${l}`),i=r.getShaderInfoLog(t),s=i.split(`
`),n={},a=s.map(l=>parseFloat(l.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(l=>l&&!n[l]?(n[l]=!0,!0):!1),o=[""];a.forEach(l=>{e[l-1]=`%c${e[l-1]}%c`,o.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const h=e.join(`
`);o[0]=h,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...o),console.groupEnd()}function Bv(r,t,e,i){r.getProgramParameter(t,r.LINK_STATUS)||(r.getShaderParameter(e,r.COMPILE_STATUS)||vu(r,e),r.getShaderParameter(i,r.COMPILE_STATUS)||vu(r,i),console.error("PixiJS Error: Could not initialize shader."),r.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",r.getProgramInfoLog(t)))}const Lv={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Qf(r){return Lv[r]}let Ji=null;const bu={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Jf(r,t){if(!Ji){const e=Object.keys(bu);Ji={};for(let i=0;i<e.length;++i){const s=e[i];Ji[r[s]]=bu[s]}}return Ji[t]}function wu(r,t,e){if(r.substring(0,9)!=="precision"){let i=t;return t===se.HIGH&&e!==se.HIGH&&(i=se.MEDIUM),`precision ${i} float;
${r}`}else if(e!==se.HIGH&&r.substring(0,15)==="precision highp")return r.replace("precision highp","precision mediump");return r}let Jr;function Nv(){if(typeof Jr=="boolean")return Jr;try{Jr=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Jr=!1}return Jr}let Ov=0;const ts={},To=class Sr{constructor(t,e,i="pixi-shader",s={}){this.extra={},this.id=Ov++,this.vertexSrc=t||Sr.defaultVertexSrc,this.fragmentSrc=e||Sr.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=s,this.vertexSrc.substring(0,8)!=="#version"&&(i=i.replace(/\s+/g,"-"),ts[i]?(ts[i]++,i+=`-${ts[i]}`):ts[i]=1,this.vertexSrc=`#define SHADER_NAME ${i}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${i}
${this.fragmentSrc}`,this.vertexSrc=wu(this.vertexSrc,Sr.defaultVertexPrecision,se.HIGH),this.fragmentSrc=wu(this.fragmentSrc,Sr.defaultFragmentPrecision,kv())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return Iv}static get defaultFragmentSrc(){return Ev}static from(t,e,i){const s=t+e;let n=mu[s];return n||(mu[s]=n=new Sr(t,e,i)),n}};To.defaultVertexPrecision=se.HIGH,To.defaultFragmentPrecision=Cr.apple.device?se.HIGH:se.MEDIUM;let lr=To,Uv=0;class Ae{constructor(t,e,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Uv++,this.static=!!e,this.ubo=!!i,t instanceof Wt?(this.buffer=t,this.buffer.type=we.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Wt(new Float32Array(1)),this.buffer.type=we.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,i){if(!this.ubo)this.uniforms[t]=new Ae(e,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,i){return new Ae(t,e,i)}static uboFrom(t,e){return new Ae(t,e??!0,!0)}}class Ys{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof Ae?this.uniformGroup=e:this.uniformGroup=new Ae(e):this.uniformGroup=new Ae({}),this.disposeRunner=new fe("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const i in e.uniforms){const s=e.uniforms[i];if(s.group===!0&&this.checkUniformExists(t,s))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,i){const s=lr.from(t,e);return new Ys(s,i)}}class Gv{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const i=new Int32Array(t);for(let n=0;n<t;n++)i[n]=n;this.defaultGroupCache[t]=Ae.from({uSamplers:i},!0);let s=this.fragTemplate;s=s.replace(/%count%/gi,`${t}`),s=s.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new lr(this.vertexSrc,s)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new Dt,default:this.defaultGroupCache[t]};return new Ys(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let i=0;i<t;i++)i>0&&(e+=`
else `),i<t-1&&(e+=`if(vTextureId < ${i}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class Dv{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function $v(){return!Cr.apple.device}function Hv(r){let t=!0;const e=lt.ADAPTER.getNavigator();if(Cr.tablet||Cr.phone){if(Cr.apple.device){const i=e.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(t=!1)}if(Cr.android.device){const i=e.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(t=!1)}}return t?r:4}class tp{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var Vv=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,zv=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const hi=class oe extends tp{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=wv,this.vertexSize=6,this.state=zr.for2d(),this.size=oe.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??Hv(32),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??$v(),this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return yt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return zv}static get defaultFragmentTemplate(){return Vv}setShaderGenerator({vertex:t=oe.defaultVertexSrc,fragment:e=oe.defaultFragmentTemplate}={}){this.shaderGenerator=new Gv(t,e)}contextChange(){const t=this.renderer.gl;lt.PREFER_ENV===dr.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),oe.defaultMaxTextures),this.maxTextures=pv(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:t,_textureArrayPool:e}=oe,i=this.size/4,s=Math.floor(i/this.maxTextures)+1;for(;t.length<i;)t.push(new gv);for(;e.length<s;)e.push(new Dv);for(let n=0;n<this.maxTextures;n++)this._tempBoundTextures[n]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){const{_bufferedTextures:t,maxTextures:e}=this,i=oe._textureArrayPool,s=this.renderer.batch,n=this._tempBoundTextures,a=this.renderer.textureGC.count;let o=++xt._globalBatch,h=0,l=i[0],c=0;s.copyBoundTextures(n,e);for(let u=0;u<this._bufferSize;++u){const f=t[u];t[u]=null,f._batchEnabled!==o&&(l.count>=e&&(s.boundArray(l,n,o,e),this.buildDrawCalls(l,c,u),c=u,l=i[++h],++o),f._batchEnabled=o,f.touched=a,l.elements[l.count++]=f)}l.count>0&&(s.boundArray(l,n,o,e),this.buildDrawCalls(l,c,this._bufferSize),++h,++o);for(let u=0;u<n.length;u++)n[u]=null;xt._globalBatch=o}buildDrawCalls(t,e,i){const{_bufferedElements:s,_attributeBuffer:n,_indexBuffer:a,vertexSize:o}=this,h=oe._drawCallPool;let l=this._dcIndex,c=this._aIndex,u=this._iIndex,f=h[l];f.start=this._iIndex,f.texArray=t;for(let d=e;d<i;++d){const g=s[d],y=g._texture.baseTexture,p=hv[y.alphaMode?1:0][g.blendMode];s[d]=null,e<d&&f.blend!==p&&(f.size=u-f.start,e=d,f=h[++l],f.texArray=t,f.start=u),this.packInterleavedGeometry(g,n,a,c,u),c+=g.vertexData.length/2*o,u+=g.indices.length,f.blend=p}e<i&&(f.size=u-f.start,++l),this._dcIndex=l,this._aIndex=c,this._iIndex=u}bindAndClearTexArray(t){const e=this.renderer.texture;for(let i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0}updateGeometry(){const{_packedGeometries:t,_attributeBuffer:e,_indexBuffer:i}=this;oe.canUploadSameBuffer?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const t=this._dcIndex,{gl:e,state:i}=this.renderer,s=oe._drawCallPool;let n=null;for(let a=0;a<t;a++){const{texArray:o,type:h,size:l,start:c,blend:u}=s[a];n!==o&&(n=o,this.bindAndClearTexArray(o)),this.state.blendMode=u,i.set(this.state),e.drawElements(h,l,e.UNSIGNED_SHORT,c*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),oe.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){const e=Ms(Math.ceil(t/8)),i=pu(e),s=e*8;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);let n=this._aBuffers[s];return n||(this._aBuffers[s]=n=new uv(s*this.vertexSize*4)),n}getIndexBuffer(t){const e=Ms(Math.ceil(t/12)),i=pu(e),s=e*12;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);let n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(s)),n}packInterleavedGeometry(t,e,i,s,n){const{uint32View:a,float32View:o}=e,h=s/this.vertexSize,l=t.uvs,c=t.indices,u=t.vertexData,f=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),g=Ri.shared.setValue(t._tintRGB).toPremultiplied(d,t._texture.baseTexture.alphaMode>0);for(let y=0;y<u.length;y+=2)o[s++]=u[y],o[s++]=u[y+1],o[s++]=l[y],o[s++]=l[y+1],a[s++]=g,o[s++]=f;for(let y=0;y<c.length;y++)i[n++]=h+c[y]}};hi.defaultBatchSize=4096,hi.extension={name:"batch",type:ct.RendererPlugin},hi._drawCallPool=[],hi._textureArrayPool=[];let nr=hi;_t.add(nr);var Xv=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,Wv=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const So=class li extends Ys{constructor(t,e,i){const s=lr.from(t||li.defaultVertexSrc,e||li.defaultFragmentSrc);super(s,i),this.padding=0,this.resolution=li.defaultResolution,this.multisample=li.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new zr}apply(t,e,i,s,n){t.applyFilter(this,e,i,s)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return Wv}static get defaultFragmentSrc(){return Xv}};So.defaultResolution=1,So.defaultMultisample=Bt.NONE;let Er=So;class ks{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Ri(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:e,background:i,backgroundAlpha:s}=t,n=i??e;n!==void 0&&(this.color=n),this.alpha=s}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}ks.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},ks.extension={type:[ct.RendererSystem,ct.CanvasRendererSystem],name:"background"};_t.add(ks);class ep{constructor(t){this.renderer=t,this.emptyRenderer=new tp(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:i}=this.renderer.texture;for(let s=e-1;s>=0;--s)t[s]=i[s]||null,t[s]&&(t[s]._batchLocation=s)}boundArray(t,e,i,s){const{elements:n,ids:a,count:o}=t;let h=0;for(let l=0;l<o;l++){const c=n[l],u=c._batchLocation;if(u>=0&&u<s&&e[u]===c){a[l]=u;continue}for(;h<s;){const f=e[h];if(f&&f._batchEnabled===i&&f._batchLocation===h){h++;continue}a[l]=h,c._batchLocation=h,e[h]=c;break}}}destroy(){this.renderer=null}}ep.extension={type:ct.RendererSystem,name:"batch"};_t.add(ep);let Au=0;class Bs{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Au++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,i=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:i,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Au++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let i;if(lt.PREFER_ENV>=dr.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc"),bptc:t.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const s=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=s,s||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Bs.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},Bs.extension={type:ct.RendererSystem,name:"context"};_t.add(Bs);class Co{constructor(t,e){if(this.width=Math.round(t),this.height=Math.round(e),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new fe("disposeFramebuffer"),this.multisample=Bt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new xt(null,{scaleMode:Ee.NEAREST,resolution:1,mipmap:ur.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new xt(null,{scaleMode:Ee.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:ur.OFF,format:$.DEPTH_COMPONENT,type:at.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!t||!e)throw new Error("Framebuffer width and height must not be zero");if(!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){const s=this.colorTextures[i],n=s.resolution;s.setSize(t/n,e/n)}if(this.depthTexture){const i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,e/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class rp extends xt{constructor(t={}){if(typeof t=="number"){const e=arguments[0],i=arguments[1],s=arguments[2],n=arguments[3];t={width:e,height:i,scaleMode:s,resolution:n}}t.width=t.width??100,t.height=t.height??100,t.multisample??(t.multisample=Bt.NONE),super(null,t),this.mipmap=ur.OFF,this.valid=!0,this._clear=new Ri([0,0,0,0]),this.framebuffer=new Co(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Me extends Ti{constructor(t){const e=t,i=e.naturalWidth||e.videoWidth||e.displayWidth||e.width,s=e.naturalHeight||e.videoHeight||e.displayHeight||e.height;super(i,s),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,i){i===void 0&&!e.startsWith("data:")?t.crossOrigin=cv(e):i!==!1&&(t.crossOrigin=typeof i=="string"?i:"anonymous")}upload(t,e,i,s){const n=t.gl,a=e.realWidth,o=e.realHeight;if(s=s||this.source,typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement){if(!s.complete||s.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement&&s.readyState<=1)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===fr.UNPACK),!this.noSubImage&&e.target===n.TEXTURE_2D&&i.width===a&&i.height===o?n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,i.type,s):(i.width=a,i.height=o,n.texImage2D(e.target,0,i.internalFormat,e.format,i.type,s)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(e,i),super.update()}dispose(){this.source=null}}class ip extends Me{constructor(t,e){if(e=e||{},typeof t=="string"){const i=new Image;Me.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??lt.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,i)=>{const s=this.source;this.url=s.src;const n=()=>{this.destroyed||(s.onload=null,s.onerror=null,this.update(),this._load=null,this.createBitmap?e(this.process()):e(this))};s.complete&&s.src?n():(s.onload=n,s.onerror=a=>{i(a),this.onError.emit(a)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,i=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:i?"cors":"no-cors"}).then(s=>s.blob()).then(s=>e(s,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===fr.UNPACK?"premultiply":"none"})).then(s=>this.destroyed?Promise.reject():(this.bitmap=s,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,i){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,i,this.bitmap),!this.preserveBitmap){let s=!0;const n=e._glTextures;for(const a in n){const o=n[a];if(o!==i&&o.dirtyId!==e.dirtyId){s=!1;break}}s&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class lh{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,i){const s=e.width,n=e.height;if(i){const a=t.width/2/s,o=t.height/2/n,h=t.x/s+a,l=t.y/n+o;i=Pt.add(i,Pt.NW),this.x0=h+a*Pt.uX(i),this.y0=l+o*Pt.uY(i),i=Pt.add(i,2),this.x1=h+a*Pt.uX(i),this.y1=l+o*Pt.uY(i),i=Pt.add(i,2),this.x2=h+a*Pt.uX(i),this.y2=l+o*Pt.uY(i),i=Pt.add(i,2),this.x3=h+a*Pt.uX(i),this.y3=l+o*Pt.uY(i)}else this.x0=t.x/s,this.y0=t.y/n,this.x1=(t.x+t.width)/s,this.y1=t.y/n,this.x2=(t.x+t.width)/s,this.y2=(t.y+t.height)/n,this.x3=t.x/s,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}lh.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Tu=new lh;function es(r){r.destroy=function(){},r.on=function(){},r.once=function(){},r.emit=function(){}}class ot extends js{constructor(t,e,i,s,n,a,o){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new Et(0,0,1,1)),t instanceof ot&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=s,this.valid=!1,this.destroyed=!1,this._uvs=Tu,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),n===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new Ct(a.x,a.y):new Ct(0,0),this.defaultBorders=o,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&_e[e.url]&&ot.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,ot.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var s;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),i=new ot(this.baseTexture,!this.noFrame&&t,e,(s=this.trim)==null?void 0:s.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=t),i}updateUvs(){this._uvs===Tu&&(this._uvs=new lh),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},i=lt.STRICT_TEXTURE_CACHE){const s=typeof t=="string";let n=null;if(s)n=t;else if(t instanceof xt){if(!t.cacheId){const o=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${o}-${Ai()}`,xt.addToCache(t,t.cacheId)}n=t.cacheId}else{if(!t._pixiId){const o=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${o}_${Ai()}`}n=t._pixiId}let a=_e[n];if(s&&i&&!a)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return!a&&!(t instanceof xt)?(e.resolution||(e.resolution=gu(t)),a=new ot(new xt(t,e)),a.baseTexture.cacheId=n,xt.addToCache(a.baseTexture,n),ot.addToCache(a,n)):!a&&t instanceof xt&&(a=new ot(t),ot.addToCache(a,n)),a}static fromURL(t,e){const i=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),s=ot.from(t,Object.assign({resourceOptions:i},e),!1),n=s.baseTexture.resource;return s.baseTexture.valid?Promise.resolve(s):n.load().then(()=>Promise.resolve(s))}static fromBuffer(t,e,i,s){return new ot(xt.fromBuffer(t,e,i,s))}static fromLoader(t,e,i,s){const n=new xt(t,Object.assign({scaleMode:xt.defaultOptions.scaleMode,resolution:gu(e)},s)),{resource:a}=n;a instanceof ip&&(a.url=e);const o=new ot(n);return i||(i=e),xt.addToCache(o.baseTexture,i),ot.addToCache(o,i),i!==e&&(xt.addToCache(o.baseTexture,e),ot.addToCache(o,e)),o.baseTexture.valid?Promise.resolve(o):new Promise(h=>{o.baseTexture.once("loaded",()=>h(o))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),_e[e]&&_e[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),_e[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=_e[t];if(e){const i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete _e[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)_e[t.textureCacheIds[e]]===t&&delete _e[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:i,width:s,height:n}=t,a=e+s>this.baseTexture.width,o=i+n>this.baseTexture.height;if(a||o){const h=a&&o?"and":"or",l=`X: ${e} + ${s} = ${e+s} > ${this.baseTexture.width}`,c=`Y: ${i} + ${n} = ${i+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${l} ${h} ${c}`)}this.valid=s&&n&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return ot._EMPTY||(ot._EMPTY=new ot(new xt),es(ot._EMPTY),es(ot._EMPTY.baseTexture)),ot._EMPTY}static get WHITE(){if(!ot._WHITE){const t=lt.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),ot._WHITE=new ot(xt.from(t)),es(ot._WHITE),es(ot._WHITE.baseTexture)}return ot._WHITE}}class qs extends ot{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,i=!0){const s=this.baseTexture.resolution,n=Math.round(t*s)/s,a=Math.round(e*s)/s;this.valid=n>0&&a>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=a,i&&this.baseTexture.resize(n,a),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new qs(new rp(t))}}class sp{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,i=Bt.NONE){const s=new rp(Object.assign({width:t,height:e,resolution:1,multisample:i},this.textureOptions));return new qs(s)}getOptimalTexture(t,e,i=1,s=Bt.NONE){let n;t=Math.max(Math.ceil(t*i-1e-6),1),e=Math.max(Math.ceil(e*i-1e-6),1),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=Ms(t),e=Ms(e),n=((t&65535)<<16|e&65535)>>>0,s>1&&(n+=s*4294967296)):n=s>1?-s:-1,this.texturePool[n]||(this.texturePool[n]=[]);let a=this.texturePool[n].pop();return a||(a=this.createTexture(t,e,s)),a.filterPoolKey=n,a.setResolution(i),a}getFilterTexture(t,e,i){const s=this.getOptimalTexture(t.width,t.height,e||t.resolution,i||Bt.NONE);return s.filterFrame=t.filterFrame,s}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const i=this.texturePool[e];if(i)for(let s=0;s<i.length;s++)i[s].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const i=this.texturePool[e];if(i)for(let s=0;s<i.length;s++)i[s].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}sp.SCREEN_KEY=-1;class jv extends Ur{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class Yv extends Ur{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Wt(this.vertices),this.uvBuffer=new Wt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let i=0,s=0;return this.uvs[0]=i,this.uvs[1]=s,this.uvs[2]=i+e.width/t.width,this.uvs[3]=s,this.uvs[4]=i+e.width/t.width,this.uvs[5]=s+e.height/t.height,this.uvs[6]=i,this.uvs[7]=s+e.height/t.height,i=e.x,s=e.y,this.vertices[0]=i,this.vertices[1]=s,this.vertices[2]=i+e.width,this.vertices[3]=s,this.vertices[4]=i+e.width,this.vertices[5]=s+e.height,this.vertices[6]=i,this.vertices[7]=s+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class qv{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Bt.NONE,this.sourceFrame=new Et,this.destinationFrame=new Et,this.bindingSourceFrame=new Et,this.bindingDestinationFrame=new Et,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const rs=[new Ct,new Ct,new Ct,new Ct],Ba=new Dt;class np{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new sp,this.statePool=[],this.quad=new jv,this.quadUv=new Yv,this.tempRect=new Et,this.activeState={},this.globalUniforms=new Ae({outputFrame:new Et,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const i=this.renderer,s=this.defaultFilterStack,n=this.statePool.pop()||new qv,a=i.renderTexture;let o,h;if(a.current){const p=a.current;o=p.resolution,h=p.multisample}else o=i.resolution,h=i.multisample;let l=e[0].resolution||o,c=e[0].multisample??h,u=e[0].padding,f=e[0].autoFit,d=e[0].legacy??!0;for(let p=1;p<e.length;p++){const m=e[p];l=Math.min(l,m.resolution||o),c=Math.min(c,m.multisample??h),u=this.useMaxPadding?Math.max(u,m.padding):u+m.padding,f=f&&m.autoFit,d=d||(m.legacy??!0)}s.length===1&&(this.defaultFilterStack[0].renderTexture=a.current),s.push(n),n.resolution=l,n.multisample=c,n.legacy=d,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(u);const g=this.tempRect.copyFrom(a.sourceFrame);i.projection.transform&&this.transformAABB(Ba.copyFrom(i.projection.transform).invert(),g),f?(n.sourceFrame.fit(g),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(g)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,a.current?a.current.resolution:i.resolution,a.sourceFrame,a.destinationFrame,i.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,l,c),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;const y=this.tempRect;y.x=0,y.y=0,y.width=n.sourceFrame.width,y.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(a.sourceFrame),n.bindingDestinationFrame.copyFrom(a.destinationFrame),n.transform=i.projection.transform,i.projection.transform=null,a.bind(n.renderTexture,n.sourceFrame,y),i.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;const s=this.globalUniforms.uniforms;s.outputFrame=e.sourceFrame,s.resolution=e.resolution;const n=s.inputSize,a=s.inputPixel,o=s.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],a[0]=Math.round(n[0]*e.resolution),a[1]=Math.round(n[1]*e.resolution),a[2]=1/a[0],a[3]=1/a[1],o[0]=.5*a[2],o[1]=.5*a[3],o[2]=e.sourceFrame.width*n[2]-.5*a[2],o[3]=e.sourceFrame.height*n[3]-.5*a[3],e.legacy){const l=s.filterArea;l[0]=e.destinationFrame.width,l[1]=e.destinationFrame.height,l[2]=e.sourceFrame.x,l[3]=e.sourceFrame.y,s.filterClamp=s.inputClamp}this.globalUniforms.update();const h=t[t.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,e.renderTexture,h.renderTexture,tr.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let l=e.renderTexture,c=this.getOptimalFilterTexture(l.width,l.height,e.resolution);c.filterFrame=l.filterFrame;let u=0;for(u=0;u<i.length-1;++u){u===1&&e.multisample>1&&(c=this.getOptimalFilterTexture(l.width,l.height,e.resolution),c.filterFrame=l.filterFrame),i[u].apply(this,l,c,tr.CLEAR,e);const f=l;l=c,c=f}i[u].apply(this,l,h.renderTexture,tr.BLEND,e),u>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(l),this.returnFilterTexture(c)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=tr.CLEAR){const{renderTexture:i,state:s}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t==null?void 0:t.filterFrame){const a=this.tempRect;a.x=0,a.y=0,a.width=t.filterFrame.width,a.height=t.filterFrame.height,i.bind(t,t.filterFrame,a)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const n=s.stateId&1||this.forceClear;(e===tr.CLEAR||e===tr.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,i,s){const n=this.renderer;n.state.set(t.state),this.bindAndClear(i,s),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(Rs.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(Rs.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:i,destinationFrame:s}=this.activeState,{orig:n}=e._texture,a=t.set(s.width,0,0,s.height,i.x,i.y),o=e.worldTransform.copyTo(Dt.TEMP_MATRIX);return o.invert(),a.prepend(o),a.scale(1/n.width,1/n.height),a.translate(e.anchor.x,e.anchor.y),a}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,i=1,s=Bt.NONE){return this.texturePool.getOptimalTexture(t,e,i,s)}getFilterTexture(t,e,i){if(typeof t=="number"){const n=t;t=e,e=n}t=t||this.activeState.renderTexture;const s=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,i||Bt.NONE);return s.filterFrame=t.filterFrame,s}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const i=rs[0],s=rs[1],n=rs[2],a=rs[3];i.set(e.left,e.top),s.set(e.left,e.bottom),n.set(e.right,e.top),a.set(e.right,e.bottom),t.apply(i,i),t.apply(s,s),t.apply(n,n),t.apply(a,a);const o=Math.min(i.x,s.x,n.x,a.x),h=Math.min(i.y,s.y,n.y,a.y),l=Math.max(i.x,s.x,n.x,a.x),c=Math.max(i.y,s.y,n.y,a.y);e.x=o,e.y=h,e.width=l-o,e.height=c-h}roundFrame(t,e,i,s,n){if(!(t.width<=0||t.height<=0||i.width<=0||i.height<=0)){if(n){const{a,b:o,c:h,d:l}=n;if((Math.abs(o)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(l)>1e-4))return}n=n?Ba.copyFrom(n):Ba.identity(),n.translate(-i.x,-i.y).scale(s.width/i.width,s.height/i.height).translate(s.x,s.y),this.transformAABB(n,t),t.ceil(e),this.transformAABB(n.invert(),t)}}}np.extension={type:ct.RendererSystem,name:"filter"};_t.add(np);class Kv{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Bt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const Zv=new Et;class ap{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Co(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Et,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;lt.PREFER_ENV===dr.WEBGL_LEGACY&&(e=null,i=null),e?t.drawBuffers=s=>e.drawBuffersWEBGL(s):(this.hasMRT=!1,t.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,i=0){const{gl:s}=this;if(t){const n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,s.bindFramebuffer(s.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=i),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let a=0;a<t.colorTextures.length;a++){const o=t.colorTextures[a];this.renderer.texture.unbind(o.parentTextureArray||o)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const a=e.width>>i,o=e.height>>i,h=a/e.width;this.setViewport(e.x*h,e.y*h,a,o)}else{const a=t.width>>i,o=t.height>>i;this.setViewport(0,0,a,o)}}else this.current&&(this.current=null,s.bindFramebuffer(s.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,i,s){const n=this.viewport;t=Math.round(t),e=Math.round(e),i=Math.round(i),s=Math.round(s),(n.width!==i||n.height!==s||n.x!==t||n.y!==e)&&(n.x=t,n.y=e,n.width=i,n.height=s,this.gl.viewport(t,e,i,s))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,i,s,n=yo.COLOR|yo.DEPTH){const{gl:a}=this;a.clearColor(t,e,i,s),a.clear(n)}initFramebuffer(t){const{gl:e}=this,i=new Kv(e.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i}resizeFramebuffer(t){const{gl:e}=this,i=t.glFramebuffers[this.CONTEXT_UID];if(i.stencil){e.bindRenderbuffer(e.RENDERBUFFER,i.stencil);let a;this.renderer.context.webGLVersion===1?a=e.DEPTH_STENCIL:t.depth&&t.stencil?a=e.DEPTH24_STENCIL8:t.depth?a=e.DEPTH_COMPONENT24:a=e.STENCIL_INDEX8,i.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,a,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,a,t.width,t.height)}const s=t.colorTextures;let n=s.length;e.drawBuffers||(n=Math.min(n,1));for(let a=0;a<n;a++){const o=s[a],h=o.parentTextureArray||o;this.renderer.texture.bind(h,0),a===0&&i.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,i.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:i}=this,s=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures;let a=n.length;i.drawBuffers||(a=Math.min(a,1)),s.multisample>1&&this.canMultisampleFramebuffer(t)?s.msaaBuffer=s.msaaBuffer||i.createRenderbuffer():s.msaaBuffer&&(i.deleteRenderbuffer(s.msaaBuffer),s.msaaBuffer=null,s.blitFramebuffer&&(s.blitFramebuffer.dispose(),s.blitFramebuffer=null));const o=[];for(let h=0;h<a;h++){const l=n[h],c=l.parentTextureArray||l;this.renderer.texture.bind(c,0),h===0&&s.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,s.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,s.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,s.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+h,l.target,c._glTextures[this.CONTEXT_UID].texture,e),o.push(i.COLOR_ATTACHMENT0+h))}if(o.length>1&&i.drawBuffers(o),t.depthTexture&&this.writeDepthTexture){const h=t.depthTexture;this.renderer.texture.bind(h,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,h._glTextures[this.CONTEXT_UID].texture,e)}if((t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)){s.stencil=s.stencil||i.createRenderbuffer();let h,l;this.renderer.context.webGLVersion===1?(h=i.DEPTH_STENCIL_ATTACHMENT,l=i.DEPTH_STENCIL):t.depth&&t.stencil?(h=i.DEPTH_STENCIL_ATTACHMENT,l=i.DEPTH24_STENCIL8):t.depth?(h=i.DEPTH_ATTACHMENT,l=i.DEPTH_COMPONENT24):(h=i.STENCIL_ATTACHMENT,l=i.STENCIL_INDEX8),i.bindRenderbuffer(i.RENDERBUFFER,s.stencil),s.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,s.multisample,l,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,l,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,h,i.RENDERBUFFER,s.stencil)}else s.stencil&&(i.deleteRenderbuffer(s.stencil),s.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let i=Bt.NONE;if(t<=1||e===null)return i;for(let s=0;s<e.length;s++)if(e[s]<=t){i=e[s];break}return i===1&&(i=Bt.NONE),i}blit(t,e,i){const{current:s,renderer:n,gl:a,CONTEXT_UID:o}=this;if(n.context.webGLVersion!==2||!s)return;const h=s.glFramebuffers[o];if(!h)return;if(!t){if(!h.msaaBuffer)return;const c=s.colorTextures[0];if(!c)return;h.blitFramebuffer||(h.blitFramebuffer=new Co(s.width,s.height),h.blitFramebuffer.addColorTexture(0,c)),t=h.blitFramebuffer,t.colorTextures[0]!==c&&(t.colorTextures[0]=c,t.dirtyId++,t.dirtyFormat++),(t.width!==s.width||t.height!==s.height)&&(t.width=s.width,t.height=s.height,t.dirtyId++,t.dirtySize++)}e||(e=Zv,e.width=s.width,e.height=s.height),i||(i=e);const l=e.width===i.width&&e.height===i.height;this.bind(t),a.bindFramebuffer(a.READ_FRAMEBUFFER,h.framebuffer),a.blitFramebuffer(e.left,e.top,e.right,e.bottom,i.left,i.top,i.right,i.bottom,a.COLOR_BUFFER_BIT,l?a.NEAREST:a.LINEAR),a.bindFramebuffer(a.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,e){const i=t.glFramebuffers[this.CONTEXT_UID],s=this.gl;if(!i)return;delete t.glFramebuffers[this.CONTEXT_UID];const n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(s.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&s.deleteRenderbuffer(i.msaaBuffer),i.stencil&&s.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,e)}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil&&t.stencil)return;t.stencil=!0;const i=t.width,s=t.height,n=this.gl,a=e.stencil=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,a);let o,h;this.renderer.context.webGLVersion===1?(o=n.DEPTH_STENCIL_ATTACHMENT,h=n.DEPTH_STENCIL):t.depth?(o=n.DEPTH_STENCIL_ATTACHMENT,h=n.DEPTH24_STENCIL8):(o=n.STENCIL_ATTACHMENT,h=n.STENCIL_INDEX8),e.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,e.multisample,h,i,s):n.renderbufferStorage(n.RENDERBUFFER,h,i,s),n.framebufferRenderbuffer(n.FRAMEBUFFER,o,n.RENDERBUFFER,a)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Et}destroy(){this.renderer=null}}ap.extension={type:ct.RendererSystem,name:"framebuffer"};_t.add(ap);const La={5126:4,5123:2,5121:1};class op{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;lt.PREFER_ENV===dr.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=()=>i.createVertexArrayOES(),t.bindVertexArray=s=>i.bindVertexArrayOES(s),t.deleteVertexArray=s=>i.deleteVertexArrayOES(s)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=(s,n)=>i.vertexAttribDivisorANGLE(s,n),t.drawElementsInstanced=(s,n,a,o,h)=>i.drawElementsInstancedANGLE(s,n,a,o,h),t.drawArraysInstanced=(s,n,a,o)=>i.drawArraysInstancedANGLE(s,n,a,o)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:i}=this;let s=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;s||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=s={},n=!0);const a=s[e.program.id]||this.initGeometryVao(t,e,n);this._activeGeometry=t,this._activeVao!==a&&(this._activeVao=a,this.hasVao?i.bindVertexArray(a):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let i=0;i<t.buffers.length;i++){const s=t.buffers[i];e.update(s)}}checkCompatibility(t,e){const i=t.attributes,s=e.attributeData;for(const n in s)if(!i[n])throw new Error(`shader and geometry incompatible, geometry missing the "${n}" attribute`)}getSignature(t,e){const i=t.attributes,s=e.attributeData,n=["g",t.id];for(const a in i)s[a]&&n.push(a,s[a].location);return n.join("-")}initGeometryVao(t,e,i=!0){const s=this.gl,n=this.CONTEXT_UID,a=this.renderer.buffer,o=e.program;o.glPrograms[n]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,o);const h=this.getSignature(t,o),l=t.glVertexArrayObjects[this.CONTEXT_UID];let c=l[h];if(c)return l[o.id]=c,c;const u=t.buffers,f=t.attributes,d={},g={};for(const y in u)d[y]=0,g[y]=0;for(const y in f)!f[y].size&&o.attributeData[y]?f[y].size=o.attributeData[y].size:f[y].size||console.warn(`PIXI Geometry attribute '${y}' size cannot be determined (likely the bound shader does not have the attribute)`),d[f[y].buffer]+=f[y].size*La[f[y].type];for(const y in f){const p=f[y],m=p.size;p.stride===void 0&&(d[p.buffer]===m*La[p.type]?p.stride=0:p.stride=d[p.buffer]),p.start===void 0&&(p.start=g[p.buffer],g[p.buffer]+=m*La[p.type])}c=s.createVertexArray(),s.bindVertexArray(c);for(let y=0;y<u.length;y++){const p=u[y];a.bind(p),i&&p._glBuffers[n].refCount++}return this.activateVao(t,o),l[o.id]=c,l[h]=c,s.bindVertexArray(null),a.unbind(we.ARRAY_BUFFER),c}disposeGeometry(t,e){var o;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const i=t.glVertexArrayObjects[this.CONTEXT_UID],s=this.gl,n=t.buffers,a=(o=this.renderer)==null?void 0:o.buffer;if(t.disposeRunner.remove(this),!!i){if(a)for(let h=0;h<n.length;h++){const l=n[h]._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!e&&a.dispose(n[h],e))}if(!e){for(const h in i)if(h[0]==="g"){const l=i[h];this._activeVao===l&&this.unbind(),s.deleteVertexArray(l)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t)}activateVao(t,e){const i=this.gl,s=this.CONTEXT_UID,n=this.renderer.buffer,a=t.buffers,o=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);let h=null;for(const l in o){const c=o[l],u=a[c.buffer],f=u._glBuffers[s];if(e.attributeData[l]){h!==f&&(n.bind(u),h=f);const d=e.attributeData[l].location;if(i.enableVertexAttribArray(d),i.vertexAttribPointer(d,c.size,c.type||i.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)i.vertexAttribDivisor(d,c.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,i,s){const{gl:n}=this,a=this._activeGeometry;if(a.indexBuffer){const o=a.indexBuffer.data.BYTES_PER_ELEMENT,h=o===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;o===2||o===4&&this.canUseUInt32ElementIndex?a.instanced?n.drawElementsInstanced(t,e||a.indexBuffer.data.length,h,(i||0)*o,s||1):n.drawElements(t,e||a.indexBuffer.data.length,h,(i||0)*o):console.warn("unsupported index buffer type: uint32")}else a.instanced?n.drawArraysInstanced(t,i,e||a.getSize(),s||1):n.drawArrays(t,i,e||a.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}op.extension={type:ct.RendererSystem,name:"geometry"};_t.add(op);const Su=new Dt;class Qv{constructor(t,e){this._texture=t,this.mapCoord=new Dt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const i=this.mapCoord;for(let s=0;s<t.length;s+=2){const n=t[s],a=t[s+1];e[s]=n*i.a+a*i.c+i.tx,e[s+1]=n*i.b+a*i.d+i.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);const s=e.orig,n=e.trim;n&&(Su.set(s.width/n.width,0,0,s.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Su));const a=e.baseTexture,o=this.uClampFrame,h=this.clampMargin/a.resolution,l=this.clampOffset;return o[0]=(e._frame.x+h+l)/a.width,o[1]=(e._frame.y+h+l)/a.height,o[2]=(e._frame.x+e._frame.width-h+l)/a.width,o[3]=(e._frame.y+e._frame.height-h+l)/a.height,this.uClampOffset[0]=l/a.realWidth,this.uClampOffset[1]=l/a.realHeight,this.isSimple=e._frame.width===a.width&&e._frame.height===a.height&&e.rotate===0,!0}}var Jv=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,tb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class eb extends Er{constructor(t,e,i){let s=null;typeof t!="string"&&e===void 0&&i===void 0&&(s=t,t=void 0,e=void 0,i=void 0),super(t||tb,e||Jv,i),this.maskSprite=s,this.maskMatrix=new Dt}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,i,s){const n=this._maskSprite,a=n._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new Qv(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,t.applyFilter(this,e,i,s))}}class rb{constructor(t=null){this.type=Ut.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Er.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Ut.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class hp{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let i=e;if(!i.isMaskData){const n=this.maskDataPool.pop()||new rb;n.pooled=!0,n.maskObject=e,i=n}const s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(s),i._colorMask=s?s._colorMask:15,i.autoDetect&&this.detect(i),i._target=t,i.type!==Ut.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case Ut.SCISSOR:this.renderer.scissor.push(i);break;case Ut.STENCIL:this.renderer.stencil.push(i);break;case Ut.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case Ut.COLOR:this.pushColorMask(i);break}i.type===Ut.SPRITE&&this.maskStack.push(i)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case Ut.SCISSOR:this.renderer.scissor.pop(e);break;case Ut.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Ut.SPRITE:this.popSpriteMask(e);break;case Ut.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const i=this.maskStack[this.maskStack.length-1];i.type===Ut.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=Ut.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=Ut.SCISSOR:t.type=Ut.STENCIL:t.type=Ut.COLOR}pushSpriteMask(t){const{maskObject:e}=t,i=t._target;let s=t._filters;s||(s=this.alphaMaskPool[this.alphaMaskIndex],s||(s=this.alphaMaskPool[this.alphaMaskIndex]=[new eb])),s[0].resolution=t.resolution,s[0].multisample=t.multisample,s[0].maskSprite=e;const n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,s),i.filterArea=n,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,i=t._colorMask=e&t.colorMask;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(t){const e=t._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}}hp.extension={type:ct.RendererSystem,name:"mask"};_t.add(hp);class lp{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,i=this.getStackLength();this.maskStack=t;const s=this.getStackLength();s!==i&&(s===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Cu=new Dt,Eu=[],cp=class _s extends lp{constructor(t){super(t),this.glConst=lt.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;const e=t._scissorRect,{maskObject:i}=t,{renderer:s}=this,n=s.renderTexture,a=i.getBounds(!0,Eu.pop()??new Et);this.roundFrameToPixels(a,n.current?n.current.resolution:s.resolution,n.sourceFrame,n.destinationFrame,s.projection.transform),e&&a.fit(e),t._scissorRectLocal=a}static isMatrixRotated(t){if(!t)return!1;const{a:e,b:i,c:s,d:n}=t;return(Math.abs(i)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(n)>1e-4)}testScissor(t){const{maskObject:e}=t;if(!e.isFastRect||!e.isFastRect()||_s.isMatrixRotated(e.worldTransform)||_s.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);const i=t._scissorRectLocal;return i.width>0&&i.height>0}roundFrameToPixels(t,e,i,s,n){_s.isMatrixRotated(n)||(n=n?Cu.copyFrom(n):Cu.identity(),n.translate(-i.x,-i.y).scale(s.width/i.width,s.height/i.height).translate(s.x,s.y),this.renderer.filter.transformAABB(n,t),t.fit(s),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}push(t){t._scissorRectLocal||this.calcScissorRect(t);const{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){const{gl:e}=this.renderer;t&&Eu.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){const t=this.maskStack[this.maskStack.length-1]._scissorRect;let e;this.renderer.renderTexture.current?e=t.y:e=this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};cp.extension={type:ct.RendererSystem,name:"scissor"};let ib=cp;_t.add(ib);class up extends lp{constructor(t){super(t),this.glConst=lt.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:i}=this.renderer,s=t._stencilCounter;s===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),t._stencilCounter++;const n=t._colorMask;n!==0&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,s,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,n!==0&&(t._colorMask=n,i.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,s=i?i._colorMask:15;s!==0&&(i._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,s!==0&&(i._colorMask=s,e.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}up.extension={type:ct.RendererSystem,name:"stencil"};_t.add(up);class dp{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return yt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return yt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return yt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){const t=this.rendererPlugins;for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}dp.extension={type:[ct.RendererSystem,ct.CanvasRendererSystem],name:"_plugin"};_t.add(dp);class fp{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Dt,this.transform=null}update(t,e,i,s){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,s),this.transform&&this.projectionMatrix.append(this.transform);const n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(t,e,i,s){const n=this.projectionMatrix,a=s?-1:1;n.identity(),n.a=1/e.width*2,n.d=a*(1/e.height*2),n.tx=-1-e.x*n.a,n.ty=-a-e.y*n.d}setTransform(t){}destroy(){this.renderer=null}}fp.extension={type:ct.RendererSystem,name:"projection"};_t.add(fp);const sb=new hh,Iu=new Et;class pp{constructor(t){this.renderer=t,this._tempMatrix=new Dt}generateTexture(t,e){const{region:i,...s}=e||{},n=(i==null?void 0:i.copyTo(Iu))||t.getLocalBounds(Iu,!0),a=s.resolution||this.renderer.resolution;n.width=Math.max(n.width,1/a),n.height=Math.max(n.height,1/a),s.width=n.width,s.height=n.height,s.resolution=a,s.multisample??(s.multisample=this.renderer.multisample);const o=qs.create(s);this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;const h=t.transform;return t.transform=sb,this.renderer.render(t,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=h,o}destroy(){}}pp.extension={type:[ct.RendererSystem,ct.CanvasRendererSystem],name:"textureGenerator"};_t.add(pp);const je=new Et,ti=new Et;class mp{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Et,this.destinationFrame=new Et,this.viewportFrame=new Et}contextChange(){var e;const t=(e=this.renderer)==null?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,e,i){const s=this.renderer;this.current=t;let n,a,o;t?(n=t.baseTexture,o=n.resolution,e||(je.width=t.frame.width,je.height=t.frame.height,e=je),i||(ti.x=t.frame.x,ti.y=t.frame.y,ti.width=e.width,ti.height=e.height,i=ti),a=n.framebuffer):(o=s.resolution,e||(je.width=s._view.screen.width,je.height=s._view.screen.height,e=je),i||(i=je,i.width=e.width,i.height=e.height));const h=this.viewportFrame;h.x=i.x*o,h.y=i.y*o,h.width=i.width*o,h.height=i.height*o,t||(h.y=s.view.height-(h.y+h.height)),h.ceil(),this.renderer.framebuffer.bind(a,h),this.renderer.projection.update(i,e,o,!a),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(i)}clear(t,e){const i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,s=Ri.shared.setValue(t||i);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&s.premultiply(s.alpha);const n=this.destinationFrame,a=this.current?this.current.baseTexture:this.renderer._view.screen,o=n.width!==a.width||n.height!==a.height;if(o){let{x:h,y:l,width:c,height:u}=this.viewportFrame;h=Math.round(h),l=Math.round(l),c=Math.round(c),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(h,l,c,u)}this.renderer.framebuffer.clear(s.red,s.green,s.blue,s.alpha,e),o&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}mp.extension={type:ct.RendererSystem,name:"renderTexture"};_t.add(mp);class nb{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function ab(r,t){const e={},i=t.getProgramParameter(r,t.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){const n=t.getActiveAttrib(r,s);if(n.name.startsWith("gl_"))continue;const a=Jf(t,n.type),o={type:a,name:n.name,size:Qf(a),location:t.getAttribLocation(r,n.name)};e[n.name]=o}return e}function ob(r,t){const e={},i=t.getProgramParameter(r,t.ACTIVE_UNIFORMS);for(let s=0;s<i;s++){const n=t.getActiveUniform(r,s),a=n.name.replace(/\[.*?\]$/,""),o=!!n.name.match(/\[.*?\]$/),h=Jf(t,n.type);e[a]={name:a,index:s,type:h,size:n.size,isArray:o,value:Kf(h,n.size)}}return e}function hb(r,t){var o;const e=xu(r,r.VERTEX_SHADER,t.vertexSrc),i=xu(r,r.FRAGMENT_SHADER,t.fragmentSrc),s=r.createProgram();r.attachShader(s,e),r.attachShader(s,i);const n=(o=t.extra)==null?void 0:o.transformFeedbackVaryings;if(n&&(typeof r.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):r.transformFeedbackVaryings(s,n.names,n.bufferMode==="separate"?r.SEPARATE_ATTRIBS:r.INTERLEAVED_ATTRIBS)),r.linkProgram(s),r.getProgramParameter(s,r.LINK_STATUS)||Bv(r,s,e,i),t.attributeData=ab(s,r),t.uniformData=ob(s,r),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const h=Object.keys(t.attributeData);h.sort((l,c)=>l>c?1:-1);for(let l=0;l<h.length;l++)t.attributeData[h[l]].location=l,r.bindAttribLocation(s,l,h[l]);r.linkProgram(s)}r.deleteShader(e),r.deleteShader(i);const a={};for(const h in t.uniformData){const l=t.uniformData[h];a[h]={location:r.getUniformLocation(s,h),value:Kf(l.type,l.size)}}return new nb(s,a)}function lb(r,t,e,i,s){e.buffer.update(s)}const cb={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},gp={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function ub(r){const t=r.map(n=>({data:n,offset:0,dataLen:0,dirty:0}));let e=0,i=0,s=0;for(let n=0;n<t.length;n++){const a=t[n];if(e=gp[a.data.type],a.data.size>1&&(e=Math.max(e,16)*a.data.size),a.dataLen=e,i%e!==0&&i<16){const o=i%e%16;i+=o,s+=o}i+e>16?(s=Math.ceil(s/16)*16,a.offset=s,s+=e,i=e):(a.offset=s,i+=e,s+=e)}return s=Math.ceil(s/16)*16,{uboElements:t,size:s}}function db(r,t){const e=[];for(const i in r)t[i]&&e.push(t[i]);return e.sort((i,s)=>i.index-s.index),e}function fb(r,t){if(!r.autoManage)return{size:0,syncFunc:lb};const e=db(r.uniforms,t),{uboElements:i,size:s}=ub(e),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let a=0;a<i.length;a++){const o=i[a],h=r.uniforms[o.data.name],l=o.data.name;let c=!1;for(let u=0;u<kr.length;u++){const f=kr[u];if(f.codeUbo&&f.test(o.data,h)){n.push(`offset = ${o.offset/4};`,kr[u].codeUbo(o.data.name,h)),c=!0;break}}if(!c)if(o.data.size>1){const u=Qf(o.data.type),f=Math.max(gp[o.data.type]/16,1),d=u/f,g=(4-d%4)%4;n.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${o.offset/4};

                t = 0;

                for(var i=0; i < ${o.data.size*f}; i++)
                {
                    for(var j = 0; j < ${d}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${g};
                }

                `)}else{const u=cb[o.data.type];n.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${o.offset/4};
                ${u};
                `)}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:s,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}let pb=0;const is={textureCount:0,uboCount:0};class yp{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=pb++}systemCheck(){if(!Nv())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const i=t.program,s=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(s.program)),e||(is.textureCount=0,is.uboCount=0,this.syncUniformGroup(t.uniformGroup,is)),s}setUniforms(t){const e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)}syncUniformGroup(t,e){const i=this.getGlProgram();(!t.static||t.dirtyId!==i.uniformDirtyGroups[t.id])&&(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,e))}syncUniforms(t,e,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,i)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=Mv(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const i=this.getGlProgram();if(!t.static||t.dirtyId!==0||!i.uniformGroups[t.id]){t.dirtyId=0;const s=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,e);t.buffer.update(),s(i.uniformData,t.uniforms,this.renderer,is,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[e])}createSyncBufferGroup(t,e,i){const{gl:s}=this.renderer;this.renderer.buffer.bind(t.buffer);const n=this.gl.getUniformBlockIndex(e.program,i);e.uniformBufferBindings[i]=this.shader.uniformBindCount,s.uniformBlockBinding(e.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;const a=this.getSignature(t,this.shader.program.uniformData,"ubo");let o=this._uboCache[a];if(o||(o=this._uboCache[a]=fb(t,this.shader.program.uniformData)),t.autoManage){const h=new Float32Array(o.size/4);t.buffer.update(h)}return e.uniformGroups[t.id]=o.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,i){const s=t.uniforms,n=[`${i}-`];for(const a in s)n.push(a),e[a]&&n.push(e[a].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,i=t.program,s=hb(e,i);return i.glPrograms[this.renderer.CONTEXT_UID]=s,s}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}yp.extension={type:ct.RendererSystem,name:"shader"};_t.add(yp);class Ls{constructor(t){this.renderer=t}run(t){const{renderer:e}=this;e.runners.init.emit(e.options),t.hello&&console.log(`PixiJS 7.4.2 - ${e.rendererLogId} - https://pixijs.com`),e.resize(e.screen.width,e.screen.height)}destroy(){}}Ls.defaultOptions={hello:!1},Ls.extension={type:[ct.RendererSystem,ct.CanvasRendererSystem],name:"startup"};_t.add(Ls);function mb(r,t=[]){return t[et.NORMAL]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.ADD]=[r.ONE,r.ONE],t[et.MULTIPLY]=[r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.SCREEN]=[r.ONE,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.OVERLAY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.DARKEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.LIGHTEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.COLOR_DODGE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.COLOR_BURN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.HARD_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.SOFT_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.DIFFERENCE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.EXCLUSION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.HUE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.SATURATION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.COLOR]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.LUMINOSITY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.NONE]=[0,0],t[et.NORMAL_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.ADD_NPM]=[r.SRC_ALPHA,r.ONE,r.ONE,r.ONE],t[et.SCREEN_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[et.SRC_IN]=[r.DST_ALPHA,r.ZERO],t[et.SRC_OUT]=[r.ONE_MINUS_DST_ALPHA,r.ZERO],t[et.SRC_ATOP]=[r.DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],t[et.DST_OVER]=[r.ONE_MINUS_DST_ALPHA,r.ONE],t[et.DST_IN]=[r.ZERO,r.SRC_ALPHA],t[et.DST_OUT]=[r.ZERO,r.ONE_MINUS_SRC_ALPHA],t[et.DST_ATOP]=[r.ONE_MINUS_DST_ALPHA,r.SRC_ALPHA],t[et.XOR]=[r.ONE_MINUS_DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],t[et.SUBTRACT]=[r.ONE,r.ONE,r.ONE,r.ONE,r.FUNC_REVERSE_SUBTRACT,r.FUNC_ADD],t}const gb=0,yb=1,_b=2,xb=3,vb=4,bb=5,_p=class Eo{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=et.NONE,this._blendEq=!1,this.map=[],this.map[gb]=this.setBlend,this.map[yb]=this.setOffset,this.map[_b]=this.setCullFace,this.map[xb]=this.setDepthTest,this.map[vb]=this.setFrontFace,this.map[bb]=this.setDepthMask,this.checks=[],this.defaultState=new zr,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=mb(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,i=0;for(;e;)e&1&&this.map[i].call(this,!!(t.data&1<<i)),e=e>>1,i++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(t){this.updateCheck(Eo.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(Eo.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;const e=this.blendModes[t],i=this.gl;e.length===2?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),e.length===6?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){const i=this.checks.indexOf(t);e&&i===-1?this.checks.push(t):!e&&i!==-1&&this.checks.splice(i,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};_p.extension={type:ct.RendererSystem,name:"state"};let wb=_p;_t.add(wb);class Ab extends js{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(s=>t.systems[s]),i=[...e,...Object.keys(t.systems).filter(s=>!e.includes(s))];for(const s of i)this.addSystem(t.systems[s],s)}addRunners(...t){t.forEach(e=>{this.runners[e]=new fe(e)})}addSystem(t,e){const i=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=i,this._systemsHash[e]=i;for(const s in this.runners)this.runners[s].add(i);return this}emitWithCustomOptions(t,e){const i=Object.keys(this._systemsHash);t.items.forEach(s=>{const n=i.find(a=>this._systemsHash[a]===s);s[t.name](e[n])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const ci=class xs{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=xs.defaultMaxIdle,this.checkCountMax=xs.defaultCheckCountMax,this.mode=xs.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==sh.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this.renderer.texture,e=t.managedTextures;let i=!1;for(let s=0;s<e.length;s++){const n=e[s];n.resource&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[s]=null,i=!0)}if(i){let s=0;for(let n=0;n<e.length;n++)e[n]!==null&&(e[s++]=e[n]);e.length=s}}unload(t){const e=this.renderer.texture,i=t._texture;i&&!i.framebuffer&&e.destroyTexture(i);for(let s=t.children.length-1;s>=0;s--)this.unload(t.children[s])}destroy(){this.renderer=null}};ci.defaultMode=sh.AUTO,ci.defaultMaxIdle=60*60,ci.defaultCheckCountMax=60*10,ci.extension={type:ct.RendererSystem,name:"textureGC"};let ar=ci;_t.add(ar);class Na{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=at.UNSIGNED_BYTE,this.internalFormat=$.RGBA,this.samplerType=0}}function Tb(r){let t;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?t={[r.RGB]:V.FLOAT,[r.RGBA]:V.FLOAT,[r.ALPHA]:V.FLOAT,[r.LUMINANCE]:V.FLOAT,[r.LUMINANCE_ALPHA]:V.FLOAT,[r.R8]:V.FLOAT,[r.R8_SNORM]:V.FLOAT,[r.RG8]:V.FLOAT,[r.RG8_SNORM]:V.FLOAT,[r.RGB8]:V.FLOAT,[r.RGB8_SNORM]:V.FLOAT,[r.RGB565]:V.FLOAT,[r.RGBA4]:V.FLOAT,[r.RGB5_A1]:V.FLOAT,[r.RGBA8]:V.FLOAT,[r.RGBA8_SNORM]:V.FLOAT,[r.RGB10_A2]:V.FLOAT,[r.RGB10_A2UI]:V.FLOAT,[r.SRGB8]:V.FLOAT,[r.SRGB8_ALPHA8]:V.FLOAT,[r.R16F]:V.FLOAT,[r.RG16F]:V.FLOAT,[r.RGB16F]:V.FLOAT,[r.RGBA16F]:V.FLOAT,[r.R32F]:V.FLOAT,[r.RG32F]:V.FLOAT,[r.RGB32F]:V.FLOAT,[r.RGBA32F]:V.FLOAT,[r.R11F_G11F_B10F]:V.FLOAT,[r.RGB9_E5]:V.FLOAT,[r.R8I]:V.INT,[r.R8UI]:V.UINT,[r.R16I]:V.INT,[r.R16UI]:V.UINT,[r.R32I]:V.INT,[r.R32UI]:V.UINT,[r.RG8I]:V.INT,[r.RG8UI]:V.UINT,[r.RG16I]:V.INT,[r.RG16UI]:V.UINT,[r.RG32I]:V.INT,[r.RG32UI]:V.UINT,[r.RGB8I]:V.INT,[r.RGB8UI]:V.UINT,[r.RGB16I]:V.INT,[r.RGB16UI]:V.UINT,[r.RGB32I]:V.INT,[r.RGB32UI]:V.UINT,[r.RGBA8I]:V.INT,[r.RGBA8UI]:V.UINT,[r.RGBA16I]:V.INT,[r.RGBA16UI]:V.UINT,[r.RGBA32I]:V.INT,[r.RGBA32UI]:V.UINT,[r.DEPTH_COMPONENT16]:V.FLOAT,[r.DEPTH_COMPONENT24]:V.FLOAT,[r.DEPTH_COMPONENT32F]:V.FLOAT,[r.DEPTH_STENCIL]:V.FLOAT,[r.DEPTH24_STENCIL8]:V.FLOAT,[r.DEPTH32F_STENCIL8]:V.FLOAT}:t={[r.RGB]:V.FLOAT,[r.RGBA]:V.FLOAT,[r.ALPHA]:V.FLOAT,[r.LUMINANCE]:V.FLOAT,[r.LUMINANCE_ALPHA]:V.FLOAT,[r.DEPTH_STENCIL]:V.FLOAT},t}function Sb(r){let t;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?t={[at.UNSIGNED_BYTE]:{[$.RGBA]:r.RGBA8,[$.RGB]:r.RGB8,[$.RG]:r.RG8,[$.RED]:r.R8,[$.RGBA_INTEGER]:r.RGBA8UI,[$.RGB_INTEGER]:r.RGB8UI,[$.RG_INTEGER]:r.RG8UI,[$.RED_INTEGER]:r.R8UI,[$.ALPHA]:r.ALPHA,[$.LUMINANCE]:r.LUMINANCE,[$.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[at.BYTE]:{[$.RGBA]:r.RGBA8_SNORM,[$.RGB]:r.RGB8_SNORM,[$.RG]:r.RG8_SNORM,[$.RED]:r.R8_SNORM,[$.RGBA_INTEGER]:r.RGBA8I,[$.RGB_INTEGER]:r.RGB8I,[$.RG_INTEGER]:r.RG8I,[$.RED_INTEGER]:r.R8I},[at.UNSIGNED_SHORT]:{[$.RGBA_INTEGER]:r.RGBA16UI,[$.RGB_INTEGER]:r.RGB16UI,[$.RG_INTEGER]:r.RG16UI,[$.RED_INTEGER]:r.R16UI,[$.DEPTH_COMPONENT]:r.DEPTH_COMPONENT16},[at.SHORT]:{[$.RGBA_INTEGER]:r.RGBA16I,[$.RGB_INTEGER]:r.RGB16I,[$.RG_INTEGER]:r.RG16I,[$.RED_INTEGER]:r.R16I},[at.UNSIGNED_INT]:{[$.RGBA_INTEGER]:r.RGBA32UI,[$.RGB_INTEGER]:r.RGB32UI,[$.RG_INTEGER]:r.RG32UI,[$.RED_INTEGER]:r.R32UI,[$.DEPTH_COMPONENT]:r.DEPTH_COMPONENT24},[at.INT]:{[$.RGBA_INTEGER]:r.RGBA32I,[$.RGB_INTEGER]:r.RGB32I,[$.RG_INTEGER]:r.RG32I,[$.RED_INTEGER]:r.R32I},[at.FLOAT]:{[$.RGBA]:r.RGBA32F,[$.RGB]:r.RGB32F,[$.RG]:r.RG32F,[$.RED]:r.R32F,[$.DEPTH_COMPONENT]:r.DEPTH_COMPONENT32F},[at.HALF_FLOAT]:{[$.RGBA]:r.RGBA16F,[$.RGB]:r.RGB16F,[$.RG]:r.RG16F,[$.RED]:r.R16F},[at.UNSIGNED_SHORT_5_6_5]:{[$.RGB]:r.RGB565},[at.UNSIGNED_SHORT_4_4_4_4]:{[$.RGBA]:r.RGBA4},[at.UNSIGNED_SHORT_5_5_5_1]:{[$.RGBA]:r.RGB5_A1},[at.UNSIGNED_INT_2_10_10_10_REV]:{[$.RGBA]:r.RGB10_A2,[$.RGBA_INTEGER]:r.RGB10_A2UI},[at.UNSIGNED_INT_10F_11F_11F_REV]:{[$.RGB]:r.R11F_G11F_B10F},[at.UNSIGNED_INT_5_9_9_9_REV]:{[$.RGB]:r.RGB9_E5},[at.UNSIGNED_INT_24_8]:{[$.DEPTH_STENCIL]:r.DEPTH24_STENCIL8},[at.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[$.DEPTH_STENCIL]:r.DEPTH32F_STENCIL8}}:t={[at.UNSIGNED_BYTE]:{[$.RGBA]:r.RGBA,[$.RGB]:r.RGB,[$.ALPHA]:r.ALPHA,[$.LUMINANCE]:r.LUMINANCE,[$.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[at.UNSIGNED_SHORT_5_6_5]:{[$.RGB]:r.RGB},[at.UNSIGNED_SHORT_4_4_4_4]:{[$.RGBA]:r.RGBA},[at.UNSIGNED_SHORT_5_5_5_1]:{[$.RGBA]:r.RGBA}},t}class xp{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new xt,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=Sb(t),this.samplerTypes=Tb(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let s=0;s<e;s++)this.boundTextures[s]=null;this.emptyTextures={};const i=new Na(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Na(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let s=0;s<6;s++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let s=0;s<this.boundTextures.length;s++)this.bind(null,s)}bind(t,e=0){const{gl:i}=this;if(t=t==null?void 0:t.castToBaseTexture(),(t==null?void 0:t.valid)&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const s=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,s.texture)),s.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)):s.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let s=0;s<i.length;s++)i[s]===this.unknownTexture&&this.bind(null,s)}for(let s=0;s<i.length;s++)i[s]===t&&(this.currentLocation!==s&&(e.activeTexture(e.TEXTURE0+s),this.currentLocation=s),e.bindTexture(t.target,this.emptyTextures[t.target].texture),i[s]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:i,CONTEXT_UID:s}=this;if(i)for(let n=t-1;n>=0;--n){const a=e[n];a&&a._glTextures[s].samplerType!==V.FLOAT&&this.renderer.texture.unbind(a)}}initTexture(t){const e=new Na(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var i;e.internalFormat=((i=this.internalFormats[t.type])==null?void 0:i[t.format])??t.format,e.samplerType=this.samplerTypes[e.internalFormat]??V.FLOAT,this.webGLVersion===2&&t.type===at.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var s;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const i=this.renderer;if(this.initTextureType(t,e),(s=t.resource)==null?void 0:s.upload(i,t,e))e.samplerType!==V.FLOAT&&(this.hasIntegerTextures=!0);else{const n=t.realWidth,a=t.realHeight,o=i.gl;(e.width!==n||e.height!==a||e.dirtyId<0)&&(e.width=n,e.height=a,o.texImage2D(t.target,0,e.internalFormat,n,a,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:i}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const s=this.managedTextures.indexOf(t);s!==-1&&ys(this.managedTextures,s,1)}}updateTextureStyle(t){var i;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===ur.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=ih.CLAMP:e.wrapMode=t.wrapMode,(i=t.resource)!=null&&i.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const i=this.gl;if(e.mipmap&&t.mipmap!==ur.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===Ee.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);const s=this.renderer.context.extensions.anisotropicFiltering;if(s&&t.anisotropicLevel>0&&t.scaleMode===Ee.LINEAR){const n=Math.min(t.anisotropicLevel,i.getParameter(s.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,s.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===Ee.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===Ee.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}}xp.extension={type:ct.RendererSystem,name:"texture"};_t.add(xp);class vp{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:i}=this,s=t._glTransformFeedbacks[i]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,s)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:i,renderer:s}=this;e&&s.shader.bind(e),i.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:i,CONTEXT_UID:s}=this,n=e.createTransformFeedback();t._glTransformFeedbacks[s]=n,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n);for(let a=0;a<t.buffers.length;a++){const o=t.buffers[a];o&&(i.buffer.update(o),o._glBuffers[s].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,a,o._glBuffers[s].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),n}disposeTransformFeedback(t,e){const i=t._glTransformFeedbacks[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this);const n=this.renderer.buffer;if(n)for(let a=0;a<t.buffers.length;a++){const o=t.buffers[a];if(!o)continue;const h=o._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!e&&n.dispose(o,e))}i&&(e||s.deleteTransformFeedback(i),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}vp.extension={type:ct.RendererSystem,name:"transformFeedback"};_t.add(vp);class Ns{constructor(t){this.renderer=t}init(t){this.screen=new Et(0,0,t.width,t.height),this.element=t.view||lt.ADAPTER.createCanvas(),this.resolution=t.resolution||lt.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const i=this.element.width/this.resolution,s=this.element.height/this.resolution;this.screen.width=i,this.screen.height=s,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${s}px`),this.renderer.emit("resize",i,s),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}Ns.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},Ns.extension={type:[ct.RendererSystem,ct.CanvasRendererSystem],name:"_view"};_t.add(Ns);lt.PREFER_ENV=dr.WEBGL2;lt.STRICT_TEXTURE_CACHE=!1;lt.RENDER_OPTIONS={...Bs.defaultOptions,...ks.defaultOptions,...Ns.defaultOptions,...Ls.defaultOptions};Object.defineProperties(lt,{WRAP_MODE:{get(){return xt.defaultOptions.wrapMode},set(r){yt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),xt.defaultOptions.wrapMode=r}},SCALE_MODE:{get(){return xt.defaultOptions.scaleMode},set(r){yt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),xt.defaultOptions.scaleMode=r}},MIPMAP_TEXTURES:{get(){return xt.defaultOptions.mipmap},set(r){yt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),xt.defaultOptions.mipmap=r}},ANISOTROPIC_LEVEL:{get(){return xt.defaultOptions.anisotropicLevel},set(r){yt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),xt.defaultOptions.anisotropicLevel=r}},FILTER_RESOLUTION:{get(){return yt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Er.defaultResolution},set(r){Er.defaultResolution=r}},FILTER_MULTISAMPLE:{get(){return yt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Er.defaultMultisample},set(r){Er.defaultMultisample=r}},SPRITE_MAX_TEXTURES:{get(){return nr.defaultMaxTextures},set(r){yt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),nr.defaultMaxTextures=r}},SPRITE_BATCH_SIZE:{get(){return nr.defaultBatchSize},set(r){yt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),nr.defaultBatchSize=r}},CAN_UPLOAD_SAME_BUFFER:{get(){return nr.canUploadSameBuffer},set(r){yt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),nr.canUploadSameBuffer=r}},GC_MODE:{get(){return ar.defaultMode},set(r){yt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),ar.defaultMode=r}},GC_MAX_IDLE:{get(){return ar.defaultMaxIdle},set(r){yt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),ar.defaultMaxIdle=r}},GC_MAX_CHECK_COUNT:{get(){return ar.defaultCheckCountMax},set(r){yt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),ar.defaultCheckCountMax=r}},PRECISION_VERTEX:{get(){return lr.defaultVertexPrecision},set(r){yt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),lr.defaultVertexPrecision=r}},PRECISION_FRAGMENT:{get(){return lr.defaultFragmentPrecision},set(r){yt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),lr.defaultFragmentPrecision=r}}});var Os=(r=>(r[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY",r))(Os||{});class Oa{constructor(t,e=null,i=0,s=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=i,this.once=s}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const bp=class ee{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Oa(null,null,1/0),this.deltaMS=1/ee.targetFPMS,this.elapsedMS=1/ee.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,i=Os.NORMAL){return this._addListener(new Oa(t,e,i))}addOnce(t,e,i=Os.NORMAL){return this._addListener(new Oa(t,e,i,!0))}_addListener(t){let e=this._head.next,i=this._head;if(!e)t.connect(i);else{for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}return this._startIfPossible(),this}remove(t,e){let i=this._head.next;for(;i;)i.match(t,e)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*ee.targetFPMS;const i=this._head;let s=i.next;for(;s;)s=s.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,ee.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!ee._shared){const t=ee._shared=new ee;t.autoStart=!0,t._protected=!0}return ee._shared}static get system(){if(!ee._system){const t=ee._system=new ee;t.autoStart=!0,t._protected=!0}return ee._system}};bp.targetFPMS=.06;let Ie=bp;Object.defineProperties(lt,{TARGET_FPMS:{get(){return Ie.targetFPMS},set(r){yt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Ie.targetFPMS=r}}});class wp{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,Os.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Ie.shared:new Ie,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}wp.extension=ct.Application;_t.add(wp);const Cb=[];_t.handleByList(ct.Renderer,Cb);class Ap{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const i=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,i)}else{const i=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,i)}e>=Bt.HIGH?this.multisample=Bt.HIGH:e>=Bt.MEDIUM?this.multisample=Bt.MEDIUM:e>=Bt.LOW?this.multisample=Bt.LOW:this.multisample=Bt.NONE}destroy(){}}Ap.extension={type:ct.RendererSystem,name:"_multisample"};_t.add(Ap);class Eb{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class Tp{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:i}=this,s=t._glBuffers[i]||this.createGLBuffer(t);e.bindBuffer(t.type,s.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:i,CONTEXT_UID:s}=this;if(this.boundBufferBases[e]!==t){const n=t._glBuffers[s]||this.createGLBuffer(t);this.boundBufferBases[e]=t,i.bindBufferBase(i.UNIFORM_BUFFER,e,n.buffer)}}bindBufferRange(t,e,i){const{gl:s,CONTEXT_UID:n}=this;i=i||0;const a=t._glBuffers[n]||this.createGLBuffer(t);s.bindBufferRange(s.UNIFORM_BUFFER,e||0,a.buffer,i*256,256)}update(t){const{gl:e,CONTEXT_UID:i}=this,s=t._glBuffers[i]||this.createGLBuffer(t);if(t._updateID!==s.updateID)if(s.updateID=t._updateID,e.bindBuffer(t.type,s.buffer),s.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const n=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;s.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,n)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const i=t._glBuffers[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this),i&&(e||s.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let i=0;i<e.length;i++)this.dispose(this.managedBuffers[e[i]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:i}=this;return t._glBuffers[e]=new Eb(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}Tp.extension={type:ct.RendererSystem,name:"buffer"};_t.add(Tp);class Sp{constructor(t){this.renderer=t}render(t,e){const i=this.renderer;let s,n,a,o;if(e&&(s=e.renderTexture,n=e.clear,a=e.transform,o=e.skipUpdateTransform),this.renderingToScreen=!s,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=a,!i.context.isLost){if(s||(this.lastObjectRendered=t),!o){const h=t.enableTempParent();t.updateTransform(),t.disableTempParent(h)}i.renderTexture.bind(s),i.batch.currentRenderer.start(),(n??i.background.clearBeforeRender)&&i.renderTexture.clear(),t.render(i),i.batch.currentRenderer.flush(),s&&(e.blit&&i.framebuffer.blit(),s.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}Sp.extension={type:ct.RendererSystem,name:"objectRenderer"};_t.add(Sp);const vs=class Io extends Ab{constructor(t){super(),this.type=$f.WEBGL,t=Object.assign({},lt.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Ae({projectionMatrix:new Dt},!0);const e={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Io.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(e),"useContextAlpha"in t&&(yt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&t.useContextAlpha!=="notMultiplied",t.backgroundAlpha=t.useContextAlpha===!1?1:t.backgroundAlpha),this._plugin.rendererPlugins=Io.__plugins,this.options=t,this.startup.run(this.options)}static test(t){return t!=null&&t.forceCanvas?!1:av()}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return yt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return yt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return yt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return yt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){yt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return yt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){yt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return yt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}};vs.extension={type:ct.Renderer,priority:1},vs.__plugins={},vs.__systems={};let ch=vs;_t.handleByMap(ct.RendererPlugin,ch.__plugins);_t.handleByMap(ct.RendererSystem,ch.__systems);_t.add(ch);class Cp extends Ti{constructor(t,e){const{width:i,height:s}=e||{};super(i,s),this.items=[],this.itemDirtyIds=[];for(let n=0;n<t;n++){const a=new xt;this.items.push(a),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof Ti?this.addResourceAt(t[i],i):this.addResourceAt(Wf(t[i],e),i))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const t=this.items.map(e=>e.resource).filter(e=>e).map(e=>e.load());return this._load=Promise.all(t).then(()=>{const{realWidth:e,realHeight:i}=this.items[0];return this.resize(e,i),this.update(),Promise.resolve(this)}),this._load}}class Ib extends Cp{constructor(t,e){const{width:i,height:s}=e||{};let n,a;Array.isArray(t)?(n=t,a=t.length):a=t,super(a,{width:i,height:s}),n&&this.initFromArray(n,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=Fr.TEXTURE_2D_ARRAY}upload(t,e,i){const{length:s,itemDirtyIds:n,items:a}=this,{gl:o}=t;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,s,0,e.format,i.type,null);for(let h=0;h<s;h++){const l=a[h];n[h]<l.dirtyId&&(n[h]=l.dirtyId,l.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,h,l.resource.width,l.resource.height,1,e.format,i.type,l.resource.source))}return!0}}class Pb extends Me{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const Ep=class ui extends Cp{constructor(t,e){const{width:i,height:s,autoLoad:n,linkBaseTexture:a}=e||{};if(t&&t.length!==ui.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:i,height:s});for(let o=0;o<ui.SIDES;o++)this.items[o].target=Fr.TEXTURE_CUBE_MAP_POSITIVE_X+o;this.linkBaseTexture=a!==!1,t&&this.initFromArray(t,e),n!==!1&&this.load()}bind(t){super.bind(t),t.target=Fr.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,i){if(i===void 0&&(i=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0)if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("CubeResource does not support copying of renderTexture.");else t.target=Fr.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(t,e,i){const s=this.itemDirtyIds;for(let n=0;n<ui.SIDES;n++){const a=this.items[n];(s[n]<a.dirtyId||i.dirtyId<e.dirtyId)&&(a.valid&&a.resource?(a.resource.upload(t,a,i),s[n]=a.dirtyId):s[n]<-1&&(t.gl.texImage2D(a.target,0,i.internalFormat,e.realWidth,e.realHeight,0,e.format,i.type,null),s[n]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===ui.SIDES}};Ep.SIDES=6;let Rb=Ep;class Ir extends Me{constructor(t,e){e=e||{};let i,s,n;typeof t=="string"?(i=Ir.EMPTY,s=t,n=!0):(i=t,s=null,n=!1),super(i),this.url=s,this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.ownsImageBitmap=e.ownsImageBitmap??n,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const i=await lt.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const s=await i.blob();if(this.destroyed)return;const n=await createImageBitmap(s,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===fr.UNPACK?"premultiply":"none"});if(this.destroyed){n.close();return}this.source=n,this.update(),t(this)}catch(i){if(this.destroyed)return;e(i),this.onError.emit(i)}}),this._load)}upload(t,e,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,i)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return Ir._EMPTY=Ir._EMPTY??lt.ADAPTER.createCanvas(0,0),Ir._EMPTY}}const Po=class bs extends Me{constructor(t,e){e=e||{},super(lt.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(t=>{if(this._resolve=()=>{this.update(),t(this)},bs.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const t=new Image;Me.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;const e=t.width,i=t.height;if(!e||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let s=e*this.scale,n=i*this.scale;(this._overrideWidth||this._overrideHeight)&&(s=this._overrideWidth||this._overrideHeight/i*e,n=this._overrideHeight||this._overrideWidth/e*i),s=Math.round(s),n=Math.round(n);const a=this.source;a.width=s,a.height=n,a._pixiId=`canvas_${Ai()}`,a.getContext("2d").drawImage(t,0,0,e,i,0,0,s,n),this._resolve(),this._resolve=null}}static getSize(t){const e=bs.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,e){return e==="svg"||typeof t=="string"&&t.startsWith("data:image/svg+xml")||typeof t=="string"&&bs.SVG_XML.test(t)}};Po.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Po.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let Mb=Po;class Fb extends Me{constructor(t){super(t)}static test(t){return!!globalThis.VideoFrame&&t instanceof globalThis.VideoFrame}}const Ro=class Mo extends Me{constructor(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){const i=document.createElement("video");e.autoLoad!==!1&&i.setAttribute("preload","auto"),e.playsinline!==!1&&(i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline","")),e.muted===!0&&(i.setAttribute("muted",""),i.muted=!0),e.loop===!0&&i.setAttribute("loop",""),e.autoPlay!==!1&&i.setAttribute("autoplay",""),typeof t=="string"&&(t=[t]);const s=t[0].src||t[0];Me.crossOrigin(i,s,e.crossorigin);for(let n=0;n<t.length;++n){const a=document.createElement("source");let{src:o,mime:h}=t[n];if(o=o||t[n],o.startsWith("data:"))h=o.slice(5,o.indexOf(";"));else if(!o.startsWith("blob:")){const l=o.split("?").shift().toLowerCase(),c=l.slice(l.lastIndexOf(".")+1);h=h||Mo.MIME_TYPES[c]||`video/${c}`}a.src=o,h&&(a.type=h),i.appendChild(a)}t=i}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}update(t=0){if(!this.destroyed){if(this._updateFPS){const e=Ie.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((e,i)=>{this.valid?e(this):(this._resolve=e,this._reject=i,t.load())}),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.source;return!t.paused&&!t.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);const e=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!e&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._configureAutoUpdate();const t=this.source;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(Ie.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Ie.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Ie.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||Mo.TYPES.includes(e)}};Ro.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Ro.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let kb=Ro;xo.push(Ir,ip,Pb,kb,Fb,Mb,jf,Rb,Ib);class Fo{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?Et.EMPTY:(t=t||new Et(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:i,b:s,c:n,d:a,tx:o,ty:h}=t,l=i*e.x+n*e.y+o,c=s*e.x+a*e.y+h;this.minX=Math.min(this.minX,l),this.maxX=Math.max(this.maxX,l),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)}addQuad(t){let e=this.minX,i=this.minY,s=this.maxX,n=this.maxY,a=t[0],o=t[1];e=a<e?a:e,i=o<i?o:i,s=a>s?a:s,n=o>n?o:n,a=t[2],o=t[3],e=a<e?a:e,i=o<i?o:i,s=a>s?a:s,n=o>n?o:n,a=t[4],o=t[5],e=a<e?a:e,i=o<i?o:i,s=a>s?a:s,n=o>n?o:n,a=t[6],o=t[7],e=a<e?a:e,i=o<i?o:i,s=a>s?a:s,n=o>n?o:n,this.minX=e,this.minY=i,this.maxX=s,this.maxY=n}addFrame(t,e,i,s,n){this.addFrameMatrix(t.worldTransform,e,i,s,n)}addFrameMatrix(t,e,i,s,n){const a=t.a,o=t.b,h=t.c,l=t.d,c=t.tx,u=t.ty;let f=this.minX,d=this.minY,g=this.maxX,y=this.maxY,p=a*e+h*i+c,m=o*e+l*i+u;f=p<f?p:f,d=m<d?m:d,g=p>g?p:g,y=m>y?m:y,p=a*s+h*i+c,m=o*s+l*i+u,f=p<f?p:f,d=m<d?m:d,g=p>g?p:g,y=m>y?m:y,p=a*e+h*n+c,m=o*e+l*n+u,f=p<f?p:f,d=m<d?m:d,g=p>g?p:g,y=m>y?m:y,p=a*s+h*n+c,m=o*s+l*n+u,f=p<f?p:f,d=m<d?m:d,g=p>g?p:g,y=m>y?m:y,this.minX=f,this.minY=d,this.maxX=g,this.maxY=y}addVertexData(t,e,i){let s=this.minX,n=this.minY,a=this.maxX,o=this.maxY;for(let h=e;h<i;h+=2){const l=t[h],c=t[h+1];s=l<s?l:s,n=c<n?c:n,a=l>a?l:a,o=c>o?c:o}this.minX=s,this.minY=n,this.maxX=a,this.maxY=o}addVertices(t,e,i,s){this.addVerticesMatrix(t.worldTransform,e,i,s)}addVerticesMatrix(t,e,i,s,n=0,a=n){const o=t.a,h=t.b,l=t.c,c=t.d,u=t.tx,f=t.ty;let d=this.minX,g=this.minY,y=this.maxX,p=this.maxY;for(let m=i;m<s;m+=2){const _=e[m],v=e[m+1],A=o*_+l*v+u,x=c*v+h*_+f;d=Math.min(d,A-n),y=Math.max(y,A+n),g=Math.min(g,x-a),p=Math.max(p,x+a)}this.minX=d,this.minY=g,this.maxX=y,this.maxY=p}addBounds(t){const e=this.minX,i=this.minY,s=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>s?t.maxX:s,this.maxY=t.maxY>n?t.maxY:n}addBoundsMask(t,e){const i=t.minX>e.minX?t.minX:e.minX,s=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,a=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&s<=a){const o=this.minX,h=this.minY,l=this.maxX,c=this.maxY;this.minX=i<o?i:o,this.minY=s<h?s:h,this.maxX=n>l?n:l,this.maxY=a>c?a:c}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const i=t.minX>e.x?t.minX:e.x,s=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,a=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&s<=a){const o=this.minX,h=this.minY,l=this.maxX,c=this.maxY;this.minX=i<o?i:o,this.minY=s<h?s:h,this.maxX=n>l?n:l,this.maxY=a>c?a:c}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,i,s,n,a){t-=n,e-=a,i+=n,s+=a,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>s?this.maxY:s}}class Gr extends js{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new hh,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Fo,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let i=0;i<e.length;++i){const s=e[i];Object.defineProperty(Gr.prototype,s,Object.getOwnPropertyDescriptor(t,s))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Et),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new Et),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Fo);const e=this.transform,i=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(i==null?void 0:i.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const s=this._bounds,n=this._boundsID;this._bounds=this._localBounds;const a=this.getBounds(!1,t);return this.parent=i,this.transform=e,this._bounds=s,this._bounds.updateID+=this._boundsID-n,a}toGlobal(t,e,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,i,s){return e&&(t=e.toGlobal(t,i,s)),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,e=0,i=1,s=1,n=0,a=0,o=0,h=0,l=0){return this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=s||1,this.rotation=n,this.skew.x=a,this.skew.y=o,this.pivot.x=h,this.pivot.y=l,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Bb),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*Tv}set angle(t){this.transform.rotation=t*Sv}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class Bb extends Gr{constructor(){super(...arguments),this.sortDirty=null}}Gr.prototype.displayObjectUpdateTransform=Gr.prototype.updateTransform;const Lb=new Dt;function Nb(r,t){return r.zIndex===t.zIndex?r._lastSortedIndex-t._lastSortedIndex:r.zIndex-t.zIndex}const Ip=class ko extends Gr{constructor(){super(),this.children=[],this.sortableChildren=ko.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{const e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;const i=this.getChildIndex(t),s=this.getChildIndex(e);this.children[i]=e,this.children[s]=t,this.onChildrenChange(i<s?i:s)}getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);const i=this.getChildIndex(t);ys(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{const e=t[0],i=this.children.indexOf(e);if(i===-1)return null;e.parent=null,e.transform._parentID=-1,ys(this.children,i,1),this._boundsID++,this.onChildrenChange(i),e.emit("removed",this),this.emit("childRemoved",e,this,i)}return t[0]}removeChildAt(t){const e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,ys(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){const i=t,s=e,n=s-i;let a;if(n>0&&n<=s){a=this.children.splice(i,n);for(let o=0;o<a.length;++o)a[o].parent=null,a[o].transform&&(a[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let o=0;o<a.length;++o)a[o].emit("removed",this),this.emit("childRemoved",a[o],this,o);return a}else if(n===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,i=this.children.length;e<i;++e){const s=this.children[e];s._lastSortedIndex=e,!t&&s.zIndex!==0&&(t=!0)}t&&this.children.length>1&&this.children.sort(Nb),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){const i=this.children[t];i.visible&&i.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const e=this.children[t];if(!(!e.visible||!e.renderable))if(e.calculateBounds(),e._mask){const i=e._mask.isMaskData?e._mask.maskObject:e._mask;i?(i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){const i=super.getLocalBounds(t);if(!e)for(let s=0,n=this.children.length;s<n;++s){const a=this.children[s];a.visible&&a.updateTransform()}return i}_calculateBounds(){}_renderWithCulling(t){const e=t.renderTexture.sourceFrame;if(!(e.width>0&&e.height>0))return;let i,s;this.cullArea?(i=this.cullArea,s=this.worldTransform):this._render!==ko.prototype._render&&(i=this.getBounds(!0));const n=t.projection.transform;if(n&&(s?(s=Lb.copyFrom(s),s.prepend(n)):s=n),i&&e.intersects(i,s))this._render(t);else if(this.cullArea)return;for(let a=0,o=this.children.length;a<o;++a){const h=this.children[a],l=h.cullable;h.cullable=l||!this.cullArea,h.render(t),h.cullable=l}}render(t){var e;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(e=this.filters)!=null&&e.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let i=0,s=this.children.length;i<s;++i)this.children[i].render(t)}}renderAdvanced(t){var n,a,o;const e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let h=0;h<e.length;h++)e[h].enabled&&this._enabledFilters.push(e[h])}const s=e&&((n=this._enabledFilters)==null?void 0:n.length)||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==Ut.NONE));if(s&&t.batch.flush(),e&&((a=this._enabledFilters)!=null&&a.length)&&t.filter.push(this,this._enabledFilters),i&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let h=0,l=this.children.length;h<l;++h)this.children[h].render(t)}s&&t.batch.flush(),i&&t.mask.pop(this),e&&((o=this._enabledFilters)!=null&&o.length)&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const e=typeof t=="boolean"?t:t==null?void 0:t.children,i=this.removeChildren(0,this.children.length);if(e)for(let s=0;s<i.length;++s)i[s].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const e=this.getLocalBounds().width;e!==0?this.scale.x=t/e:this.scale.x=1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const e=this.getLocalBounds().height;e!==0?this.scale.y=t/e:this.scale.y=1,this._height=t}};Ip.defaultSortableChildren=!1;let Si=Ip;Si.prototype.containerUpdateTransform=Si.prototype.updateTransform;Object.defineProperties(lt,{SORTABLE_CHILDREN:{get(){return Si.defaultSortableChildren},set(r){yt("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Si.defaultSortableChildren=r}}});const ei=new Ct,Ob=new Uint16Array([0,1,2,0,2,3]);class uh extends Si{constructor(t){super(),this._anchor=new Ge(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Ri(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=et.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||ot.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=Ob,this.pluginName="batch",this.isSprite=!0,this._roundPixels=lt.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=qi(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=qi(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,i=e.a,s=e.b,n=e.c,a=e.d,o=e.tx,h=e.ty,l=this.vertexData,c=t.trim,u=t.orig,f=this._anchor;let d=0,g=0,y=0,p=0;if(c?(g=c.x-f._x*u.width,d=g+c.width,p=c.y-f._y*u.height,y=p+c.height):(g=-f._x*u.width,d=g+u.width,p=-f._y*u.height,y=p+u.height),l[0]=i*g+n*p+o,l[1]=a*p+s*g+h,l[2]=i*d+n*p+o,l[3]=a*p+s*d+h,l[4]=i*d+n*y+o,l[5]=a*y+s*d+h,l[6]=i*g+n*y+o,l[7]=a*y+s*g+h,this._roundPixels){const m=lt.RESOLUTION;for(let _=0;_<l.length;++_)l[_]=Math.round(l[_]*m)/m}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,i=t.orig,s=this._anchor,n=this.transform.worldTransform,a=n.a,o=n.b,h=n.c,l=n.d,c=n.tx,u=n.ty,f=-s._x*i.width,d=f+i.width,g=-s._y*i.height,y=g+i.height;if(e[0]=a*f+h*g+c,e[1]=l*g+o*f+u,e[2]=a*d+h*g+c,e[3]=l*g+o*d+u,e[4]=a*d+h*y+c,e[5]=l*y+o*d+u,e[6]=a*f+h*y+c,e[7]=l*y+o*f+u,this._roundPixels){const p=lt.RESOLUTION;for(let m=0;m<e.length;++m)e[m]=Math.round(e[m]*p)/p}}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new Fo),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Et),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,ei);const e=this._texture.orig.width,i=this._texture.orig.height,s=-e*this.anchor.x;let n=0;return ei.x>=s&&ei.x<s+e&&(n=-i*this.anchor.y,ei.y>=n&&ei.y<n+i)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const e=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!e)}this._texture=null}static from(t,e){const i=t instanceof ot?t:ot.from(t,e);return new uh(i)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=qi(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=qi(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||ot.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}/*!
 * @pixi/particle-emitter - v5.0.8
 * Compiled Mon, 28 Nov 2022 04:01:38 UTC
 *
 * @pixi/particle-emitter is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */class ve{constructor(t,e,i){this.value=t,this.time=e,this.next=null,this.isStepped=!1,i?this.ease=typeof i=="function"?i:Mp(i):this.ease=null}static createList(t){if("list"in t){const i=t.list;let s;const{value:n,time:a}=i[0],o=s=new ve(typeof n=="string"?ss(n):n,a,t.ease);if(i.length>2||i.length===2&&i[1].value!==n)for(let h=1;h<i.length;++h){const{value:l,time:c}=i[h];s.next=new ve(typeof l=="string"?ss(l):l,c),s=s.next}return o.isStepped=!!t.isStepped,o}const e=new ve(typeof t.start=="string"?ss(t.start):t.start,0);return t.end!==t.start&&(e.next=new ve(typeof t.end=="string"?ss(t.end):t.end,1)),e}}let Ci=ot.from;const xe=Math.PI/180;function Re(r,t){if(!r)return;const e=Math.sin(r),i=Math.cos(r),s=t.x*i-t.y*e,n=t.x*e+t.y*i;t.x=s,t.y=n}function Ks(r,t,e){return r<<16|t<<8|e}function Pp(r){return Math.sqrt(r.x*r.x+r.y*r.y)}function Ub(r){const t=1/Pp(r);r.x*=t,r.y*=t}function Rp(r,t){r.x*=t,r.y*=t}function ss(r,t){t||(t={}),r.charAt(0)==="#"?r=r.substr(1):r.indexOf("0x")===0&&(r=r.substr(2));let e;return r.length===8&&(e=r.substr(0,2),r=r.substr(2)),t.r=parseInt(r.substr(0,2),16),t.g=parseInt(r.substr(2,2),16),t.b=parseInt(r.substr(4,2),16),e&&(t.a=parseInt(e,16)),t}function Mp(r){const t=r.length,e=1/t;return function(i){const s=t*i|0,n=(i-s*e)*t,a=r[s]||r[t-1];return a.s+n*(2*(1-n)*(a.cp-a.s)+n*(a.e-a.s))}}function Gb(r){return r?(r=r.toUpperCase().replace(/ /g,"_"),et[r]||et.NORMAL):et.NORMAL}class Ua extends uh{constructor(t){super(),this.prevChild=this.nextChild=null,this.emitter=t,this.config={},this.anchor.x=this.anchor.y=.5,this.maxLife=0,this.age=0,this.agePercent=0,this.oneOverLife=0,this.next=null,this.prev=null,this.init=this.init,this.kill=this.kill}init(t){this.maxLife=t,this.age=this.agePercent=0,this.rotation=0,this.position.x=this.position.y=0,this.scale.x=this.scale.y=1,this.tint=16777215,this.alpha=1,this.oneOverLife=1/this.maxLife,this.visible=!0}kill(){this.emitter.recycle(this)}destroy(){this.parent&&this.parent.removeChild(this),this.emitter=this.next=this.prev=null,super.destroy()}}var At;(function(r){r[r.Spawn=0]="Spawn",r[r.Normal=2]="Normal",r[r.Late=5]="Late"})(At||(At={}));const Ga=Ie.shared,Ye=Symbol("Position particle per emitter position");class vt{constructor(t,e){this.initBehaviors=[],this.updateBehaviors=[],this.recycleBehaviors=[],this.minLifetime=0,this.maxLifetime=0,this.customEase=null,this._frequency=1,this.spawnChance=1,this.maxParticles=1e3,this.emitterLifetime=-1,this.spawnPos=new Ct,this.particlesPerWave=1,this.rotation=0,this.ownerPos=new Ct,this._prevEmitterPos=new Ct,this._prevPosIsValid=!1,this._posChanged=!1,this._parent=null,this.addAtBack=!1,this.particleCount=0,this._emit=!1,this._spawnTimer=0,this._emitterLife=-1,this._activeParticlesFirst=null,this._activeParticlesLast=null,this._poolFirst=null,this._origConfig=null,this._autoUpdate=!1,this._destroyWhenComplete=!1,this._completeCallback=null,this.parent=t,e&&this.init(e),this.recycle=this.recycle,this.update=this.update,this.rotate=this.rotate,this.updateSpawnPos=this.updateSpawnPos,this.updateOwnerPos=this.updateOwnerPos}static registerBehavior(t){vt.knownBehaviors[t.type]=t}get frequency(){return this._frequency}set frequency(t){typeof t=="number"&&t>0?this._frequency=t:this._frequency=1}get parent(){return this._parent}set parent(t){this.cleanup(),this._parent=t}init(t){if(!t)return;this.cleanup(),this._origConfig=t,this.minLifetime=t.lifetime.min,this.maxLifetime=t.lifetime.max,t.ease?this.customEase=typeof t.ease=="function"?t.ease:Mp(t.ease):this.customEase=null,this.particlesPerWave=1,t.particlesPerWave&&t.particlesPerWave>1&&(this.particlesPerWave=t.particlesPerWave),this.frequency=t.frequency,this.spawnChance=typeof t.spawnChance=="number"&&t.spawnChance>0?t.spawnChance:1,this.emitterLifetime=t.emitterLifetime||-1,this.maxParticles=t.maxParticles>0?t.maxParticles:1e3,this.addAtBack=!!t.addAtBack,this.rotation=0,this.ownerPos.set(0),t.pos?this.spawnPos.copyFrom(t.pos):this.spawnPos.set(0),this._prevEmitterPos.copyFrom(this.spawnPos),this._prevPosIsValid=!1,this._spawnTimer=0,this.emit=t.emit===void 0?!0:!!t.emit,this.autoUpdate=!!t.autoUpdate;const e=t.behaviors.map(i=>{const s=vt.knownBehaviors[i.type];return s?new s(i.config):(console.error(`Unknown behavior: ${i.type}`),null)}).filter(i=>!!i);e.push(Ye),e.sort((i,s)=>i===Ye?s.order===At.Spawn?1:-1:s===Ye?i.order===At.Spawn?-1:1:i.order-s.order),this.initBehaviors=e.slice(),this.updateBehaviors=e.filter(i=>i!==Ye&&i.updateParticle),this.recycleBehaviors=e.filter(i=>i!==Ye&&i.recycleParticle)}getBehavior(t){return vt.knownBehaviors[t]&&this.initBehaviors.find(e=>e instanceof vt.knownBehaviors[t])||null}fillPool(t){for(;t>0;--t){const e=new Ua(this);e.next=this._poolFirst,this._poolFirst=e}}recycle(t,e=!1){for(let i=0;i<this.recycleBehaviors.length;++i)this.recycleBehaviors[i].recycleParticle(t,!e);t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next),t===this._activeParticlesLast&&(this._activeParticlesLast=t.prev),t===this._activeParticlesFirst&&(this._activeParticlesFirst=t.next),t.prev=null,t.next=this._poolFirst,this._poolFirst=t,t.parent&&t.parent.removeChild(t),--this.particleCount}rotate(t){if(this.rotation===t)return;const e=t-this.rotation;this.rotation=t,Re(e,this.spawnPos),this._posChanged=!0}updateSpawnPos(t,e){this._posChanged=!0,this.spawnPos.x=t,this.spawnPos.y=e}updateOwnerPos(t,e){this._posChanged=!0,this.ownerPos.x=t,this.ownerPos.y=e}resetPositionTracking(){this._prevPosIsValid=!1}get emit(){return this._emit}set emit(t){this._emit=!!t,this._emitterLife=this.emitterLifetime}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){this._autoUpdate&&!t?Ga.remove(this.update,this):!this._autoUpdate&&t&&Ga.add(this.update,this),this._autoUpdate=!!t}playOnceAndDestroy(t){this.autoUpdate=!0,this.emit=!0,this._destroyWhenComplete=!0,this._completeCallback=t}playOnce(t){this.emit=!0,this._completeCallback=t}update(t){if(this._autoUpdate&&(t=Ga.elapsedMS*.001),!this._parent)return;for(let a=this._activeParticlesFirst,o;a;a=o)if(o=a.next,a.age+=t,a.age>a.maxLife||a.age<0)this.recycle(a);else{let h=a.age*a.oneOverLife;this.customEase&&(this.customEase.length===4?h=this.customEase(h,0,1,1):h=this.customEase(h)),a.agePercent=h;for(let l=0;l<this.updateBehaviors.length;++l)if(this.updateBehaviors[l].updateParticle(a,t)){this.recycle(a);break}}let e,i;this._prevPosIsValid&&(e=this._prevEmitterPos.x,i=this._prevEmitterPos.y);const s=this.ownerPos.x+this.spawnPos.x,n=this.ownerPos.y+this.spawnPos.y;if(this._emit)for(this._spawnTimer-=t<0?0:t;this._spawnTimer<=0;){if(this._emitterLife>=0&&(this._emitterLife-=this._frequency,this._emitterLife<=0)){this._spawnTimer=0,this._emitterLife=0,this.emit=!1;break}if(this.particleCount>=this.maxParticles){this._spawnTimer+=this._frequency;continue}let a,o;if(this._prevPosIsValid&&this._posChanged){const c=1+this._spawnTimer/t;a=(s-e)*c+e,o=(n-i)*c+i}else a=s,o=n;let h=null,l=null;for(let c=Math.min(this.particlesPerWave,this.maxParticles-this.particleCount),u=0;u<c;++u){if(this.spawnChance<1&&Math.random()>=this.spawnChance)continue;let f;if(this.minLifetime===this.maxLifetime?f=this.minLifetime:f=Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime,-this._spawnTimer>=f)continue;let d;this._poolFirst?(d=this._poolFirst,this._poolFirst=this._poolFirst.next,d.next=null):d=new Ua(this),d.init(f),this.addAtBack?this._parent.addChildAt(d,0):this._parent.addChild(d),h?(l.next=d,d.prev=l,l=d):l=h=d,++this.particleCount}if(h){this._activeParticlesLast?(this._activeParticlesLast.next=h,h.prev=this._activeParticlesLast,this._activeParticlesLast=l):(this._activeParticlesFirst=h,this._activeParticlesLast=l);for(let c=0;c<this.initBehaviors.length;++c){const u=this.initBehaviors[c];if(u===Ye)for(let f=h,d;f;f=d){d=f.next,this.rotation!==0&&(Re(this.rotation,f.position),f.rotation+=this.rotation),f.position.x+=a,f.position.y+=o,f.age+=-this._spawnTimer;let g=f.age*f.oneOverLife;this.customEase&&(this.customEase.length===4?g=this.customEase(g,0,1,1):g=this.customEase(g)),f.agePercent=g}else u.initParticles(h)}for(let c=h,u;c;c=u){u=c.next;for(let f=0;f<this.updateBehaviors.length;++f)if(this.updateBehaviors[f].updateParticle(c,-this._spawnTimer)){this.recycle(c);break}}}this._spawnTimer+=this._frequency}if(this._posChanged&&(this._prevEmitterPos.x=s,this._prevEmitterPos.y=n,this._prevPosIsValid=!0,this._posChanged=!1),!this._emit&&!this._activeParticlesFirst){if(this._completeCallback){const a=this._completeCallback;this._completeCallback=null,a()}this._destroyWhenComplete&&this.destroy()}}emitNow(){const t=this.ownerPos.x+this.spawnPos.x,e=this.ownerPos.y+this.spawnPos.y;let i=null,s=null;for(let n=Math.min(this.particlesPerWave,this.maxParticles-this.particleCount),a=0;a<n;++a){if(this.spawnChance<1&&Math.random()>=this.spawnChance)continue;let o;this._poolFirst?(o=this._poolFirst,this._poolFirst=this._poolFirst.next,o.next=null):o=new Ua(this);let h;this.minLifetime===this.maxLifetime?h=this.minLifetime:h=Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime,o.init(h),this.addAtBack?this._parent.addChildAt(o,0):this._parent.addChild(o),i?(s.next=o,o.prev=s,s=o):s=i=o,++this.particleCount}if(i){this._activeParticlesLast?(this._activeParticlesLast.next=i,i.prev=this._activeParticlesLast,this._activeParticlesLast=s):(this._activeParticlesFirst=i,this._activeParticlesLast=s);for(let n=0;n<this.initBehaviors.length;++n){const a=this.initBehaviors[n];if(a===Ye)for(let o=i,h;o;o=h)h=o.next,this.rotation!==0&&(Re(this.rotation,o.position),o.rotation+=this.rotation),o.position.x+=t,o.position.y+=e;else a.initParticles(i)}}}cleanup(){let t,e;for(t=this._activeParticlesFirst;t;t=e)e=t.next,this.recycle(t,!0);this._activeParticlesFirst=this._activeParticlesLast=null,this.particleCount=0}get destroyed(){return!(this._parent&&this.initBehaviors.length)}destroy(){this.autoUpdate=!1,this.cleanup();let t;for(let e=this._poolFirst;e;e=t)t=e.next,e.destroy();this._poolFirst=this._parent=this.spawnPos=this.ownerPos=this.customEase=this._completeCallback=null,this.initBehaviors.length=this.updateBehaviors.length=this.recycleBehaviors.length=0}}vt.knownBehaviors={};class dh{constructor(t){this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h}getRandPos(t){t.x=Math.random()*this.w+this.x,t.y=Math.random()*this.h+this.y}}dh.type="rect";dh.editorConfig=null;class Zs{constructor(t){this.x=t.x||0,this.y=t.y||0,this.radius=t.radius,this.innerRadius=t.innerRadius||0,this.rotation=!!t.affectRotation}getRandPos(t){this.innerRadius!==this.radius?t.x=Math.random()*(this.radius-this.innerRadius)+this.innerRadius:t.x=this.radius,t.y=0;const e=Math.random()*Math.PI*2;this.rotation&&(t.rotation+=e),Re(e,t.position),t.position.x+=this.x,t.position.y+=this.y}}Zs.type="torus";Zs.editorConfig=null;class fh{constructor(t){this.segments=[],this.countingLengths=[],this.totalLength=0,this.init(t)}init(t){if(!t||!t.length)this.segments.push({p1:{x:0,y:0},p2:{x:0,y:0},l:0});else if(Array.isArray(t[0]))for(let e=0;e<t.length;++e){const i=t[e];let s=i[0];for(let n=1;n<i.length;++n){const a=i[n];this.segments.push({p1:s,p2:a,l:0}),s=a}}else{let e=t[0];for(let i=1;i<t.length;++i){const s=t[i];this.segments.push({p1:e,p2:s,l:0}),e=s}}for(let e=0;e<this.segments.length;++e){const{p1:i,p2:s}=this.segments[e],n=Math.sqrt((s.x-i.x)*(s.x-i.x)+(s.y-i.y)*(s.y-i.y));this.segments[e].l=n,this.totalLength+=n,this.countingLengths.push(this.totalLength)}}getRandPos(t){const e=Math.random()*this.totalLength;let i,s;if(this.segments.length===1)i=this.segments[0],s=e;else for(let o=0;o<this.countingLengths.length;++o)if(e<this.countingLengths[o]){i=this.segments[o],s=o===0?e:e-this.countingLengths[o-1];break}s/=i.l||1;const{p1:n,p2:a}=i;t.x=n.x+s*(a.x-n.x),t.y=n.y+s*(a.y-n.y)}}fh.type="polygonalChain";fh.editorConfig=null;class ph{constructor(t){var e;this.order=At.Late,this.minStart=t.minStart,this.maxStart=t.maxStart,this.accel=t.accel,this.rotate=!!t.rotate,this.maxSpeed=(e=t.maxSpeed)!==null&&e!==void 0?e:0}initParticles(t){let e=t;for(;e;){const i=Math.random()*(this.maxStart-this.minStart)+this.minStart;e.config.velocity?e.config.velocity.set(i,0):e.config.velocity=new Ct(i,0),Re(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const i=t.config.velocity,s=i.x,n=i.y;if(i.x+=this.accel.x*e,i.y+=this.accel.y*e,this.maxSpeed){const a=Pp(i);a>this.maxSpeed&&Rp(i,this.maxSpeed/a)}t.x+=(s+i.x)/2*e,t.y+=(n+i.y)/2*e,this.rotate&&(t.rotation=Math.atan2(i.y,i.x))}}ph.type="moveAcceleration";ph.editorConfig=null;function Db(r){return this.ease&&(r=this.ease(r)),(this.first.next.value-this.first.value)*r+this.first.value}function $b(r){this.ease&&(r=this.ease(r));const t=this.first.value,e=this.first.next.value,i=(e.r-t.r)*r+t.r,s=(e.g-t.g)*r+t.g,n=(e.b-t.b)*r+t.b;return Ks(i,s,n)}function Hb(r){this.ease&&(r=this.ease(r));let t=this.first,e=t.next;for(;r>e.time;)t=e,e=e.next;return r=(r-t.time)/(e.time-t.time),(e.value-t.value)*r+t.value}function Vb(r){this.ease&&(r=this.ease(r));let t=this.first,e=t.next;for(;r>e.time;)t=e,e=e.next;r=(r-t.time)/(e.time-t.time);const i=t.value,s=e.value,n=(s.r-i.r)*r+i.r,a=(s.g-i.g)*r+i.g,o=(s.b-i.b)*r+i.b;return Ks(n,a,o)}function zb(r){this.ease&&(r=this.ease(r));let t=this.first;for(;t.next&&r>t.next.time;)t=t.next;return t.value}function Xb(r){this.ease&&(r=this.ease(r));let t=this.first;for(;t.next&&r>t.next.time;)t=t.next;const e=t.value;return Ks(e.r,e.g,e.b)}class Mi{constructor(t=!1){this.first=null,this.isColor=!!t,this.interpolate=null,this.ease=null}reset(t){this.first=t,t.next&&t.next.time>=1?this.interpolate=this.isColor?$b:Db:t.isStepped?this.interpolate=this.isColor?Xb:zb:this.interpolate=this.isColor?Vb:Hb,this.ease=this.first.ease}}class mh{constructor(t){this.order=At.Normal,this.list=new Mi(!1),this.list.reset(ve.createList(t.alpha))}initParticles(t){let e=t;for(;e;)e.alpha=this.list.first.value,e=e.next}updateParticle(t){t.alpha=this.list.interpolate(t.agePercent)}}mh.type="alpha";mh.editorConfig=null;class gh{constructor(t){this.order=At.Normal,this.value=t.alpha}initParticles(t){let e=t;for(;e;)e.alpha=this.value,e=e.next}}gh.type="alphaStatic";gh.editorConfig=null;function Fp(r){const t=[];for(let e=0;e<r.length;++e){let i=r[e];if(typeof i=="string")t.push(Ci(i));else if(i instanceof ot)t.push(i);else{let s=i.count||1;for(typeof i.texture=="string"?i=Ci(i.texture):i=i.texture;s>0;--s)t.push(i)}}return t}class yh{constructor(t){this.order=At.Normal,this.anims=[];for(let e=0;e<t.anims.length;++e){const i=t.anims[e],s=Fp(i.textures),n=i.framerate<0?-1:i.framerate>0?i.framerate:60,a={textures:s,duration:n>0?s.length/n:0,framerate:n,loop:n>0?!!i.loop:!1};this.anims.push(a)}}initParticles(t){let e=t;for(;e;){const i=Math.floor(Math.random()*this.anims.length),s=e.config.anim=this.anims[i];e.texture=s.textures[0],e.config.animElapsed=0,s.framerate===-1?(e.config.animDuration=e.maxLife,e.config.animFramerate=s.textures.length/e.maxLife):(e.config.animDuration=s.duration,e.config.animFramerate=s.framerate),e=e.next}}updateParticle(t,e){const i=t.config,s=i.anim;i.animElapsed+=e,i.animElapsed>=i.animDuration&&(i.anim.loop?i.animElapsed=i.animElapsed%i.animDuration:i.animElapsed=i.animDuration-1e-6);const n=i.animElapsed*i.animFramerate+1e-7|0;t.texture=s.textures[n]||s.textures[s.textures.length-1]||ot.EMPTY}}yh.type="animatedRandom";yh.editorConfig=null;class _h{constructor(t){this.order=At.Normal;const e=t.anim,i=Fp(e.textures),s=e.framerate<0?-1:e.framerate>0?e.framerate:60;this.anim={textures:i,duration:s>0?i.length/s:0,framerate:s,loop:s>0?!!e.loop:!1}}initParticles(t){let e=t;const i=this.anim;for(;e;)e.texture=i.textures[0],e.config.animElapsed=0,i.framerate===-1?(e.config.animDuration=e.maxLife,e.config.animFramerate=i.textures.length/e.maxLife):(e.config.animDuration=i.duration,e.config.animFramerate=i.framerate),e=e.next}updateParticle(t,e){const i=this.anim,s=t.config;s.animElapsed+=e,s.animElapsed>=s.animDuration&&(i.loop?s.animElapsed=s.animElapsed%s.animDuration:s.animElapsed=s.animDuration-1e-6);const n=s.animElapsed*s.animFramerate+1e-7|0;t.texture=i.textures[n]||i.textures[i.textures.length-1]||ot.EMPTY}}_h.type="animatedSingle";_h.editorConfig=null;class xh{constructor(t){this.order=At.Normal,this.value=t.blendMode}initParticles(t){let e=t;for(;e;)e.blendMode=Gb(this.value),e=e.next}}xh.type="blendMode";xh.editorConfig=null;class vh{constructor(t){this.order=At.Spawn,this.spacing=t.spacing*xe,this.start=t.start*xe,this.distance=t.distance}initParticles(t){let e=0,i=t;for(;i;){let s;this.spacing?s=this.start+this.spacing*e:s=Math.random()*Math.PI*2,i.rotation=s,this.distance&&(i.position.x=this.distance,Re(s,i.position)),i=i.next,++e}}}vh.type="spawnBurst";vh.editorConfig=null;class bh{constructor(t){this.order=At.Normal,this.list=new Mi(!0),this.list.reset(ve.createList(t.color))}initParticles(t){let e=t;const i=this.list.first.value,s=Ks(i.r,i.g,i.b);for(;e;)e.tint=s,e=e.next}updateParticle(t){t.tint=this.list.interpolate(t.agePercent)}}bh.type="color";bh.editorConfig=null;class wh{constructor(t){this.order=At.Normal;let e=t.color;e.charAt(0)==="#"?e=e.substr(1):e.indexOf("0x")===0&&(e=e.substr(2)),this.value=parseInt(e,16)}initParticles(t){let e=t;for(;e;)e.tint=this.value,e=e.next}}wh.type="colorStatic";wh.editorConfig=null;class Ah{constructor(t){this.order=At.Normal,this.index=0,this.textures=t.textures.map(e=>typeof e=="string"?Ci(e):e)}initParticles(t){let e=t;for(;e;)e.texture=this.textures[this.index],++this.index>=this.textures.length&&(this.index=0),e=e.next}}Ah.type="textureOrdered";Ah.editorConfig=null;const br=new Ct,kp=["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2","abs","acos","acosh","asin","asinh","atan","atanh","atan2","cbrt","ceil","cos","cosh","exp","expm1","floor","fround","hypot","log","log1p","log10","log2","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh"],Wb=new RegExp(["[01234567890\\.\\*\\-\\+\\/\\(\\)x ,]"].concat(kp).join("|"),"g");function jb(r){const t=r.match(Wb);for(let e=t.length-1;e>=0;--e)kp.indexOf(t[e])>=0&&(t[e]=`Math.${t[e]}`);return r=t.join(""),new Function("x",`return ${r};`)}class Th{constructor(t){var e;if(this.order=At.Late,t.path)if(typeof t.path=="function")this.path=t.path;else try{this.path=jb(t.path)}catch{this.path=null}else this.path=i=>i;this.list=new Mi(!1),this.list.reset(ve.createList(t.speed)),this.minMult=(e=t.minMult)!==null&&e!==void 0?e:1}initParticles(t){let e=t;for(;e;){e.config.initRotation=e.rotation,e.config.initPosition?e.config.initPosition.copyFrom(e.position):e.config.initPosition=new Ct(e.x,e.y),e.config.movement=0;const i=Math.random()*(1-this.minMult)+this.minMult;e.config.speedMult=i,e=e.next}}updateParticle(t,e){const i=this.list.interpolate(t.agePercent)*t.config.speedMult;t.config.movement+=i*e,br.x=t.config.movement,br.y=this.path(br.x),Re(t.config.initRotation,br),t.position.x=t.config.initPosition.x+br.x,t.position.y=t.config.initPosition.y+br.y}}Th.type="movePath";Th.editorConfig=null;class Sh{constructor(){this.order=At.Spawn}initParticles(t){}}Sh.type="spawnPoint";Sh.editorConfig=null;class Ch{constructor(t){this.order=At.Normal,this.textures=t.textures.map(e=>typeof e=="string"?Ci(e):e)}initParticles(t){let e=t;for(;e;){const i=Math.floor(Math.random()*this.textures.length);e.texture=this.textures[i],e=e.next}}}Ch.type="textureRandom";Ch.editorConfig=null;class Eh{constructor(t){this.order=At.Normal,this.minStart=t.minStart*xe,this.maxStart=t.maxStart*xe,this.minSpeed=t.minSpeed*xe,this.maxSpeed=t.maxSpeed*xe,this.accel=t.accel*xe}initParticles(t){let e=t;for(;e;)this.minStart===this.maxStart?e.rotation+=this.maxStart:e.rotation+=Math.random()*(this.maxStart-this.minStart)+this.minStart,e.config.rotSpeed=Math.random()*(this.maxSpeed-this.minSpeed)+this.minSpeed,e=e.next}updateParticle(t,e){if(this.accel){const i=t.config.rotSpeed;t.config.rotSpeed+=this.accel*e,t.rotation+=(t.config.rotSpeed+i)/2*e}else t.rotation+=t.config.rotSpeed*e}}Eh.type="rotation";Eh.editorConfig=null;class Ih{constructor(t){this.order=At.Normal,this.min=t.min*xe,this.max=t.max*xe}initParticles(t){let e=t;for(;e;)this.min===this.max?e.rotation+=this.max:e.rotation+=Math.random()*(this.max-this.min)+this.min,e=e.next}}Ih.type="rotationStatic";Ih.editorConfig=null;class Ph{constructor(t){this.order=At.Late+1,this.rotation=(t.rotation||0)*xe}initParticles(t){let e=t;for(;e;)e.rotation=this.rotation,e=e.next}}Ph.type="noRotation";Ph.editorConfig=null;class Rh{constructor(t){var e;this.order=At.Normal,this.list=new Mi(!1),this.list.reset(ve.createList(t.scale)),this.minMult=(e=t.minMult)!==null&&e!==void 0?e:1}initParticles(t){let e=t;for(;e;){const i=Math.random()*(1-this.minMult)+this.minMult;e.config.scaleMult=i,e.scale.x=e.scale.y=this.list.first.value*i,e=e.next}}updateParticle(t){t.scale.x=t.scale.y=this.list.interpolate(t.agePercent)*t.config.scaleMult}}Rh.type="scale";Rh.editorConfig=null;class Mh{constructor(t){this.order=At.Normal,this.min=t.min,this.max=t.max}initParticles(t){let e=t;for(;e;){const i=Math.random()*(this.max-this.min)+this.min;e.scale.x=e.scale.y=i,e=e.next}}}Mh.type="scaleStatic";Mh.editorConfig=null;class pe{constructor(t){this.order=At.Spawn;const e=pe.shapes[t.type];if(!e)throw new Error(`No shape found with type '${t.type}'`);this.shape=new e(t.data)}static registerShape(t,e){pe.shapes[e||t.type]=t}initParticles(t){let e=t;for(;e;)this.shape.getRandPos(e),e=e.next}}pe.type="spawnShape";pe.editorConfig=null;pe.shapes={};pe.registerShape(fh);pe.registerShape(dh);pe.registerShape(Zs);pe.registerShape(Zs,"circle");class Fh{constructor(t){this.order=At.Normal,this.texture=typeof t.texture=="string"?Ci(t.texture):t.texture}initParticles(t){let e=t;for(;e;)e.texture=this.texture,e=e.next}}Fh.type="textureSingle";Fh.editorConfig=null;class kh{constructor(t){var e;this.order=At.Late,this.list=new Mi(!1),this.list.reset(ve.createList(t.speed)),this.minMult=(e=t.minMult)!==null&&e!==void 0?e:1}initParticles(t){let e=t;for(;e;){const i=Math.random()*(1-this.minMult)+this.minMult;e.config.speedMult=i,e.config.velocity?e.config.velocity.set(this.list.first.value*i,0):e.config.velocity=new Ct(this.list.first.value*i,0),Re(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const i=this.list.interpolate(t.agePercent)*t.config.speedMult,s=t.config.velocity;Ub(s),Rp(s,i),t.x+=s.x*e,t.y+=s.y*e}}kh.type="moveSpeed";kh.editorConfig=null;class Bh{constructor(t){this.order=At.Late,this.min=t.min,this.max=t.max}initParticles(t){let e=t;for(;e;){const i=Math.random()*(this.max-this.min)+this.min;e.config.velocity?e.config.velocity.set(i,0):e.config.velocity=new Ct(i,0),Re(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const i=t.config.velocity;t.x+=i.x*e,t.y+=i.y*e}}Bh.type="moveSpeedStatic";Bh.editorConfig=null;vt.registerBehavior(ph);vt.registerBehavior(mh);vt.registerBehavior(gh);vt.registerBehavior(yh);vt.registerBehavior(_h);vt.registerBehavior(xh);vt.registerBehavior(vh);vt.registerBehavior(bh);vt.registerBehavior(wh);vt.registerBehavior(Ah);vt.registerBehavior(Th);vt.registerBehavior(Sh);vt.registerBehavior(Ch);vt.registerBehavior(Eh);vt.registerBehavior(Ih);vt.registerBehavior(Ph);vt.registerBehavior(Rh);vt.registerBehavior(Mh);vt.registerBehavior(pe);vt.registerBehavior(Fh);vt.registerBehavior(kh);vt.registerBehavior(Bh);var Yb=$t('<div class="z-[-1] bg-base-200 opacity-50 pointer-events-none"><div class="blur-3xl"></div></div>');function qb(r,t){Fe(t,!1);let e=ue();Ei(()=>{Q(e)&&(async()=>{const n=new sf;await n.init({backgroundAlpha:0,resizeTo:window,resolution:window.devicePixelRatio||1}),Q(e).appendChild(n.canvas);const a=await ai.load("trail.png"),o=[],h=[],l=20,c=100,u=[];for(let m=0;m<l;m++)o.push(0),h.push(0);for(let m=0;m<c;m++)u.push(new jt(0,0));const f=new I1({texture:a,points:u});f.blendMode="add",n.stage.addChild(f);let d=null;n.stage.eventMode="static",n.stage.hitArea=n.screen,n.stage.on("mousemove",m=>{d={x:m.global.x,y:m.global.y}}),n.ticker.add(()=>{if(d){o.pop(),o.unshift(d.x),h.pop(),h.unshift(d.y);for(let m=0;m<c;m++){const _=u[m],v=p(o,m/c*l),A=p(h,m/c*l);_.x=v,_.y=A}}});function g(m,_){return m<0&&(m=0),m>_.length-1&&(m=_.length-1),_[m]}function y(m,_,v){return _*(g(m+1,v)-g(m-1,v))/2}function p(m,_,v=1){const A=Math.floor(_),x=[y(A,v,m),y(A+1,v,m)],S=[g(A,m),g(A+1,m)];_-=A;const b=_*_,B=_*b;return(2*B-3*b+1)*S[0]+(B-2*b+_)*x[0]+(-2*B+3*b)*S[1]+(B-b)*x[1]}})()}),No();var i=Yb(),s=pt(i);$e(s,n=>Zt(e,n),()=>Q(e)),ut(i),St(r,i),ke()}var Kb=$t('<p> <span class="flashing svelte-xboitm">█</span></p>');function Zb(r,t){Fe(t,!0);let e=hs(t,"speed",3,50),i=Bu(""),s=0,n=-1;const a=()=>{s<t.text.length?(Zt(i,Q(i)+t.text[s]),s++,n=setTimeout(a,e())):n=-1};function o(){Zt(i,""),s=0,n!=-1&&clearTimeout(n),a()}Ei(()=>{o()});var h=Kb(),l=pt(h,!0);return os(),ut(h),de(()=>{yi(h,`${t.className??""} svelte-xboitm`),gi(l,Q(i))}),St(r,h),ke({reset:o})}function Qb(){let r=`
%c                     =*********+                  %cleah%c@%cleahdevs.xyz
%c                 .*****************:              -----------------
%c              .**********************=            
%c            ***********.      -********           
%c         ***********             +******.         
%c      ***********.                 ******         
%c    **********.          .**.      .******        
%c  .********.          .*******      ******        
%c  *******           ***********+    ******        
%c ******          ******************:******        
%c *****+      .***************************         
%c.*****:      ********          =********.         
%c *****+      *****.              =******          
%c ******                           .******         
%c  ******:              .****+      +*****         
%c :********-          ********      -*****         
%c ***************************       +*****         
%c******.******************.        .******         
%c******    ************           *******          
%c******      *******.          .********.          
%c******       :**           .**********            
%c ******                 .***********              
%c .******+             ***********                 
%c   ********:      .***********                    
%c    +**********************.                      
%c      :*****************.                         
%c         .+*********=                             `;const t=["#5BCEFA","#F5A9B8","#FFFFFF","#F5A9B8","#5BCEFA"];window.hyfetch=()=>{const e={os:`${navigator.platform}`,kernel:"WebKernel 5.13",uptime:`${Math.floor(Math.random()*1e3)} hours`,packages:"42 (npm)",shell:"JavaScript Console",resolution:`${window.screen.width}x${window.screen.height}`,terminal:"DevTools",cursor:"Custom","terminal font":"Chango"};let i=[`color: ${t[0]};`,"color: #8be9fd; font-weight: bold;","","color: #8be9fd; font-weight: bold;"];console.clear();const s=r.split(`
`),n=s.findIndex(h=>h.includes("-----------------"));let a=0;const o=Object.entries(e);for(let h=2;h<s.length;h++){if(i.push(`color: ${t[Math.floor(t.length/s.length*h)]};`),h<=n||a>=o.length)continue;const[l,c]=o[a];i.push("color: #8be9fd; font-weight: bold;"),i.push(" "),s[h]=s[h].padEnd(40)+`%c ${l.padEnd(12)}%c: ${c}`,a++}console.log(s.join(`
`),...i)}}var Jb=$t(`<div class="h-full w-full overflow-hidden"><!> <!> <img src="top-left-wires.svg" alt="Some aestetic ropes in the corner of the screen" class="absolute top-0 left-0"> <div class="hero absolute top-0 z-10 min-h-screen pointer-events-none"><div class="hero-content text-center"><div class="max-w-md  pointer-events-auto"><button class="title text-8xl font-bold transition-all duration-1000 hover:translate-y-[-4rem] hover:drop-shadow-glowtrans" aria-label="Click to reset the typewriter effect and change the subtitle">Leah</button> <!> <div class="join"><!> <!> <!></div></div></div></div> <div class="absolute bottom-0 z-20 flex w-full justify-center"><button class="btn btn-link text-accent">88x31's</button></div> <!></div>`);function pw(r,t){Fe(t,!0);let e,i,s=Bu("Under Construction :3");const n=["hehe that tickles",":3","Heyyy!","Meoww meoww","This page has hyfetch... kinda"];Ei(()=>{Qb()});var a=Jb();Am(x=>{ym.title="Leahs personal website - HOME"});var o=pt(a);qb(o,{});var h=kt(o,2);sy(h,{});var l=kt(h,4),c=pt(l),u=pt(c),f=pt(u);f.__click=()=>{Zt(s,Em(n[Math.floor(Math.random()*n.length)])),i.reset()};var d=kt(f,2);$e(Zb(d,{className:"py-6",get text(){return Q(s)},speed:50}),x=>i=x,()=>i);var g=kt(d,2),y=pt(g);fn(y,{text:"Blog",icon:"mage:camera-fill",link:"https://blog.leahdevs.xyz",className:"hover:drop-shadow-glowblue"});var p=kt(y,2);fn(p,{text:"Kofi",icon:"mage:cup-hot-fill",link:"https://ko-fi.com/chaotickitsune",className:"hover:drop-shadow-glow"});var m=kt(p,2);fn(m,{text:"Github",icon:"mage:note-with-text-fill",link:"https://github.com/ChaoticLeah",className:"hover:drop-shadow-glowpink"}),ut(g),ut(u),ut(c),ut(l);var _=kt(l,2),v=pt(_);v.__click=function(...x){var S;(S=e.open)==null||S.apply(this,x)},ut(_);var A=kt(_,2);$e(ly(A,{}),x=>e=x,()=>e),ut(a),St(r,a),ke()}Us(["click"]);export{Nt as $,Jd as A,Lt as B,Qt as C,Ft as D,Z as E,Pe as F,zs as G,_d as H,Zy as I,He as J,El as K,Fl as L,mt as M,w_ as N,B_ as O,jt as P,Gt as Q,no as R,F_ as S,Di as T,eo as U,Yt as V,U_ as W,Pl as X,Ml as Y,t_ as Z,Tn as _,me as a,bd as a0,tf as a1,wt as a2,Rt as a3,V_ as a4,Ko as a5,S0 as a6,E0 as a7,F0 as a8,B0 as a9,L0 as aa,Nr as ab,Cd as ac,Je as ad,wi as ae,Tx as af,yf as ag,Nf as ah,ec as ai,Jl as aj,Ay as ak,Cc as al,Rx as am,Mt as an,Sy as ao,Ac as ap,mo as aq,Tc as ar,Es as as,vf as at,pw as au,e0 as b,De as c,ps as d,Kt as e,tc as f,Q_ as g,Wo as h,Wl as i,Kd as j,kd as k,Te as l,jd as m,wc as n,T0 as o,C0 as p,R0 as q,Ny as r,of as s,k0 as t,R_ as u,ht as v,Ot as w,Vd as x,Ty as y,O0 as z};
